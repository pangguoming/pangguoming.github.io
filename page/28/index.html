<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Software make the information world run, and programer make the softeware run.">
<meta property="og:type" content="website">
<meta property="og:title" content="庞国明-博客">
<meta property="og:url" content="http://pangguoming.com/page/28/index.html">
<meta property="og:site_name" content="庞国明-博客">
<meta property="og:description" content="Software make the information world run, and programer make the softeware run.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="庞国明-博客">
<meta name="twitter:description" content="Software make the information world run, and programer make the softeware run.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pangguoming.com/page/28/">





  <title>庞国明-博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">庞国明-博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">此心用度八千遍，不曾厌倦</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/c2d86d80.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/c2d86d80.html" itemprop="url">eclipse maven 报错Could not get the value for parameter encoding for plugin execution default</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-31T09:22:00+08:00">
                2017-05-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>问题描述</strong>：更改默认的maven仓库路径完成后、即存maven项目或者新建maven项目的时候出现如下错误</p>
<p>Could not get the value for parameter encoding for plugin execution default</p>
<p><strong>原因分析</strong>：当问题解决后、回首想想应该是当时在更改本地仓库（<a href="http://blog.csdn.net/dietime1943/article/details/56009535" target="_blank" rel="noopener">【自学maven系列】之修改eclipse的maven默认仓库路径</a>）的最后一步、也就是在重新download默认的maven包的时候出现了问题、记得当时已经24点之后、电脑锁屏了一会无线可能断了、造成jars没有download完全</p>
<p><strong>解决办法</strong>：解决方案来源于StackOverFlow、原文地址如下<br>      &gt;&gt;&gt;&gt; <a href="http://stackoverflow.com/questions/25787197/error-shown-when-creating-new-maven-project-in-eclipse" target="_blank" rel="noopener">http://stackoverflow.com/questions/25787197/error-shown-when-creating-new-maven-project-in-eclipse</a></p>
<pre><code>译

 01． 先关闭eclipse

 02． 找到maven的本地仓库路径、例如（C:\Users\YourUserName.m2）

 03． 删除文件夹：repository

 04． 重新打开eclipse

 05． clean 有问题的maven项目、点击Project → clean...

 06． 右键有问题的maven项目、依次点击Maven → Update Project...

 07． 关闭eclipse

 08． 打开eclipse

 09． 在Project Explorer中选中有问题的project

 10． 按F5键刷新一会

 11． 大功告成
</code></pre><p>〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜</p>
<p><strong>Solution:</strong></p>
<pre><code>01． Close Eclipse.

02． Navigate to user home directory. (For example: &quot;C:\Users\YourUserName.m2&quot;)

03． Delete the &quot;repository&quot; folder.

04． Re-open Eclipse.

05． Click on the Maven project that has an issue and [Go](http://lib.csdn.net/base/go &quot;Go知识库&quot;) to &quot;Project&quot; --&gt; &quot;Clean&quot;.

06． Right-click on the project and go to &quot;Maven&quot; --&gt; &quot;Update Project...&quot;.

07． Close Eclipse.

08． Open Eclipse.

09． Click on the project folder in the &quot;Project Explorer&quot; window (usually on the left).

10． Hit the &quot;F5&quot; key a few times to Refresh your project.

11． Done!
</code></pre><p><strong>注：</strong>本文原创由<code>**blue**tata</code>发布于blog.csdn.<strong>net</strong>、转载请务必注明出处。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/8bc6d0cc.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/8bc6d0cc.html" itemprop="url">Web项目添加Maven支持</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-27T16:58:00+08:00">
                2017-05-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>很多时候，进入到某个项目组，并非项目刚刚开始；同样，很多时候，项目并非一开始就有Maven支持；</p>
<p>对现有的项目支持Maven，需要修改以下地方：</p>
<ol>
<li>将以下代码拷贝到工程根路径下的  .project  文件中的  <buildspec>  标签下 ( 如果代码存在，则无需拷贝 )</buildspec></li>
</ol>
<p><span class="hljs-tag">&lt;<span class="hljs-name">buildCommand&gt;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">name&gt;org.maven.ide.eclipse.maven2Builder<span class="hljs-tag">&lt;/<span class="hljs-name">name&gt;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">arguments&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">arguments&gt;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">buildCommand&gt;</span></span></span></span></span></span></span></span></span></span></span></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. 将以下代码拷贝到工程根路径下的  .project  文件中的  &lt;natures&gt;  标签下 ( 如果代码存在，则无需拷贝 )</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint hljs xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-name&quot;&gt;nature&gt;org.maven.ide.eclipse.maven2Nature&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-name&quot;&gt;nature&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li><p>将以下代码拷贝到工程根路径下的  <strong>.classpath </strong> 文件中的  <classpath>  标签下 ( 如果代码存在，则无需拷贝 )</classpath></p>
<p> <pre class="prettyprint hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">classpathentry <span class="hljs-attr">kind=<span class="hljs-string">“con” <span class="hljs-attr">path=<span class="hljs-string">“org.maven.ide.eclipse.MAVEN2_CLASSPATH_CONTAINER”/&gt;</span></span></span></span></span></span><code>`</code></pre></p>
</li>
<li><p>重启 MyEclipse(经过测试，有时候无须重启,个人建议还是重启MyEclipse)。</p>
</li>
</ol>
<p>会看到如下 Maven 依赖</p>
<p><img src="http://pangguoming.com/blog/images/28760e50-47b6-4468-b664-074e4ca7adc5.jpg" alt=""></p>
<p>配置成功!</p>
<p><strong><em>PS：</em></strong></p>
<ol start="5">
<li><strong>另外一个方法：</strong> 新建一个空的 Maven 项目，比较其中的  .classpath  和  .project  两个文件，将其中和 Maven 相关的部分拷贝到原项目对应文件的对应标签下即可。<br></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/d97df253.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/d97df253.html" itemprop="url">maven安装以及eclipse配置maven</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-27T16:57:00+08:00">
                2017-05-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="exp-content-block"><br><div class="exp-content-body"><br><br>1.  <div class="content-list-text"><br><br>下载maven的bin，在apache官方网站可以下载。<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=1" target="_blank" rel="noopener"><img src="http://c.hiphotos.baidu.com/exp/w=500/sign=390e44fe8e5494ee87220f191df4e0e1/d0c8a786c9177f3eadd9394c72cf3bc79e3d5686.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div><br>2.  <div class="list-icon"><br><div class="content-list-text"><br><br>下载下来之后，解压，找个路径放进去， 把bin的位置设在环境变量里，新建环境变量MAVEN_HOME<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=2" target="_blank" rel="noopener"><img src="http://b.hiphotos.baidu.com/exp/w=500/sign=d0672c25544e9258a63486eeac83d1d1/c9fcc3cec3fdfc034b0127f9d63f8794a4c22672.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div></div><br>3.  <div class="list-icon"><br><div class="content-list-text"><br><br>在PATH里加入maven的bin的路径<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=3" target="_blank" rel="noopener"><img src="http://c.hiphotos.baidu.com/exp/w=500/sign=58958a8508d162d985ee621c21dea950/8644ebf81a4c510f8364265b6259252dd52aa5cb.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div></div><br>4.  <div class="list-icon"><br><div class="content-list-text"><br><br>由于Maven依赖Java运行环境，因此使用Maven之前需要配置Java的运行环境。下载并安装JDK，配置JDK的环境变量JAVA_HOME，否则maven将无法使用<br><br></div></div><br>5.  <div class="list-icon"><br><div class="content-list-text"><br><br>配置完毕后，在Windows命令提示符下，输入mvn -v测试一下，配置成功显示如图：<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=4" target="_blank" rel="noopener"><img src="http://c.hiphotos.baidu.com/exp/w=500/sign=33edcf1c57fbb2fb342b58127f4a2043/b7003af33a87e9505f29342d12385343fbf2b4b1.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div></div><br>6.  <div class="list-icon"><br><div class="content-list-text"><br><br>配置成功后开始在Eclipse中配置Maven，点击eclipse菜单栏Help-&gt;Eclipse Marketplace搜索关键字maven到插件Maven Integration for Eclipse 并点击安装即可，如下图：<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=5" target="_blank" rel="noopener"><img src="http://a.hiphotos.baidu.com/exp/w=500/sign=593ae5bf34d3d539c13d0fc30a86e927/7aec54e736d12f2e29e86b214dc2d56284356886.jpg" alt="maven安装以及eclipse配置maven"></a><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=6" target="_blank" rel="noopener"><img src="http://g.hiphotos.baidu.com/exp/w=500/sign=ac571921372ac65c67056673cbf3b21d/4ec2d5628535e5dd71c1609e74c6a7efcf1b6286.jpg" alt="maven安装以及eclipse配置maven"></a><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=7" target="_blank" rel="noopener"><img src="http://f.hiphotos.baidu.com/exp/w=500/sign=3cf982be39c79f3d8fe1e4308aa0cdbc/0eb30f2442a7d9333d512332af4bd11372f001f2.jpg" alt="maven安装以及eclipse配置maven"></a><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=8" target="_blank" rel="noopener"><img src="http://h.hiphotos.baidu.com/exp/w=500/sign=fe5242c6d2a20cf44690fedf46084b0c/3b292df5e0fe99251be1ac1136a85edf8cb17186.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div></div></div></div></div><br>7.  <div class="list-icon"><br><div class="content-list-text"><br><br>安装完毕后，点击重启eclipse<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=9" target="_blank" rel="noopener"><img src="http://b.hiphotos.baidu.com/exp/w=500/sign=3e42d1d5442309f7e76fad12420e0c39/11385343fbf2b211e21b410fc88065380cd78ebe.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div></div><br>8.  <div class="list-icon"><br><div class="content-list-text"><br><br>重启后，为了使得Eclipse中安装的Maven插件，同windows中安装的那个相同，需要让eclipse中的maven重新定位一下，点击Window -&gt; Preference -&gt; Maven -&gt; Installation -&gt; Add进行设置<br><br><div class="content-list-media"><br><div class="content-list-image clearfix"><a href="http://jingyan.baidu.com/album/295430f136e8e00c7e0050b9.html?picindex=10" target="_blank" rel="noopener"><img src="http://a.hiphotos.baidu.com/exp/w=500/sign=74fb26bb79cb0a4685228b395b63f63e/64380cd7912397ddd94c5c455b82b2b7d0a287be.jpg" alt="maven安装以及eclipse配置maven"></a><br><br></div></div></div></div><br>9.  <div class="list-icon"><br><div class="content-list-text"><br><br>设置成功即安装完成。<br><br><div class="last-item"><span class="last-item-end">END</span><br></div></div></div>

<div class="exp-content-block"><br><br>## 注意事项<br><br><div class="audio-wp audio-wp-2" data-text="" data-for="" data-index="3"><br><div class="exp-content-body"><br><br><em>   <div class="content-list-text"><br><br>必须先下载并安装JDK，配置JDK的环境变量JAVA_HOME，否则maven将无法使用<br><br></div>
</em>   <div class="content-list-text"><br><br>eclipse安装maven插件后必须重新定位maven到本地maven目录<br><br></div>

<p></p></div></div></div></div></div><p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/67ba6a5.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/67ba6a5.html" itemprop="url">jquery 图片文件转base64 显示</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-26T14:32:00+08:00">
                2017-05-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;input type=&quot;file&quot; id=&quot;open-file&quot; /&gt;</span><br></pre></td></tr></table></figure>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre class=&quot;brush:javascript;gutter:true;&quot;&gt;$(&quot;#open-file&quot;).on(&apos;change&apos;,function()&#123;        </span><br><span class="line">        var excelFile =$(this)[0].files[0];</span><br><span class="line">        $(&quot;#open-file&quot;).val(&quot;&quot;);</span><br><span class="line">        $(&quot;#open-file&quot;).attr(&quot;accept&quot;, null);</span><br><span class="line">            if (excelFile) &#123;                </span><br><span class="line">             var FR= new FileReader();                </span><br><span class="line">             FR.addEventListener(&quot;load&quot;, function(e) &#123;</span><br><span class="line">               img.attr(&apos;src&apos;,e.target.result); </span><br><span class="line">               console.log(e.target.result);</span><br><span class="line">             &#125;);</span><br><span class="line">             FR.readAsDataURL( excelFile );</span><br><span class="line">        &#125;        </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/dea65443.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/dea65443.html" itemprop="url">Java 解析Excel文件为JSON</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:03:00+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Excel转Json的需求"><a href="#Excel转Json的需求" class="headerlink" title="Excel转Json的需求"></a><strong>Excel转Json的需求</strong></h3><p>反正我对SSM基本不会的情况下来到现在这家公司，都是90后，感觉很好。第二天就给我开发任务，就是把用户上传的Excel文件转成JSON返回给前台用于大屏的数据展示。</p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a><strong>解决方案</strong></h3><ul>
<li></li>
</ul>
<p>方案1：百度一下，全是<a href="http://lib.csdn.net/base/javase" title="Java SE知识库" target="_blank" rel="noopener">Java</a>使用jxl去做的，我一开始也尝试这样做，但是卡死在一个地方，我们公司的SSM框架用户上传的File是MultipartFile的，它的流InputStream在构造Workbook时传递InputStream并不起作用，本地文件FileInputStream就可以，不知道是不是我无能，反正我没辙了。这东西感觉本来就是javase的。</p>
<ul>
<li></li>
</ul>
<p>方案2：问了个大神，告诉我一个词叫<strong>POI</strong>。捣鼓了一天，终于解决了，对，<strong>解决方案就是 Apache的 POI</strong>（我的选择方案）</p>
<h3 id="Excel的xls和xlsx的差别"><a href="#Excel的xls和xlsx的差别" class="headerlink" title="Excel的xls和xlsx的差别"></a><strong>Excel的xls和xlsx的差别</strong></h3><ul>
<li></li>
</ul>
<p>xls 是Excel 2007以下版本的后缀名，但是所有excel都能打开，对应POI里HSSFWorkbook。</p>
<ul>
<li></li>
</ul>
<p>xlsx 是Excel 2007及以上版本的后缀名，对应POI里XSSFWorkbook。</p>
<h3 id="需要的JAR包"><a href="#需要的JAR包" class="headerlink" title="需要的JAR包"></a><strong>需要的JAR包</strong></h3><dl><dt><strong>如果只需要支持 xls</strong></dt><dd>poi-3.9.jar</dd><dt><strong>如果只需要支持 xlsx</strong></dt><dd>poi-ooxml-3.8.jar</dd><dd>poi-ooxml-schemas-3.10-FINAL.jar</dd><dd>xmlbeans.jar</dd><dd>dom4j-1.6.1-hudson-1.jar</dd></dl>

<p><strong>我的工具代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSON;</span><br><span class="line">    import org.apache.poi.hssf.usermodel.*;</span><br><span class="line">    import org.apache.poi.poifs.filesystem.POIFSFileSystem;</span><br><span class="line">    import org.apache.poi.ss.usermodel.*;</span><br><span class="line">    import org.apache.poi.xssf.usermodel.XSSFDataFormat;</span><br><span class="line">    import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line">    import org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line">    import java.io.IOException;</span><br><span class="line">    import java.util.LinkedHashMap;</span><br><span class="line">    import java.util.LinkedList;</span><br><span class="line">    import java.util.List;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Created by huangzheng on 2016/11/29.</span><br><span class="line">     */</span><br><span class="line">    public class ExcelUtils &#123;</span><br><span class="line">        /**</span><br><span class="line">         * 解决思路：采用Apache的POI的API来操作Excel，读取内容后保存到List中，再将List转Json（推荐Linked，增删快，与Excel表顺序保持一致）</span><br><span class="line">         *</span><br><span class="line">         *          Sheet表1  ————&gt;    List1&lt;Map&lt;列头，列值&gt;&gt;</span><br><span class="line">         *          Sheet表2  ————&gt;    List2&lt;Map&lt;列头，列值&gt;&gt;</span><br><span class="line">         *</span><br><span class="line">         * 步骤1：根据Excel版本类型创建对于的Workbook以及CellSytle</span><br><span class="line">         * 步骤2：遍历每一个表中的每一行的每一列</span><br><span class="line">         * 步骤3：一个sheet表就是一个Json，多表就多Json，对应一个 List</span><br><span class="line">         *       一个sheet表的一行数据就是一个 Map</span><br><span class="line">         *       一行中的一列，就把当前列头为key，列值为value存到该列的Map中</span><br><span class="line">         *</span><br><span class="line">         *</span><br><span class="line">         * @param file  SSM框架下用户上传的Excel文件</span><br><span class="line">         * @return Map  一个线性HashMap，以Excel的sheet表顺序，并以sheet表明作为key，sheet表转换json后的字符串作为value</span><br><span class="line">         * @throws IOException</span><br><span class="line">         */</span><br><span class="line">        public static LinkedHashMap&lt;String,String&gt; excel2json(MultipartFile file) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">            System.out.println(&quot;excel2json方法执行....&quot;);</span><br><span class="line"></span><br><span class="line">            // 返回的map</span><br><span class="line">            LinkedHashMap&lt;String,String&gt; excelMap = new LinkedHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            // Excel列的样式，主要是为了解决Excel数字科学计数的问题</span><br><span class="line">            CellStyle cellStyle;</span><br><span class="line">            // 根据Excel构成的对象</span><br><span class="line">            Workbook wb;</span><br><span class="line">            // 如果是2007及以上版本，则使用想要的Workbook以及CellStyle</span><br><span class="line">            if(file.getOriginalFilename().endsWith(&quot;xlsx&quot;))&#123;</span><br><span class="line">                System.out.println(&quot;是2007及以上版本  xlsx&quot;);</span><br><span class="line">                wb = new XSSFWorkbook(file.getInputStream());</span><br><span class="line">                XSSFDataFormat dataFormat = (XSSFDataFormat) wb.createDataFormat();</span><br><span class="line">                cellStyle = wb.createCellStyle();</span><br><span class="line">                // 设置Excel列的样式为文本</span><br><span class="line">                cellStyle.setDataFormat(dataFormat.getFormat(&quot;@&quot;));</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                System.out.println(&quot;是2007以下版本  xls&quot;);</span><br><span class="line">                POIFSFileSystem fs = new POIFSFileSystem(file.getInputStream());</span><br><span class="line">                wb = new HSSFWorkbook(fs);</span><br><span class="line">                HSSFDataFormat dataFormat = (HSSFDataFormat) wb.createDataFormat();</span><br><span class="line">                cellStyle = wb.createCellStyle();</span><br><span class="line">                // 设置Excel列的样式为文本</span><br><span class="line">                cellStyle.setDataFormat(dataFormat.getFormat(&quot;@&quot;));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // sheet表个数</span><br><span class="line">            int sheetsCounts = wb.getNumberOfSheets();</span><br><span class="line">            // 遍历每一个sheet</span><br><span class="line">            for (int i = 0; i &lt; sheetsCounts; i++) &#123;</span><br><span class="line">                Sheet sheet = wb.getSheetAt(i);</span><br><span class="line">                System.out.println(&quot;第&quot; + i + &quot;个sheet:&quot; + sheet.toString());</span><br><span class="line"></span><br><span class="line">                // 一个sheet表对于一个List</span><br><span class="line">                List list = new LinkedList();</span><br><span class="line"></span><br><span class="line">                // 将第一行的列值作为正个json的key</span><br><span class="line">                String[] cellNames;</span><br><span class="line">                // 取第一行列的值作为key</span><br><span class="line">                Row fisrtRow = sheet.getRow(0);</span><br><span class="line">                // 如果第一行就为空，则是空sheet表，该表跳过</span><br><span class="line">                if(null == fisrtRow)&#123;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line">                // 得到第一行有多少列</span><br><span class="line">                int curCellNum = fisrtRow.getLastCellNum();</span><br><span class="line">                System.out.println(&quot;第一行的列数：&quot; + curCellNum);</span><br><span class="line">                // 根据第一行的列数来生成列头数组</span><br><span class="line">                cellNames = new String[curCellNum];</span><br><span class="line">                // 单独处理第一行，取出第一行的每个列值放在数组中，就得到了整张表的JSON的key</span><br><span class="line">                for (int m = 0; m &lt; curCellNum; m++) &#123;</span><br><span class="line">                    Cell cell = fisrtRow.getCell(m);</span><br><span class="line">                    // 设置该列的样式是字符串</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                    cell.setCellType(Cell.CELL_TYPE_STRING);</span><br><span class="line">                    // 取得该列的字符串值</span><br><span class="line">                    cellNames[m] = cell.getStringCellValue();</span><br><span class="line">                &#125;</span><br><span class="line">                for (String s : cellNames) &#123;</span><br><span class="line">                    System.out.print(&quot;得到第&quot; + i +&quot; 张sheet表的列头： &quot; + s + &quot;,&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println();</span><br><span class="line"></span><br><span class="line">                // 从第二行起遍历每一行</span><br><span class="line">                int rowNum = sheet.getLastRowNum();</span><br><span class="line">                System.out.println(&quot;总共有 &quot; + rowNum + &quot; 行&quot;);</span><br><span class="line">                for (int j = 1; j &lt;= rowNum; j++) &#123;</span><br><span class="line">                    // 一行数据对于一个Map</span><br><span class="line">                    LinkedHashMap rowMap = new LinkedHashMap();</span><br><span class="line">                    // 取得某一行</span><br><span class="line">                    Row row = sheet.getRow(j);</span><br><span class="line">                    int cellNum = row.getLastCellNum();</span><br><span class="line">                    // 遍历每一列</span><br><span class="line">                    for (int k = 0; k &lt; cellNum; k++) &#123;</span><br><span class="line">                        Cell cell = row.getCell(k);</span><br><span class="line"></span><br><span class="line">                        cell.setCellStyle(cellStyle);</span><br><span class="line">                        cell.setCellType(Cell.CELL_TYPE_STRING);</span><br><span class="line">                        // 保存该单元格的数据到该行中</span><br><span class="line">            rowMap.put(cellNames[k],cell.getStringCellValue());</span><br><span class="line">                    &#125;</span><br><span class="line">                    // 保存该行的数据到该表的List中</span><br><span class="line">                    list.add(rowMap);</span><br><span class="line">                &#125;</span><br><span class="line">                // 将该sheet表的表名为key，List转为json后的字符串为Value进行存储</span><br><span class="line">                excelMap.put(sheet.getSheetName(),JSON.toJSONString(list,false));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(&quot;excel2json方法结束....&quot;);</span><br><span class="line"></span><br><span class="line">            return excelMap;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/bf135846.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/bf135846.html" itemprop="url">Dropwizard框架入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-15T10:12:00+08:00">
                2017-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近项目用到了Dropwizard框架，个人感觉还不错，那么这里就从他们官网入手，然后加上自己的实现步骤让大家初步了解这个框架。</p>
<p>官网对DW（Dropwizard）的定义是跨越了一个库和框架之间的界限。他的目标是提供一个生产就绪的web应用程序所需的一切性能可靠的实现。那么这句话可能有些绕，我个人理解就是他能免去我们部署web应用的很多步骤。由于这个功能被提取到可以重复使用的库中，我们的应用程序保持很大程度的精简和集中，这样可以减少我们程序的上线时间和维护负担。</p>
<h3 id="Jetty-for-HTTP"><a href="#Jetty-for-HTTP" class="headerlink" title="Jetty for HTTP"></a>Jetty for HTTP</h3><p>由于Web应用不可能缺少HTTP，DW使用Jetty Http库将一个非常棒的HTTP服务器嵌入到我们的项目中。DW不是将你的程序提交到复杂的服务器上，DW上有个main方法来启动我们的服务器，DW是将我们的应用作为一个简单的线程来跑，消去了Java生产环境中一些非常复杂令人讨厌的过程，并且允许我们使用所有现有的Unix进程管理工具。</p>
<h3 id="Jersey-for-REST"><a href="#Jersey-for-REST" class="headerlink" title="Jersey for REST"></a>Jersey for REST</h3><p>为了定义Restful的web应用，我们发现在性能和特性方面没有什么能比得过Jersey。它允许你编写干净的，可以<a href="http://lib.csdn.net/base/softwaretest" title="软件测试知识库" target="_blank" rel="noopener">测试</a>的类，这个类可以优雅的将http请求映射成为简单的<a href="http://lib.csdn.net/base/javase" title="Java SE知识库" target="_blank" rel="noopener">Java</a>对象。它支持流输出，矩阵URL参数，条件GET请求，还有更多。</p>
<h3 id="Jackson-for-JSON"><a href="#Jackson-for-JSON" class="headerlink" title="Jackson for JSON"></a>Jackson for JSON</h3><p>在数据格式方面，JSON已经成为了网络的通用语，Jackson在jvm中就是Json的龙头老大。除了像闪电一样快速，他有一个复杂的对象映射，允许你直接导出你的域模型。</p>
<h3 id="Metrics-for-metrics"><a href="#Metrics-for-metrics" class="headerlink" title="Metrics for metrics"></a>Metrics for metrics</h3><p>Metrics库对事物进行舍入，在你的生产环境中，为你提供独一无二的洞察力。（也就是说这个是用来监控）那么到了这里，我们关于DW的总体印象应该已经差不多了，下面我结合官网实际操作。</p>
<p>我使用maven和idea进行开发，项目名字为：dw_demo。关于如何创建maven项目不解释，创建完项目后如图所示：</p>
<p><img src="http://pangguoming.com/blog/images/a84c26a1-267b-4f9a-8b05-616eb59c2523.jpg" alt=""></p>
<p>然后打开我们的pom.xml文件，加入dw的依赖（以下并非完全pom文件，仅展现部分）：</p>
<p><properties><br>        &lt;dropwizard.version&gt;0.9.2&lt;/dropwizard.version&gt;<br>    </properties><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre&gt;&lt;dependencies&gt;</span><br></pre></td></tr></table></figure></p>
<pre><code>&lt;pre&gt;&lt;dependency&gt;
    &lt;groupId&gt;io.dropwizard&lt;/groupId&gt;
    &lt;artifactId&gt;dropwizard-core&lt;/artifactId&gt;
    &lt;version&gt;${dropwizard.version}&lt;/version&gt;
&lt;/dependency&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre&gt;&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

## Creating A Configuration Class

&lt;div&gt; 
&lt;div&gt;每个DW应用都有他自己的子类：Configuration,这个类指定环境中特定的参数。这
&lt;div&gt;些参数在YAML类型的配置文件中被指定，其被反序列化为应用程序配置类的实例并验
&lt;div&gt;证。（这句话的意思就是这个配置文件中指定的参数，会被映射到我们项目的一个类）
&lt;div&gt;我们将要构建的是一个helloworld高性能服务。我们的一个要求就是我们需要能够在不同
&lt;div&gt;的环境中让它说hello。在开始之前我们需要指定至少两个内容：一个说hello的模板 还有
&lt;div&gt;一个默认的名字以防用户忘记指定。
&lt;div&gt; 
&lt;div&gt;那么我下面开始创建我的配置文件：
&lt;div&gt; 
&lt;div&gt;![](http://pangguoming.com/blog/images/17a38de7-2e94-4431-ba9f-5330ab1f35f9.jpg)
&lt;div&gt; 
</code></pre><p>内容如下：</p>
<pre><code>&lt;pre&gt;package com.config;

import com.fasterxml.jackson.annotation.JsonProperty;
import io.dropwizard.Configuration;
import org.hibernate.validator.constraints.NotEmpty;

/**
 * Created by moon on 2017/1/13.
 */
public class HelloWorldConfiguration extends Configuration {
    @NotEmpty
    private String template;

    @NotEmpty
    private String defaultName = &quot;Stranger&quot;;

    @JsonProperty
    public String getTemplate() {
        return template;
    }

    @JsonProperty
    public void setTemplate(String template) {
        this.template = template;
    }

    @JsonProperty
    public String getDefaultName() {
        return defaultName;
    }

    @JsonProperty
    public void setDefaultName(String name) {
        this.defaultName = name;
    }
}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">当这个类被从YAML配置文件反序列化的时候，他会从YAML对象中获取两个根层次的变量：template 用来说helloworld的模板。defaultName 默认的名字。template和defaultName都用@NotEmpty被注释，所以在YAML配置文件中如果有空值或者忘了其中一者，异常将会被抛出，我们的应用将不会被启动。</span><br><span class="line"></span><br><span class="line">defaultName和template的get 和set 方法都被@JsonProperty标注，这不止允许jackson从YAML配置文件反序列化，同样允许它序列化。</span><br><span class="line"></span><br><span class="line">然后我们创建一个YAML的配置文件：</span><br><span class="line"></span><br><span class="line">![](http://pangguoming.com/blog/images/f78e729a-9be3-46b1-aa29-a704e57b5f8c.jpg)</span><br><span class="line"></span><br><span class="line">里面的内容如下：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;template: Hello, %s!</span><br><span class="line">    defaultName: Stranger</span><br></pre></td></tr></table></figure>
</code></pre><p>大家可以看到，与我们的配置类中的变量一一对应，相信很多人看到这里就明白了。</p>
<pre><code>## Creating An Application Class
</code></pre><p>结合我们项目中的Configuration子类，我们的Application的子类形成了我们DW的应用的核心。Application的子类把不同的提供各式各样功能的包和命令拉取到了一起。</p>
<p>现在，我们开始建立我们的Application子类：</p>
<p><img src="http://pangguoming.com/blog/images/7f7e8a99-d2e2-402c-87e4-3afba43cb751.jpg" alt=""></p>
<p>其内容如下：</p>
<pre><code>&lt;pre&gt;package com.app;

import com.config.HelloWorldConfiguration;
import io.dropwizard.Application;
import io.dropwizard.setup.Bootstrap;
import io.dropwizard.setup.Environment;

/**
 * Created by moon on 2017/1/13.
 */
public class HelloWorldApplication extends Application&lt;HelloWorldConfiguration&gt; {
    public static void main(String[] args) throws Exception {
        new HelloWorldApplication().run(args);
    }

    @Override
    public String getName() {
        return &quot;hello-world&quot;;
    }

    @Override
    public void initialize(Bootstrap&lt;HelloWorldConfiguration&gt; bootstrap) {
        // nothing to do yet
    }

    @Override
    public void run(HelloWorldConfiguration configuration,
                    Environment environment) {
        // nothing to do yet
    }

}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">正如我们所看到的，HelloWorldApplication使用应用程序的configuration进行参数化。（因为用了我们的HelloWorldConfiuration，而它是Configuration的子类）。</span><br><span class="line"></span><br><span class="line">initialize方法用于配置应用在正式启动之前所需：包，配置源等。同时我们需要加入一个main方法，这是我们应用的入口。到目前为止，我们并没有实现任何的功能，所以我们的run方法有点无趣，让我们开始丰富它。</span><br><span class="line"></span><br><span class="line">    ## Creating A Representation Class</span><br><span class="line"></span><br><span class="line">在我们开始继续我们的程序之前，我们需要停下来思考一下我们程序的API。幸运的是，我们的应用需要符合行业标准。RFC 1149（别问我这是什么，连这个都不知道，我tm也不知道）。他指定了helloworld saying的如下json表达形式：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;&lt;span class=&quot;p&quot;&gt;&#123;</span><br><span class="line">      &lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;span class=&quot;o&quot;&gt;: &lt;span class=&quot;mi&quot;&gt;1&lt;span class=&quot;p&quot;&gt;,</span><br><span class="line">      &lt;span class=&quot;s2&quot;&gt;&quot;content&quot;&lt;span class=&quot;o&quot;&gt;: &lt;span class=&quot;s2&quot;&gt;&quot;Hi!&quot;</span><br><span class="line">    &lt;span class=&quot;p&quot;&gt;&#125;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>id字段是语法的唯一标识符。content是说的具体内容。</p>
<p>为了建模这个表示，我们需要创建一个表示类 ：</p>
<p><img src="http://pangguoming.com/blog/images/74e7d674-53de-43d0-a343-cf95a2d1ef7f.jpg" alt=""></p>
<p>该类的内容如下：</p>
<pre><code>&lt;pre&gt;package com.api;

import com.fasterxml.jackson.annotation.JsonProperty;
import org.hibernate.validator.constraints.Length;

/**
 * Created by moon on 2017/1/13.
 */
public class Saying {
    private long id;

    @Length(max = 3)
    private String content;

    public Saying() {
        // Jackson deserialization
    }

    public Saying(long id, String content) {
        this.id = id;
        this.content = content;
    }

    @JsonProperty
    public long getId() {
        return id;
    }

    @JsonProperty
    public String getContent() {
        return content;
    }
}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这是一个非常简单的POJO，但是有些需要注意的地方。</span><br><span class="line"></span><br><span class="line">首先，他是不可更改的。这使得saying在多线程环境和单线程环境非常容易被推理。其次，它使用java的JavaBean来保存id和content属性。这允许jackson把他序列化为我们需要的JSON。jackson对象的映射代码将会使用getId()返回的对象来填充JSON对象的id字段，content同理。最后，bean利用验证来确保内容不大于3。</span><br><span class="line"></span><br><span class="line">    ## Creating A Resource Class</span><br><span class="line"></span><br><span class="line">Jersey资源是DW应用程序的肉和土豆（这种比喻我也是醉了）。每个资源类都与URL相关联（这个很重要，后面有说）。对于我们的应用程序来说，我们需要一个resources来通过url：/helloworld来返回新的Saying实例对象。</span><br><span class="line"></span><br><span class="line">现在我们开始建立的Resource：</span><br><span class="line"></span><br><span class="line">![](http://pangguoming.com/blog/images/6bfea6f2-6fad-41f9-96d3-e039732f9a1e.jpg)</span><br><span class="line"></span><br><span class="line">类的内容如下：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;package com.resource;</span><br><span class="line"></span><br><span class="line">    import com.api.Saying;</span><br><span class="line">    import com.codahale.metrics.annotation.Timed;</span><br><span class="line">    import com.google.common.base.Optional;</span><br><span class="line"></span><br><span class="line">    import javax.ws.rs.GET;</span><br><span class="line">    import javax.ws.rs.Path;</span><br><span class="line">    import javax.ws.rs.Produces;</span><br><span class="line">    import javax.ws.rs.QueryParam;</span><br><span class="line">    import javax.ws.rs.core.MediaType;</span><br><span class="line">    import java.util.concurrent.atomic.AtomicLong;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Created by moon on 2017/1/13.</span><br><span class="line">     */</span><br><span class="line">    @Path(&quot;/hello-world&quot;)</span><br><span class="line">    @Produces(MediaType.***APPLICATION_JSON***)</span><br><span class="line">    public class HelloWorldResource &#123;</span><br><span class="line">        private final String template;</span><br><span class="line">        private final String defaultName;</span><br><span class="line">        private final AtomicLong counter;</span><br><span class="line"></span><br><span class="line">        public HelloWorldResource(String template, String defaultName) &#123;</span><br><span class="line">            this.template = template;</span><br><span class="line">            this.defaultName = defaultName;</span><br><span class="line">            this.counter = new AtomicLong();</span><br><span class="line">        &#125;</span><br><span class="line">        @GET</span><br><span class="line">        @Timed</span><br><span class="line">        public Saying sayHello(@QueryParam(&quot;name&quot;) Optional&lt;String&gt; name) &#123;</span><br><span class="line">            final String value = String.format(template, name.or(defaultName));</span><br><span class="line">            return new Saying(counter.incrementAndGet(), value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre><p>HelloWorldResource有两个声明：@Path和@Produces。@Path(“/hello-world”)告诉Jersey这个resource可以通过 “/hello-world”URL被访问。</p>
<p>@Produces(MediaType.APPLICATION_JSON)让Jersey的内容协商代码知道这个资源产生的是application/json.</p>
<p>HelloWorldResource构造器接收两个参数，创建saying的template和当用户没有指明名字时的默认名称。AtomicLong为我们提供一种线程安全，简易的方式去生成（ish）ID。</p>
<p>sayHello方法是这个类的肉，也是一个非常简单的方法。@QueryParam(“name”)告诉Jersey把在查询参数中的name映射到方法中的name中。如果一个客户发送请求到：/hello-world?name=Dougie,sayHello 方法将会伴随Optional.of(“Dougie”)被调用。如果查询参数中没有name，sayHello将会伴随着Optional.absent()被调用。</p>
<p>在sayHello方法里面，我们增加计数器的值，使用String.format来格式化模板，返回一个新的Saying实例。因为sayHello被@Timed注释，DW将会自动调用他的持续时间和速率记录为度量定时器。</p>
<p>一旦sayHello返回，Jersey将会采用Saying的实例，并寻找一个提供程序类来将Saying实例写为：application/json。</p>
<pre><code>### Registering A Resource
</code></pre><p>在这些正式工作之前，我们需要到HelloWorldApplication中，并将新的resouce加入其中，在run方法中我们可以读取到HelloWorldConfiguration的template和defaultName实例，创建一个新的HelloWorldResource实例，并将其加入到新的Jersey环境中。</p>
<p>我们HelloWorldApplication中新的run方法如下：</p>
<pre><code>&lt;pre&gt;@Override
public void run(HelloWorldConfiguration configuration,
                Environment environment) {
    final HelloWorldResource resource = new HelloWorldResource(
            configuration.getTemplate(),
            configuration.getDefaultName()
    );
    environment.jersey().register(resource);
}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">当我们的应用启动的时候，我们使用配置文件中的参数创建一个新的资源类实例，并传递给environment.</span><br><span class="line"></span><br><span class="line">在pom文件中加入：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;&lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;2.3&lt;/version&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;createDependencyReducedPom&gt;true&lt;/createDependencyReducedPom&gt;</span><br><span class="line">                    &lt;filters&gt;</span><br><span class="line">                        &lt;filter&gt;</span><br><span class="line">                            &lt;artifact&gt;*:*&lt;/artifact&gt;</span><br><span class="line">                            &lt;excludes&gt;</span><br><span class="line">                                &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;</span><br><span class="line">                                &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;</span><br><span class="line">                                &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;</span><br><span class="line">                            &lt;/excludes&gt;</span><br><span class="line">                        &lt;/filter&gt;</span><br><span class="line">                    &lt;/filters&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">                &lt;executions&gt;</span><br><span class="line">                    &lt;execution&gt;</span><br><span class="line">                        &lt;phase&gt;package&lt;/phase&gt;</span><br><span class="line">                        &lt;goals&gt;</span><br><span class="line">                            &lt;goal&gt;shade&lt;/goal&gt;</span><br><span class="line">                        &lt;/goals&gt;</span><br><span class="line">                        &lt;configuration&gt;</span><br><span class="line">                            &lt;transformers&gt;</span><br><span class="line">                                &lt;transformer</span><br><span class="line">           implementation=&quot;org.apache.maven.plugins.shade.resource.ServicesResourceTransformer&quot;/&gt;</span><br><span class="line">                                &lt;transformer</span><br><span class="line">            implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;</span><br><span class="line">                                    &lt;mainClass&gt;com.app.HelloWorldApplication&lt;/mainClass&gt;</span><br><span class="line">                                &lt;/transformer&gt;</span><br><span class="line">                            &lt;/transformers&gt;</span><br><span class="line">                        &lt;/configuration&gt;</span><br><span class="line">                    &lt;/execution&gt;</span><br><span class="line">                &lt;/executions&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;source&gt;1.8&lt;/source&gt;</span><br><span class="line">                    &lt;target&gt;1.8&lt;/target&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>然后打包：</p>
<p><img src="http://pangguoming.com/blog/images/2efd28ec-a4ea-4b35-b91d-4065d0eac088.jpg" alt=""></p>
<p>打包成功后，在我们的target目录下面会出现我们所需的包：</p>
<p><img src="http://pangguoming.com/blog/images/5bb71e02-2908-4e1a-8d75-adc0c34b9b91.jpg" alt=""></p>
<p>然后我们开始运行：</p>
<p><img src="http://pangguoming.com/blog/images/764321ad-b285-4c5c-8557-cb6d2c926ad6.jpg" alt=""></p>
<p>这里面官方为我们提供两个参数，我们需要启动服务，所以后面加入server参数，重新启动如下：</p>
<p><img src="http://pangguoming.com/blog/images/72b75633-f7cf-4d39-a75c-68975faecf63.jpg" alt=""></p>
<p>这说明我们的项目已经启动了，那么让我们访问一下url看是否正确：</p>
<p><img src="http://pangguoming.com/blog/images/a189120f-962c-4584-8461-e5c29e2473e2.jpg" alt="">  </p>
<p>返回结果正常，没毛病。</p>
<p>以上仅仅是DW的初步，还有许多其他功能，由于时间关系，不做详细介绍，如果</p>
<p>有时间我会再奉上一版深度版的。链接为：</p>
<p><a href="http://www.dropwizard.io/0.9.2/docs/manual/index.html#manual-index" target="_blank" rel="noopener">DW官网深层次内容</a>  </p>
<p>希望这次的讲解对大家有帮助，感谢开源。<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/af9b5a7c.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/af9b5a7c.html" itemprop="url">使用Spring Security和OAuth2实现RESTful服务安全认证</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-12T16:46:00+08:00">
                2017-05-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇教程是展示如何设置一个OAuth2服务来保护REST资源. 源代码下载<a href="https://github.com/iainporter/oauth2-provider" target="_blank" rel="noopener">github</a>. (<a href="https://github.com/iainporter/oauth2-provider)你能下载这个源码就开始编写一个被OAuth方法保护的服务。该源码包含功能：" target="_blank" rel="noopener">https://github.com/iainporter/oauth2-provider)你能下载这个源码就开始编写一个被OAuth方法保护的服务。该源码包含功能：</a></p>
<ul>
<li>用户注册和登录  </li>
<li>Email验证  </li>
<li>Password 丢失</li>
</ul>
<p>采取的技术有以下：</p>
<ul>
<li>OAuth2 Protocol   </li>
<li><a href="http://lib.csdn.net/base/javaee" title="Java EE知识库" target="_blank" rel="noopener">spring</a> Security   </li>
<li>Spring Integration   </li>
<li>Spring Data   </li>
<li>Jersey/JAX-RS   </li>
<li>Gradle / Groovy   </li>
<li><a href="http://lib.csdn.net/base/mongodb" title="MongoDB知识库" target="_blank" rel="noopener">MongoDB</a></li>
</ul>
<p>通过以下方式构建项目：</p>
<blockquote>
<p><a href="http://lib.csdn.net/base/git" title="Git知识库" target="_blank" rel="noopener">Git</a> clone  <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:iainporter/oauth2-provider.git<br>cd oauth2-provider<br>./gradlew clean build integrationTest</p>
</blockquote>
<p>运行Web项目：</p>
<p>这个应用是基于MongoDB作为持久层，在运行应用之前确认mongod是运行在端口27017.</p>
<p>运行命令：</p>
<blockquote>
<p>./gradlew tomcatRun</p>
</blockquote>
<p>在浏览器打开<a href="http://localhost:8080/oauth2-provider/index.html" target="_blank" rel="noopener">http://localhost:8080/oauth2-provider/index.html</a></p>
<ol>
<li>创建一个用户：</li>
</ol>
<p>curl -v -X POST \<br>   -H “Content-Type: application/json” \<br>   -H “Authorization: Basic MzUzYjMwMmM0NDU3NGY1NjUwNDU2ODdlNTM0ZTdkNmE6Mjg2OTI0Njk3ZTYxNWE2NzJhNjQ2YTQ5MzU0NTY0NmM=” \<br>   -d ‘{“user”:{“emailAddress”:”<a href="mailto:user@example.com" target="_blank" rel="noopener">user@example.com</a>“}, “password”:”password”}’ \<br>   ‘<a href="http://localhost:8080/oauth2-provider/v1.0/users&#39;" target="_blank" rel="noopener">http://localhost:8080/oauth2-provider/v1.0/users&#39;</a></p>
<p>结果应该是：</p>
<p>{“apiUser”:<br>   {“emailAddress”:”<a href="mailto:user@example.com" target="_blank" rel="noopener">user@example.com</a>“,<br>   “firstName”:null,<br>   “lastName”:null,<br>   “age”:null,<br>   “id”:”8a34d009-3558-4c8c-a8da-1ad2b2a393c7”,<br>   “name”:”<a href="mailto:user@example.com" target="_blank" rel="noopener">user@example.com</a>“},<br>   “oauth2AccessToken”:<br>   {“access_token”:”7e0e4708-7837-4a7e-9f87-81c6429b02ac”,<br>   “token_type”:”bearer”,<br>   “refresh_token”:”d0f248ab-e30f-4a85-860c-bd1e388a39b5”,<br>   “expires_in”:5183999,<br>   “scope”:”read write”<br>   }<br>}</p>
<ol start="2">
<li>请求一个access token：</li>
</ol>
<p>curl -v -X POST \<br>   -H “Content-Type: application/json” \<br>   -H “Authorization: Basic MzUzYjMwMmM0NDU3NGY1NjUwNDU2ODdlNTM0ZTdkNmE6Mjg2OTI0Njk3ZTYxNWE2NzJhNjQ2YTQ5MzU0NTY0NmM=” \<br>   ‘<a href="http://localhost:8080/oauth2-provider/oauth/token?grant_type=password&amp;username=user@example.com&amp;password=password&#39;" target="_blank" rel="noopener">http://localhost:8080/oauth2-provider/oauth/token?grant_type=password&amp;username=user@example.com&amp;password=password&#39;</a></p>
<p>结果应该是：</p>
<p>{<br>  “access_token”:”a838780e-35ef-4bd5-92c0-07a45aa74948”,<br>  “token_type”:”bearer”,<br>  “refresh_token”:”ab06022f-247c-450a-a11e-2ffab116e3dc”,<br>  “expires_in”:5183999<br>}</p>
<ol start="3">
<li>刷新一个token：</li>
</ol>
<p>curl -v -X POST \<br>   -H “Content-Type: application/json” \<br>   -H “Authorization: Basic MzUzYjMwMmM0NDU3NGY1NjUwNDU2ODdlNTM0ZTdkNmE6Mjg2OTI0Njk3ZTYxNWE2NzJhNjQ2YTQ5MzU0NTY0NmM=” \<br>   ‘<a href="http://localhost:8080/oauth2-provider/oauth/token?grant_type=refresh_token&amp;refresh_token=ab06022f-247c-450a-a11e-2ffab116e3dc&#39;" target="_blank" rel="noopener">http://localhost:8080/oauth2-provider/oauth/token?grant_type=refresh_token&amp;refresh_token=ab06022f-247c-450a-a11e-2ffab116e3dc&#39;</a></p>
<p>结果应该是：</p>
<p>{<br>   “access_token”:”4835cd11-8bb7-4b76-b857-55c6e7f36fc4”,<br>   “token_type”:”bearer”,<br>   “refresh_token”:”ab06022f-247c-450a-a11e-2ffab116e3dc”,<br>   “expires_in”:5183999<br>}</p>
<h2 id="Web-Context"><a href="#Web-Context" class="headerlink" title="Web Context"></a>Web Context</h2><p>一个Jersey 处理所有资源调用：</p>
<ol>
<li><servlet-mapping>  </servlet-mapping></li>
<li><servlet-name>jersey-servlet</servlet-name>  </li>
<li><url-pattern>/*</url-pattern>  </li>
<li>  </li>
</ol>
<p>Spring servlet处理所有oauth 调用：</p>
<ol>
<li><servlet-mapping>  </servlet-mapping></li>
<li><servlet-name>spring</servlet-name>  </li>
<li><url-pattern>/oauth/*</url-pattern>  </li>
<li>  </li>
</ol>
<p>spring security配合定义一个过滤器：</p>
<ol>
<li><filter>  </filter></li>
<li><filter-name>springSecurityFilterChain</filter-name>  </li>
<li><filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>  </li>
<li><init-param>  </init-param></li>
<li><param-name>contextAttribute</param-name>  </li>
<li><param-value>org.springframework.web.servlet.FrameworkServlet.CONTEXT.spring</param-value>  </li>
<li>  </li>
<li>  </li>
</ol>
<p>对根目录下所有url进行 过滤：</p>
<ol>
<li><filter-mapping>  </filter-mapping></li>
<li><filter-name>springSecurityFilterChain</filter-name>  </li>
<li><url-pattern>/*</url-pattern>  </li>
<li>  </li>
</ol>
<h2 id="配置OAuth-流程"><a href="#配置OAuth-流程" class="headerlink" title="配置OAuth 流程"></a>配置OAuth 流程</h2><ol>
<li>&lt;oauth:authorization-server client-details-service-ref=”client-details-service” token-services-ref=”tokenServices”&gt;  </li>
<li><a href="oauth:refresh-token/" target="_blank" rel="noopener">oauth:refresh-token/</a>  </li>
<li><a href="oauth:password/" target="_blank" rel="noopener">oauth:password/</a>  </li>
<li>&lt;/oauth:authorization-server&gt;  </li>
</ol>
<p>缺省的token端点是/oauth/token ，只有 password flow 和刷新 token 支持。</p>
<h2 id="保护token端点"><a href="#保护token端点" class="headerlink" title="保护token端点"></a>保护token端点</h2><p>使用Spring security 保护token端点：</p>
<ol>
<li>&lt;http pattern=”/oauth/token” create-session=”stateless” authentication-manager-ref=”clientAuthenticationManager”  </li>
<li>xmlns=”<a href="http://www.springframework.org/schema/security&quot;&gt;" target="_blank" rel="noopener">http://www.springframework.org/schema/security&quot;&gt;</a>  </li>
<li><anonymous enabled="false">  </anonymous></li>
<li><http-basic entry-point-ref="clientAuthenticationEntryPoint">  </http-basic></li>
<li><access-denied-handler ref="oauthAccessDeniedHandler">  </access-denied-handler></li>
<li>  </li>
</ol>
<p>下面配置授权authentication 管理器和客户端服务：</p>
<ol>
<li>&lt;bean id=”clientCredentialsTokenEndpointFilter”  </li>
<li>class=”org.springframework.security.oauth2.provider.client.ClientCredentialsTokenEndpointFilter”&gt;  </li>
<li><property name="authenticationManager" ref="clientAuthenticationManager">  </property></li>
<li>  </li>
<li></li>
<li><authentication-manager id="clientAuthenticationManager" xmlns="http://www.springframework.org/schema/security">  </authentication-manager></li>
<li><authentication-provider user-service-ref="client-details-user-service">  </authentication-provider></li>
<li>  </li>
<li></li>
<li></li>
<li><bean id="client-details-user-service" class="org.springframework.security.oauth2.provider.client.ClientDetailsUserDetailsService">  </bean></li>
<li><constructor-arg ref="client-details-service">  </constructor-arg></li>
<li>  </li>
</ol>
<h2 id="配置用户授权服务"><a href="#配置用户授权服务" class="headerlink" title="配置用户授权服务"></a>配置用户授权服务</h2><p>Resource Owner Password flow 需要管理用户的授权管理器</p>
<ol>
<li><bean id="passwordEncoder" class="org.springframework.security.crypto.password.StandardPasswordEncoder">  </bean></li>
<li></li>
<li>&lt;sec:authentication-manager alias=”userAuthenticationManager”&gt;  </li>
<li>&lt;sec:authentication-provider user-service-ref=”userService”&gt;  </li>
<li>&lt;sec:password-encoder ref=”passwordEncoder”/&gt;  </li>
<li>&lt;/sec:authentication-provider&gt;  </li>
<li>&lt;/sec:authentication-manager&gt;  </li>
</ol>
<p>密码 password encoder是用于加密密码。用户服务必须实现一个UserDetailsService ，能根据用户名返回用户。</p>
<ol>
<li>@Override  </li>
<li>public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {  </li>
<li>notNull(username, “Mandatory argument ‘username’ missing.”);  </li>
<li>User user = userRepository.findByEmailAddress(username.toLowerCase());  </li>
<li>if (user == null) {  </li>
<li>throw new AuthenticationException();  </li>
<li>}  </li>
<li>return user;  </li>
<li>}  </li>
</ol>
<h2 id="配置Token-服务"><a href="#配置Token-服务" class="headerlink" title="配置Token 服务"></a>配置Token 服务</h2><ol>
<li><bean id="tokenServices" class="org.springframework.security.oauth2.provider.token.DefaultTokenServices">  </bean></li>
<li><property name="tokenStore" ref="tokenStore">  </property></li>
<li><property name="supportRefreshToken" value="true">  </property></li>
<li><property name="clientDetailsService" ref="client-details-service">  </property></li>
<li>  </li>
</ol>
<h2 id="保护资源访问"><a href="#保护资源访问" class="headerlink" title="保护资源访问"></a>保护资源访问</h2><ol>
<li>&lt;oauth:resource-server id=”resourceServerFilter” token-services-ref=”tokenServices”/&gt;  </li>
</ol>
<h2 id="核心服务"><a href="#核心服务" class="headerlink" title="核心服务"></a>核心服务</h2><p>这个服务提供基于访问token获得用户的信息。URL格式：</p>
<p>/v1.0/users/{id}/someresource </p>
<ol>
<li>@Path(“/v1.0/me”)  </li>
<li>@Component  </li>
<li>@Produces({MediaType.APPLICATION_JSON})  </li>
<li>@Consumes({MediaType.APPLICATION_JSON})  </li>
<li>public class MeResource extends BaseResource {  </li>
<li></li>
<li>@RolesAllowed({“ROLE_USER”})  </li>
<li>@GET  </li>
<li>public ApiUser getUser(final @Context SecurityContext securityContext) {  </li>
<li>User requestingUser = loadUserFromSecurityContext(securityContext);  </li>
<li>if(requestingUser == null) {  </li>
<li>throw new UserNotFoundException();  </li>
<li>}  </li>
<li>return new ApiUser(requestingUser);  </li>
<li>}  </li>
<li></li>
<li>protected User loadUserFromSecurityContext(SecurityContext securityContext) {  </li>
<li>OAuth2Authentication requestingUser = (OAuth2Authentication) securityContext.getUserPrincipal();  </li>
<li>Object principal = requestingUser.getUserAuthentication().getPrincipal();  </li>
<li>User user = null;  </li>
<li>if(principal instanceof User) {  </li>
<li>user = (User)principal;  </li>
<li>} else {  </li>
<li>user = userRepository.findByEmailAddress((String)principal);  </li>
<li>}  </li>
<li>return user;  </li>
<li>}  </li>
<li>}  </li>
</ol>
<p><a href="http://lib.csdn.net/base/softwaretest" title="软件测试知识库" target="_blank" rel="noopener">测试</a>这个应用，启动：</p>
<blockquote>
<p>./gradlew tomcatRun</p>
</blockquote>
<p>测试：</p>
<p>curl -v -X GET \<br>  -H “Content-Type: application/json” \<br>  -H “Authorization: Bearer [your token here]” \<br>  ‘<a href="http://localhost:8080/oauth2-provider/v1.0/me&#39;" target="_blank" rel="noopener">http://localhost:8080/oauth2-provider/v1.0/me&#39;</a></p>
<p>参考：<a href="https://github.com/tcompiegne/couchbase-token-store-spring-oauth2" target="_blank" rel="noopener">https://github.com/tcompiegne/couchbase-token-store-spring-oauth2</a></p>
<pre><code>https://github.com/tcompiegne/oauth2-server-spring-couchbase
</code></pre><p>转自：<a href="http://www.jdon.com/dl/best/securing-rest-services-with-spring.html.html" target="_blank" rel="noopener">http://www.jdon.com/dl/best/securing-rest-services-with-spring.html.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/57d34e0f.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/57d34e0f.html" itemprop="url">SQL语句大小写是否区分的问题，批量修改整个数据库所有表所有字段大小写</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-14T16:04:00+08:00">
                2017-04-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';">一、实例介绍</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>SQL语句大小写到底是否区分呢？我们先从下面的这个例子来看一下：</p>
<p>例：</p>
<p>–&gt; 创建表，插入数据:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">declare @maco table (number int,myvalue varchar(2))</span><br><span class="line"></span><br><span class="line">    insert into @maco select 1,&apos;aa&apos; union all</span><br><span class="line"></span><br><span class="line">    select 2,&apos;Aa&apos; union all</span><br><span class="line"></span><br><span class="line">    select 3,&apos;aA&apos; union all</span><br><span class="line"></span><br><span class="line">    select 4,&apos;AA&apos;</span><br><span class="line"></span><br><span class="line">    --不区分大小写</span><br><span class="line"></span><br><span class="line">    select * from @maco WHERE nn=&apos;aa&apos;</span><br><span class="line"></span><br><span class="line">    --区分大小写</span><br><span class="line"></span><br><span class="line">    select  * from @maco WHERE nn=&apos;aa&apos; collate Chinese_PRC_CS_AI</span><br></pre></td></tr></table></figure>
<p>注：我用的是Sql Server 2005。</p>
<p>从上面的例子我们可以看到第一句不区分，而第二句区分。可是每个语句不能都加上个collate Chinese_PRC_CS_AI吧？</p>
<p>我们可以这样，看下面的例子：</p>
<p>例：</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre class=&quot;brush:sql;gutter:true;&quot;&gt;--不区分大小写</span><br><span class="line"></span><br><span class="line">ALTER TABLE My_table ALTER Column colname nvarchar(100) collate Chinese_PRC_CI_AS     </span><br><span class="line"></span><br><span class="line">--区分大小写  </span><br><span class="line"></span><br><span class="line">ALTER TABLE My_table ALTER Column colname nvarchar(100) collate Chinese_PRC_CS_AS</span><br></pre></td></tr></table></figure>
</code></pre><p>从上面的例子我们可以看到第一句不区分，而第二句区分。可是我们不能每个表都进行一下修改吧？</p>
<p>我们可以再这样，看下面的例子：</p>
<p>例：</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre class=&quot;brush:sql;gutter:true;&quot;&gt;--不区分大小写  </span><br><span class="line"></span><br><span class="line">ALTER DATABASE databasename collate Chinese_PRC_CI_AS    </span><br><span class="line"></span><br><span class="line">--区分大小写   </span><br><span class="line"></span><br><span class="line">ALTER DATABASE databasename collate Chinese_PRC_CS_AS</span><br></pre></td></tr></table></figure>
</code></pre><p>批量修改数据库中所有表内字段大小写敏感</p>
<p>如：</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre class=&quot;brush:sql;gutter:true;&quot;&gt;DECLARE @collate nvarchar(100);</span><br><span class="line">DECLARE @table nvarchar(255);</span><br><span class="line">DECLARE @column_name nvarchar(255);</span><br><span class="line">DECLARE @column_id int;</span><br><span class="line">DECLARE @data_type nvarchar(255);</span><br><span class="line">DECLARE @max_length int;</span><br><span class="line">DECLARE @row_id int;</span><br><span class="line">DECLARE @sql nvarchar(max);</span><br><span class="line">DECLARE @sql_column nvarchar(max);</span><br><span class="line">DECLARE @is_nullable int;</span><br><span class="line">DECLARE @nullornot nvarchar(255);</span><br><span class="line"></span><br><span class="line">SET @collate = &apos;Chinese_PRC_CS_AS&apos;; --不区分大小写：  Chinese_PRC_CI_AS    区分大小写 ：Chinese_PRC_CS_AS</span><br><span class="line"></span><br><span class="line">DECLARE local_table_cursor CURSOR FOR</span><br><span class="line"></span><br><span class="line">SELECT [name]</span><br><span class="line">FROM sysobjects</span><br><span class="line">WHERE OBJECTPROPERTY(id, N&apos;IsUserTable&apos;) = 1</span><br><span class="line"></span><br><span class="line">OPEN local_table_cursor</span><br><span class="line">FETCH NEXT FROM local_table_cursor</span><br><span class="line">INTO @table</span><br><span class="line"></span><br><span class="line">WHILE @@FETCH_STATUS = 0</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">    DECLARE local_change_cursor CURSOR FOR</span><br><span class="line"></span><br><span class="line">    SELECT ROW_NUMBER() OVER (ORDER BY c.column_id) AS row_id</span><br><span class="line">        , c.name column_name</span><br><span class="line">        , t.Name data_type</span><br><span class="line">        , c.max_length</span><br><span class="line">        , c.column_id</span><br><span class="line">        , c.is_nullable</span><br><span class="line">    FROM sys.columns c</span><br><span class="line">    JOIN sys.types t ON c.system_type_id = t.system_type_id</span><br><span class="line">    LEFT OUTER JOIN sys.index_columns ic ON ic.object_id = c.object_id AND ic.column_id = c.column_id</span><br><span class="line">    LEFT OUTER JOIN sys.indexes i ON ic.object_id = i.object_id AND ic.index_id = i.index_id</span><br><span class="line">    WHERE c.object_id = OBJECT_ID(@table)</span><br><span class="line">    ORDER BY c.column_id</span><br><span class="line"></span><br><span class="line">    OPEN local_change_cursor</span><br><span class="line">    FETCH NEXT FROM local_change_cursor</span><br><span class="line">    INTO @row_id, @column_name, @data_type, @max_length, @column_id,@is_nullable</span><br><span class="line"></span><br><span class="line">    WHILE @@FETCH_STATUS = 0</span><br><span class="line">    BEGIN</span><br><span class="line"></span><br><span class="line">        IF (@max_length = -1) OR (@max_length &gt; 4000) SET @max_length = 4000;</span><br><span class="line">        IF (@is_nullable = 1) SET @nullornot=&apos; not null&apos; ELSE SET @nullornot=&apos;&apos;</span><br><span class="line"></span><br><span class="line">        IF (@data_type LIKE &apos;%char%&apos;)</span><br><span class="line">        BEGIN TRY</span><br><span class="line">            SET @sql = &apos;ALTER TABLE &apos; + @table + &apos; ALTER COLUMN &apos; + @column_name + &apos; &apos; + @data_type + &apos;(&apos; + CAST(@max_length AS nvarchar(100)) + &apos;) COLLATE &apos; + @collate  +&apos; &apos; +@nullornot</span><br><span class="line">            PRINT @sql</span><br><span class="line">            EXEC sp_executesql @sql</span><br><span class="line">        END TRY</span><br><span class="line">        BEGIN CATCH</span><br><span class="line">          PRINT &apos;ERROR: Some index or constraint rely on the column &apos; + @column_name + &apos;. No conversion possible.&apos;</span><br><span class="line">          PRINT @sql</span><br><span class="line">        END CATCH</span><br><span class="line"></span><br><span class="line">        FETCH NEXT FROM local_change_cursor</span><br><span class="line">        INTO @row_id, @column_name, @data_type, @max_length, @column_id,@is_nullable</span><br><span class="line"></span><br><span class="line">    END</span><br><span class="line"></span><br><span class="line">    CLOSE local_change_cursor</span><br><span class="line">    DEALLOCATE local_change_cursor</span><br><span class="line"></span><br><span class="line">    FETCH NEXT FROM local_table_cursor</span><br><span class="line">    INTO @table</span><br><span class="line"></span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">CLOSE local_table_cursor</span><br><span class="line">DEALLOCATE local_table_cursor</span><br><span class="line"></span><br><span class="line">GO</span><br></pre></td></tr></table></figure>
</code></pre><p><span style="color: #000000;"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';">二、参数介绍</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Chinese_PRC_指针对大陆简体字UNICODE的排序规则。</p>
<p>排序规则的后半部份（即后缀）含义：</p>
<p>_BIN 二进制排序_CI(CS) 是否区分大小写：CI不区分，CS区分</p>
<p>_AI(AS) 是否区分重音：AI不区分，AS区分 </p>
<p>_KI(KS) 是否区分假名类型：KI不区分，KS区分 </p>
<p>_WI(WS) 是否区分宽度：WI不区分，WS区分</p>
<p><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';"><span style="font-family: 'Comic Sans MS';">三、整体介绍</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>在安装SQL时，我们可以选择区分大小写或安装完以后重建mastar，再选择区分大小  </p>
<p>下面是rebuildm.exe 的路径：</p>
<p>C:/Program  Files/Microsoft  SQL Server/80/Tools/Binn/rebuildm.exe        </p>
<p>若要修改排序规则，按照上面的参数设置即可。</p>
<p>若只修改一个表，用ALTER   TABLE语句</p>
<p>若修改一个库的默认排序规则，用ALTER DATABASE语句    </p>
<p>若修改整个服务器的默认排序规则，用Rebuildm.exe重建master库<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/601003d0.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/601003d0.html" itemprop="url">13个可实现超棒数据可视化效果的Javascript框架</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-14T09:18:00+08:00">
                2017-04-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://www.36dsj.com/wp-content/uploads/2014/12/1819-600x318.jpg" alt="数据可视化"></p>
<p>随着商业及其相关需求的发展，数据成为越来越重要的元素之一，为了更加直观和明显的展示商业潜在的趋势和内在的特性，我们需要使用图表和图形的方式来直观动态的展示数据内在秘密，在今天的这篇文章中我们推荐12款最棒的数据可视化的Javascript框架，希望能够帮助大家在项目中更好的实现数据可视化效果。</p>
<h2 id="ECharts"><a href="#ECharts" class="headerlink" title="ECharts"></a><strong>ECharts</strong></h2><p>提起ECharts，经常使用开源软件的朋友应该很熟悉，当然，如果你不知道也没关系。但是你肯定知道去年春节以及近期央视大规划报道的百度大数据产品，如百度迁徙、百度司南、百度大数据预测等等，这些产品的数据可视化均是通过ECharts来实现的。</p>
<p>ECharts是一款数据可视化的纯JavaScript图标库，其拥有混搭图表、拖拽重计算、制作数据视图、动态类型切换、图例开关、数据区域选择、值域漫游、多维度堆积等非常丰富的功能。</p>
<p>ECharts (Enterprise Charts 商业产品图表库)是基于HTML5 Canvas的一个纯Javascript图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。创新的拖拽重计算、数据视图、值域漫游等特性大大增强了用户体验，赋予了用户对数据进行挖掘、整合的能力。</p>
<ul>
<li><a href="http://echarts.baidu.com/doc/example.html" target="_blank" rel="noopener">ECharts在线演示&gt;&gt;&gt;</a></li>
<li><a href="http://echarts.baidu.com/doc/doc.html" target="_blank" rel="noopener">ECharts使用文档&gt;&gt;&gt;</a></li>
</ul>
<h2 id="Dygraphs-js"><a href="#Dygraphs-js" class="headerlink" title="Dygraphs.js"></a><strong>Dygraphs.js</strong></h2><p>Dygraphs是一款允许开发人员创建互动图表的JS类库。数据越多，图表功能越强大。也就是说Dyrgaphs是基于视觉化来包含大量的视图。可以分开的分析和展示数据不同部分，例如指定月份。同时这个类库兼容主要的浏览器，并且支持触摸，使得它成为一个完整健壮的视觉化框架.</p>
<ul>
<li><a href="http://dygraphs.com/gallery/#g/resize" target="_blank" rel="noopener">Dygraphs.js Resize演示</a></li>
<li><a href="http://dygraphs.com/options.html" target="_blank" rel="noopener">Dygraph.js Options文档</a></li>
</ul>
<h2 id="D3-js"><a href="#D3-js" class="headerlink" title="D3.js"></a><strong>D3.js</strong></h2><p>最后成为了<a href="http://mbostock.github.io/protovis/" target="_blank" rel="noopener">Protovis.js</a>的继承者，D3能够帮助你通过动态更新DOM来创建令人赞叹的图形。D3.js使用链式方法来创建可视化，并且代码可重用。因为基于DOM，D3支持w3c的web标准，所以能够正确的在web浏览器中正确的渲染。最后，D3的路径生成方法（d3.svg.line()），给予了开发人员通过定义不同路径和属性来创建实用SVG的方法</p>
<ul>
<li><a href="http://www.gbtags.com/gb/linkviewer/3545.htm" target="_blank" rel="noopener">Wimbledon Interactive Circle SVG</a></li>
<li><a href="https://github.com/mbostock/d3/wiki/" target="_blank" rel="noopener">D3.js文档</a></li>
</ul>
<h2 id="InfoVis"><a href="#InfoVis" class="headerlink" title="InfoVis"></a><strong>InfoVis</strong></h2><p>infoVis是Javascript infovis toolkit(JIT)，同样也提供了数据可视化的功能。支持<a href="http://en.wikipedia.org/wiki/WebGL" target="_blank" rel="noopener">WebGL</a>，infovis被很多的组织例如，Mozilla，Aljazeera认可。和D3框架配合，infovis也提供了链式方法来操作DOM，使得它也成为了一个非常可靠的JS类库。</p>
<ul>
<li><a href="http://www.whitehouse.gov/winning-the-future/interactive-budget" target="_blank" rel="noopener">President Obama Budget TreeMap</a></li>
<li><a href="http://philogb.github.io/jit/static/v20/Docs/files/Core/Core-js.html" target="_blank" rel="noopener">InfoVis文档</a></li>
</ul>
<h2 id="The-Google-Visualization-API"><a href="#The-Google-Visualization-API" class="headerlink" title="The Google Visualization API"></a><strong>The Google Visualization API</strong></h2><p>来自Google developers console(GDC)，google的可视化API。除了非常容易使用的DOM修改，这个Google API使得定义定制的方法非常简单。而且界面可用性，及其来自GDC的开源网络支持，使得它也成为了顶级的可视化功能。</p>
<ul>
<li><a href="https://developers.google.com/chart/interactive/docs/reference" target="_blank" rel="noopener">GDC Visualization API Documentation</a></li>
<li><a href="http://thematicmapping.org/api/prism.php" target="_blank" rel="noopener">Visualization API – Google Spreadsheet – Google Earth API</a></li>
</ul>
<h2 id="Springy-js"><a href="#Springy-js" class="headerlink" title="Springy.js"></a><strong>Springy.js</strong></h2><p>Spring.js是一个使用特定算法来实现<a href="http://en.wikipedia.org/wiki/Force-directed_graph_drawing" target="_blank" rel="noopener">force-directed graphs</a>的Javascript类库，在web页面成类似喷泉样式的节点。虽然它包含了预先定义的算法，我们仍旧可以传入一些参数例如，斜率及其减幅。Springy.js由Dennis Hotson开发。</p>
<ul>
<li><a href="http://getspringy.com/demo.html" target="_blank" rel="noopener">Springy.js Node-Drag Demo</a></li>
<li><a href="https://github.com/dhotson/springy/" target="_blank" rel="noopener">Springy.js GitHub Repo</a></li>
</ul>
<h2 id="Polymaps-js"><a href="#Polymaps-js" class="headerlink" title="Polymaps.js"></a><strong>Polymaps.js</strong></h2><p>使用SVG来生成互动的web地图，并且兼容浏览器。核心是矢量的片段，帮助确保加载速度和缩放功能。虽然可能需要配置组件，Polymaps很容备定制，能够处理数据为矢量几何，<a href="http://geojson.org/geojson-spec.html" target="_blank" rel="noopener">GeoJSON Files</a>及其其它。</p>
<ul>
<li><a href="http://polymaps.org/ex/unemployment.html" target="_blank" rel="noopener">Census Borough Unemployment Map</a></li>
<li><a href="http://polymaps.org/docs/" target="_blank" rel="noopener">Polymaps.js文档 Documentation</a></li>
</ul>
<h2 id="Dimple"><a href="#Dimple" class="headerlink" title="Dimple"></a><strong>Dimple</strong></h2><p>Dimple API可以帮助分析师不需要了解太多技术内容而开发强大的数据可视化效果，简单的说，Dimple是的任何人都能够开发令人惊叹的三维图形效果，不需要掌握任何的JS知识。 而且<a href="http://www.gbtags.com/gb/linkviewer/3529.htm" target="_blank" rel="noopener">dimplejs.org</a>包含了几个超棒的演示，可以很简单的使用用户自己数据来生成效果。如果你不希望了解太深入的JS效果的话，这些例子是你开始使用的必备工具</p>
<ul>
<li><a href="http://dimplejs.org/examples_index.html" target="_blank" rel="noopener">Dimple API演示</a></li>
<li><a href="https://github.com/PMSI-AlignAlytics/dimple/wiki" target="_blank" rel="noopener">Dimple API文档</a></li>
</ul>
<h2 id="Sigma-js"><a href="#Sigma-js" class="headerlink" title="Sigma.js"></a><strong>Sigma.js</strong></h2><p>如果你需要开发高级特性的线型图，Sigma.js在它的类库和插件中提供了一个超棒的互动设置。使用Sigma.js感觉就想使用一个可靠地类库。然而，Sigma鼓励开发人员去重新的配置类库创建插件，这样导致了大量的开源。 Sigma让人使用非常的舒服，是我个人比较喜欢的用来创建图形效果的Javascript类库</p>
<ul>
<li><a href="http://www.gbtags.com/gb/linkviewer/3546.htm" target="_blank" rel="noopener">Sigma.js翻转效果</a></li>
<li><a href="https://github.com/jacomyal/sigma.js" target="_blank" rel="noopener">Sigma.js文档</a></li>
</ul>
<h2 id="Raphael-js"><a href="#Raphael-js" class="headerlink" title="Raphael.js"></a><strong>Raphael.js</strong></h2><p>Raphael.js类库专注于浏览器的兼容性。 这个框架遵循了SVG W3C推荐，使用一套标准来保证图片完全缩放并且没有像素损失。除了使用SVG，Rapheal.js在IE9之前使用Vector Model Language（VML）。虽然VML不在广泛使用，这个支持使得Raphael.js拥有最好的兼容性。</p>
<ul>
<li><a href="http://raphaeljs.com/pie.html" target="_blank" rel="noopener">Raphael.js饼图演示</a></li>
<li><a href="http://raphaeljs.com/reference.html" target="_blank" rel="noopener">Raphael.js文档</a></li>
</ul>
<h2 id="gRaphael"><a href="#gRaphael" class="headerlink" title="gRaphaël"></a><strong>gRaphaël</strong></h2><p>虽然Raphael.js是一个用来创建SVG的类库，它并不是用来处理大量数据集的。相反gRaphaë是用来处理这样类型数据的。对于一个10KB数据，gRaphaël被证明是一个非常不错的Raphael扩展。虽然它没有使用forece-driven算法来开发，也没有包含任何物理属性，gRaphaël仍旧是一个在跨SVG结构兼容解决方案中非常值得尊重的类库，而且使用简单。只要对于项目来说它合适，就应该作为完整项目中的一个可行的资源来看待。</p>
<ul>
<li><a href="http://g.raphaeljs.com/linechart.html" target="_blank" rel="noopener">gRaphael.js直线图效果</a></li>
<li><a href="http://g.raphaeljs.com/reference.html" target="_blank" rel="noopener">gRaphael.js文档</a></li>
</ul>
<h2 id="Leaflet"><a href="#Leaflet" class="headerlink" title="Leaflet"></a><strong>Leaflet</strong></h2><p>无论开发智能手机，平板或者桌面，Leaflet的Javascript类库绝对是一个互动类库中排名比较高的。 以下是几点原因：由MapBox的创世人Vladimir Agafonkin所领导，整个团队尝试开发简单，高性能，高用户体验的类库。Leaflet通过vector tiles分享渲染SVG的能力。</p>
<p>然而，只有leaflet支持Retina显示。而且能够解析数据形式例如，<a href="http://geojson.org/geojson-spec.html" target="_blank" rel="noopener">GeoJSON</a>。</p>
<ul>
<li><a href="http://codepen.io/leemark/pen/vcbuf" target="_blank" rel="noopener">Leaflet API Manhattan Geolocation</a></li>
<li><a href="http://leafletjs.com/features.html" target="_blank" rel="noopener">Leaflet特性</a></li>
</ul>
<h2 id="Ember-Charts"><a href="#Ember-Charts" class="headerlink" title="Ember Charts"></a><strong>Ember Charts</strong></h2><p>如果你使用<a href="http://emberjs.com/" target="_blank" rel="noopener">Ember.js</a>，那么来自<a href="http://addepar.github.io/" target="_blank" rel="noopener">Addepar Open Source</a>的开发人员创建了一些附属组件来扩展ember的体验：</p>
<p>Ember table，Ember Widget和Ember图表。它使用Ember.js和D3.js来实现，包含了扁平化设计属性。包含了一系列的实用的选项，例如，颜色和尺寸，是的非常简单实现一些令人印象深刻的视觉效果。</p>
<ul>
<li><a href="http://addepar.github.io/#/ember-charts/time_series" target="_blank" rel="noopener">Ember Charts Time-Series Chart</a></li>
<li><a href="http://addepar.github.io/#/ember-charts/time_series" target="_blank" rel="noopener">Ember Charts文档</a></li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h2><p>如果你也有一些没有包含到此篇文章中的Javascript类库，请给我们留言。目前的大数据趋势使得数据可视化成为未来大家所推崇的一种互动展示模式。如果你早一些了解或者掌握相信对于你未来将会非常有帮助！<br>End.</p>
<p>转载请注明来自36大数据（36dsj.com)：<a href="http://www.36dsj.com/" target="_blank" rel="noopener">36大数据</a> » <a href="http://www.36dsj.com/archives/19522" target="_blank" rel="noopener">13个可实现超棒数据可视化效果的Javascript框架</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/839b23c.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/839b23c.html" itemprop="url">C#创建数字证书并导出为pfx，并使用pfx进行非对称加解密</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-12T17:20:00+08:00">
                2017-04-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文源程序下载：<a href="http://download.csdn.net/source/2444494" target="_blank" rel="noopener">http://download.csdn.net/source/2444494</a></p>
<p>我的项目当中，考虑到安全性，需要为每个客户端分发一个数字证书，同时使用数字证书中的公私钥来进行数据的加解密。为了完成这个安全模块，特写了如下一个DEMO程序，该DEMO程序包含的功能有：</p>
<p>1：调用.NET2.0的MAKECERT创建含有私钥的数字证书，并存储到个人证书区；</p>
<p>2：将该证书导出为pfx文件，并为其指定一个用来打开pfx文件的password；</p>
<p>3：读取pfx文件，导出pfx中公钥和私钥；</p>
<p>4：用pfx证书中的公钥进行数据的加密，用私钥进行数据的解密；</p>
<p>系统界面：</p>
<p><img src="http://pangguoming.com/blog/images/af87f366-27c7-4242-b993-d86ee794e3d5.gif" alt=""></p>
<p>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/// &lt;summary&gt;  </span><br><span class="line">            /// 将证书从证书存储区导出，并存储为pfx文件，同时为pfx文件指定打开的密码  </span><br><span class="line">            /// 本函数同时也演示如何用公钥进行加密，私钥进行解密  </span><br><span class="line">            /// &lt;/summary&gt;  </span><br><span class="line">            /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            private void btn_toPfxFile_Click(object sender, EventArgs e)  </span><br><span class="line">            &#123;  </span><br><span class="line">                X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);  </span><br><span class="line">                store.Open(OpenFlags.ReadWrite);  </span><br><span class="line">                X509Certificate2Collection storecollection = (X509Certificate2Collection)store.Certificates;  </span><br><span class="line">                foreach (X509Certificate2 x509 in storecollection)  </span><br><span class="line">                &#123;  </span><br><span class="line">                    if (x509.Subject == &quot;CN=luminji&quot;)  </span><br><span class="line">                    &#123;  </span><br><span class="line">                        Debug.Print(string.Format(&quot;certificate name: &#123;0&#125;&quot;, x509.Subject));  </span><br><span class="line">                        byte[] pfxByte = x509.Export(X509ContentType.Pfx, &quot;123&quot;);  </span><br><span class="line">                        using (FileStream  fileStream = new FileStream(&quot;luminji.pfx&quot;, FileMode.Create))  </span><br><span class="line">                        &#123;  </span><br><span class="line">                            // Write the data to the file, byte by byte.  </span><br><span class="line">                            for (int i = 0; i &lt; pfxByte.Length; i++)  </span><br><span class="line">                                fileStream.WriteByte(pfxByte[i]);  </span><br><span class="line">                            // Set the stream position to the beginning of the file.  </span><br><span class="line">                            fileStream.Seek(0, SeekOrigin.Begin);  </span><br><span class="line">                            // Read and verify the data.  </span><br><span class="line">                            for (int i = 0; i &lt; fileStream.Length; i++)  </span><br><span class="line">                            &#123;  </span><br><span class="line">                                if (pfxByte[i] != fileStream.ReadByte())  </span><br><span class="line">                                &#123;  </span><br><span class="line">                                    Debug.Print(&quot;Error writing data.&quot;);  </span><br><span class="line">                                    return;  </span><br><span class="line">                                &#125;  </span><br><span class="line">                            &#125;  </span><br><span class="line">                            fileStream.Close();  </span><br><span class="line">                            Debug.Print(&quot;The data was written to &#123;0&#125; &quot; +  </span><br><span class="line">                                &quot;and verified.&quot;, fileStream.Name);  </span><br><span class="line">                        &#125;  </span><br><span class="line">                        string myname = &quot;my name is luminji! and i love huzhonghua!&quot;;  </span><br><span class="line">                        string enStr = this.RSAEncrypt(x509.PublicKey.Key.ToXmlString(false), myname);  </span><br><span class="line">                        MessageBox.Show(&quot;密文是：&quot; + enStr);  </span><br><span class="line">                        string deStr = this.RSADecrypt(x509.PrivateKey.ToXmlString(true), enStr);  </span><br><span class="line">                        MessageBox.Show(&quot;明文是：&quot; + deStr);  </span><br><span class="line">                    &#125;  </span><br><span class="line">                &#125;  </span><br><span class="line">                store.Close();  </span><br><span class="line">                store = null;  </span><br><span class="line">                storecollection = null;  </span><br><span class="line">            &#125;  </span><br><span class="line">            /// &lt;summary&gt;  </span><br><span class="line">            /// 创建还有私钥的证书  </span><br><span class="line">            /// &lt;/summary&gt;  </span><br><span class="line">            /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            private void btn_createPfx_Click(object sender, EventArgs e)  </span><br><span class="line">            &#123;  </span><br><span class="line">                string MakeCert = &quot;C://Program Files//Microsoft Visual Studio 8//SDK//v2.0//Bin//makecert.exe&quot;;  </span><br><span class="line">                string x509Name = &quot;CN=luminji&quot;;  </span><br><span class="line">                string param = &quot; -pe -ss my -n /&quot;&quot; + x509Name + &quot;/&quot; &quot; ;  </span><br><span class="line">                Process p = Process.Start(MakeCert, param);  </span><br><span class="line">                p.WaitForExit();  </span><br><span class="line">                p.Close();  </span><br><span class="line">                MessageBox.Show(&quot;over&quot;);  </span><br><span class="line">            &#125;  </span><br><span class="line">            /// &lt;summary&gt;  </span><br><span class="line">            /// 从pfx文件读取证书信息  </span><br><span class="line">            /// &lt;/summary&gt;  </span><br><span class="line">            /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            private void btn_readFromPfxFile(object sender, EventArgs e)  </span><br><span class="line">            &#123;  </span><br><span class="line">                X509Certificate2 pc = new X509Certificate2(&quot;luminji.pfx&quot;, &quot;123&quot;);  </span><br><span class="line">                MessageBox.Show(&quot;name:&quot; + pc.SubjectName.Name);  </span><br><span class="line">                MessageBox.Show(&quot;public:&quot; + pc.PublicKey.ToString());  </span><br><span class="line">                MessageBox.Show(&quot;private:&quot; + pc.PrivateKey.ToString());  </span><br><span class="line">                pc = null;  </span><br><span class="line">            &#125;  </span><br><span class="line">            /// &lt;summary&gt;  </span><br><span class="line">            /// RSA解密  </span><br><span class="line">            /// &lt;/summary&gt;  </span><br><span class="line">            /// &lt;param name=&quot;xmlPrivateKey&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;param name=&quot;m_strDecryptString&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">            public string RSADecrypt(string xmlPrivateKey, string m_strDecryptString)  </span><br><span class="line">            &#123;  </span><br><span class="line">                RSACryptoServiceProvider provider = new RSACryptoServiceProvider();  </span><br><span class="line">                provider.FromXmlString(xmlPrivateKey);  </span><br><span class="line">                byte[] rgb = Convert.FromBase64String(m_strDecryptString);  </span><br><span class="line">                byte[] bytes = provider.Decrypt(rgb, false);  </span><br><span class="line">                return new UnicodeEncoding().GetString(bytes);  </span><br><span class="line">            &#125;  </span><br><span class="line">            /// &lt;summary&gt;  </span><br><span class="line">            /// RSA加密  </span><br><span class="line">            /// &lt;/summary&gt;  </span><br><span class="line">            /// &lt;param name=&quot;xmlPublicKey&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;param name=&quot;m_strEncryptString&quot;&gt;&lt;/param&gt;  </span><br><span class="line">            /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">            public string RSAEncrypt(string xmlPublicKey, string m_strEncryptString)  </span><br><span class="line">            &#123;  </span><br><span class="line">                RSACryptoServiceProvider provider = new RSACryptoServiceProvider();  </span><br><span class="line">                provider.FromXmlString(xmlPublicKey);  </span><br><span class="line">                byte[] bytes = new UnicodeEncoding().GetBytes(m_strEncryptString);  </span><br><span class="line">                return Convert.ToBase64String(provider.Encrypt(bytes, false));  </span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p> 上文是一个示例程序，一个完整的证书工具类如下：</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre class=&quot;brush:csharp;gutter:true;&quot;&gt;public sealed class DataCertificate  </span><br><span class="line">    &#123;  </span><br><span class="line">        #region 生成证书  </span><br><span class="line">        /// &lt;summary&gt;  </span><br><span class="line">        /// 根据指定的证书名和makecert全路径生成证书（包含公钥和私钥，并保存在MY存储区）  </span><br><span class="line">        /// &lt;/summary&gt;  </span><br><span class="line">        /// &lt;param name=&quot;subjectName&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;param name=&quot;makecertPath&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">        public static bool CreateCertWithPrivateKey(string subjectName, string makecertPath)  </span><br><span class="line">        &#123;  </span><br><span class="line">            subjectName = &quot;CN=&quot; + subjectName;  </span><br><span class="line">            string param = &quot; -pe -ss my -n /&quot;&quot; + subjectName + &quot;/&quot; &quot;;  </span><br><span class="line">            try  </span><br><span class="line">            &#123;  </span><br><span class="line">                Process p = Process.Start(makecertPath, param);  </span><br><span class="line">                p.WaitForExit();  </span><br><span class="line">                p.Close();  </span><br><span class="line">            &#125;  </span><br><span class="line">            catch (Exception e)  </span><br><span class="line">            &#123;  </span><br><span class="line">                LogRecord.putErrorLog(e.ToString(), &quot;DataCerficate.CreateCertWithPrivateKey&quot;);  </span><br><span class="line">                return false;  </span><br><span class="line">            &#125;  </span><br><span class="line">            return true;  </span><br><span class="line">        &#125;  </span><br><span class="line">        #endregion  </span><br><span class="line"></span><br><span class="line">        #region 文件导入导出  </span><br><span class="line">        /// &lt;summary&gt;  </span><br><span class="line">        /// 从WINDOWS证书存储区的个人MY区找到主题为subjectName的证书，  </span><br><span class="line">        /// 并导出为pfx文件，同时为其指定一个密码  </span><br><span class="line">        /// 并将证书从个人区删除(如果isDelFromstor为true)  </span><br><span class="line">        /// &lt;/summary&gt;  </span><br><span class="line">        /// &lt;param name=&quot;subjectName&quot;&gt;证书主题，不包含CN=&lt;/param&gt;  </span><br><span class="line">        /// &lt;param name=&quot;pfxFileName&quot;&gt;pfx文件名&lt;/param&gt;  </span><br><span class="line">        /// &lt;param name=&quot;password&quot;&gt;pfx文件密码&lt;/param&gt;  </span><br><span class="line">        /// &lt;param name=&quot;isDelFromStore&quot;&gt;是否从存储区删除&lt;/param&gt;  </span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">        public static bool ExportToPfxFile(string subjectName, string pfxFileName,  </span><br><span class="line">            string password, bool isDelFromStore)  </span><br><span class="line">        &#123;  </span><br><span class="line">            subjectName = &quot;CN=&quot; + subjectName;  </span><br><span class="line">            X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);  </span><br><span class="line">            store.Open(OpenFlags.ReadWrite);  </span><br><span class="line">            X509Certificate2Collection storecollection = (X509Certificate2Collection)store.Certificates;  </span><br><span class="line">            foreach (X509Certificate2 x509 in storecollection)  </span><br><span class="line">            &#123;  </span><br><span class="line">                if (x509.Subject == subjectName)  </span><br><span class="line">                &#123;  </span><br><span class="line">                    Debug.Print(string.Format(&quot;certificate name: &#123;0&#125;&quot;, x509.Subject));  </span><br><span class="line"></span><br><span class="line">                    byte[] pfxByte = x509.Export(X509ContentType.Pfx, password);  </span><br><span class="line">                    using (FileStream fileStream = new FileStream(pfxFileName, FileMode.Create))  </span><br><span class="line">                    &#123;  </span><br><span class="line">                        // Write the data to the file, byte by byte.  </span><br><span class="line">                        for (int i = 0; i &lt; pfxByte.Length; i++)  </span><br><span class="line">                            fileStream.WriteByte(pfxByte[i]);  </span><br><span class="line">                        // Set the stream position to the beginning of the file.  </span><br><span class="line">                        fileStream.Seek(0, SeekOrigin.Begin);  </span><br><span class="line">                        // Read and verify the data.  </span><br><span class="line">                        for (int i = 0; i &lt; fileStream.Length; i++)  </span><br><span class="line">                        &#123;  </span><br><span class="line">                            if (pfxByte[i] != fileStream.ReadByte())  </span><br><span class="line">                            &#123;  </span><br><span class="line">                                LogRecord.putErrorLog(&quot;Export pfx error while verify the pfx file!&quot;, &quot;ExportToPfxFile&quot;);  </span><br><span class="line">                                fileStream.Close();  </span><br><span class="line">                                return false;  </span><br><span class="line">                            &#125;  </span><br><span class="line">                        &#125;  </span><br><span class="line">                        fileStream.Close();  </span><br><span class="line">                    &#125;  </span><br><span class="line">                    if( isDelFromStore == true)  </span><br><span class="line">                        store.Remove(x509);  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">            store.Close();  </span><br><span class="line">            store = null;  </span><br><span class="line">            storecollection = null;  </span><br><span class="line">            return true;  </span><br><span class="line">        &#125;  </span><br><span class="line">        /// &lt;summary&gt;  </span><br><span class="line">        /// 从WINDOWS证书存储区的个人MY区找到主题为subjectName的证书，  </span><br><span class="line">        /// 并导出为CER文件（即，只含公钥的）  </span><br><span class="line">        /// &lt;/summary&gt;  </span><br><span class="line">        /// &lt;param name=&quot;subjectName&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;param name=&quot;cerFileName&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">        public static bool ExportToCerFile(string subjectName, string cerFileName)  </span><br><span class="line">        &#123;  </span><br><span class="line">            subjectName = &quot;CN=&quot; + subjectName;  </span><br><span class="line">            X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);  </span><br><span class="line">            store.Open(OpenFlags.ReadWrite);  </span><br><span class="line">            X509Certificate2Collection storecollection = (X509Certificate2Collection)store.Certificates;  </span><br><span class="line">            foreach (X509Certificate2 x509 in storecollection)  </span><br><span class="line">            &#123;  </span><br><span class="line">                if (x509.Subject == subjectName)  </span><br><span class="line">                &#123;  </span><br><span class="line">                    Debug.Print(string.Format(&quot;certificate name: &#123;0&#125;&quot;, x509.Subject));  </span><br><span class="line">                    //byte[] pfxByte = x509.Export(X509ContentType.Pfx, password);  </span><br><span class="line">                    byte[] cerByte = x509.Export(X509ContentType.Cert);  </span><br><span class="line">                    using (FileStream fileStream = new FileStream(cerFileName, FileMode.Create))  </span><br><span class="line">                    &#123;  </span><br><span class="line">                        // Write the data to the file, byte by byte.  </span><br><span class="line">                        for (int i = 0; i &lt; cerByte.Length; i++)  </span><br><span class="line">                            fileStream.WriteByte(cerByte[i]);  </span><br><span class="line">                        // Set the stream position to the beginning of the file.  </span><br><span class="line">                        fileStream.Seek(0, SeekOrigin.Begin);  </span><br><span class="line">                        // Read and verify the data.  </span><br><span class="line">                        for (int i = 0; i &lt; fileStream.Length; i++)  </span><br><span class="line">                        &#123;  </span><br><span class="line">                            if (cerByte[i] != fileStream.ReadByte())  </span><br><span class="line">                            &#123;  </span><br><span class="line">                                LogRecord.putErrorLog(&quot;Export CER error while verify the CERT file!&quot;, &quot;ExportToCERFile&quot;);  </span><br><span class="line">                                fileStream.Close();  </span><br><span class="line">                                return false;  </span><br><span class="line">                            &#125;  </span><br><span class="line">                        &#125;  </span><br><span class="line">                        fileStream.Close();  </span><br><span class="line">                    &#125;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">            store.Close();  </span><br><span class="line">            store = null;  </span><br><span class="line">            storecollection = null;  </span><br><span class="line">            return true;  </span><br><span class="line">        &#125;  </span><br><span class="line">        #endregion  </span><br><span class="line"></span><br><span class="line">        #region 从证书中获取信息  </span><br><span class="line">        /// &lt;summary&gt;  </span><br><span class="line">        /// 根据私钥证书得到证书实体，得到实体后可以根据其公钥和私钥进行加解密  </span><br><span class="line">        /// 加解密函数使用DEncrypt的RSACryption类  </span><br><span class="line">        /// &lt;/summary&gt;  </span><br><span class="line">        /// &lt;param name=&quot;pfxFileName&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;param name=&quot;password&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">        public static X509Certificate2 GetCertificateFromPfxFile(string pfxFileName,  </span><br><span class="line">            string password)  </span><br><span class="line">        &#123;  </span><br><span class="line">            try  </span><br><span class="line">            &#123;  </span><br><span class="line">                return new X509Certificate2(pfxFileName, password, X509KeyStorageFlags.Exportable);  </span><br><span class="line">            &#125;  </span><br><span class="line">            catch (Exception e)  </span><br><span class="line">            &#123;  </span><br><span class="line">                LogRecord.putErrorLog(&quot;get certificate from pfx&quot; + pfxFileName + &quot; error:&quot; + e.ToString(),  </span><br><span class="line">                    &quot;GetCertificateFromPfxFile&quot;);  </span><br><span class="line">                return null;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">        /// &lt;summary&gt;  </span><br><span class="line">        /// 到存储区获取证书  </span><br><span class="line">        /// &lt;/summary&gt;  </span><br><span class="line">        /// &lt;param name=&quot;subjectName&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;  </span><br><span class="line">        public static X509Certificate2 GetCertificateFromStore(string subjectName)  </span><br><span class="line">        &#123;  </span><br><span class="line">            subjectName = &quot;CN=&quot; + subjectName;  </span><br><span class="line">            X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);  </span><br><span class="line">            store.Open(OpenFlags.ReadWrite);  </span><br><span class="line">            X509Certificate2Collection storecollection = (X509Certificate2Collection)store.Certificates;  </span><br><span class="line">            foreach (X509Certificate2 x509 in storecollection)  </span><br><span class="line">            &#123;  </span><br><span class="line">                if (x509.Subject == subjectName)  </span><br><span class="line">                &#123;  </span><br><span class="line">                    return x509;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">            store.Close();  </span><br><span class="line">            store = null;  </span><br><span class="line">            storecollection = null;  </span><br><span class="line">            return null;  </span><br><span class="line">        &#125;  </span><br><span class="line">        /// &lt;summary&gt;  </span><br><span class="line">        /// 根据公钥证书，返回证书实体  </span><br><span class="line">        /// &lt;/summary&gt;  </span><br><span class="line">        /// &lt;param name=&quot;cerPath&quot;&gt;&lt;/param&gt;  </span><br><span class="line">        public static X509Certificate2 GetCertFromCerFile(string cerPath)  </span><br><span class="line">        &#123;  </span><br><span class="line">            try  </span><br><span class="line">            &#123;  </span><br><span class="line">                return new X509Certificate2(cerPath);  </span><br><span class="line">            &#125;  </span><br><span class="line">            catch (Exception e)  </span><br><span class="line">            &#123;  </span><br><span class="line">                LogRecord.putErrorLog(e.ToString(), &quot;DataCertificate.LoadStudentPublicKey&quot;);  </span><br><span class="line">                return null;  </span><br><span class="line">            &#125;              </span><br><span class="line">        &#125;  </span><br><span class="line">        #endregion         </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre><p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/27/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/27/">27</a><span class="page-number current">28</span><a class="page-number" href="/page/29/">29</a><span class="space">&hellip;</span><a class="page-number" href="/page/42/">42</a><a class="extend next" rel="next" href="/page/29/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4" alt="庞国明">
            
              <p class="site-author-name" itemprop="name">庞国明</p>
              <p class="site-description motion-element" itemprop="description">Software make the information world run, and programer make the softeware run.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">420</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">267</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/pangguoming" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:pangguoming@yeah.net" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/pangguoming" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/users/1570700/pangguoming" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/pangguoming" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">庞国明</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  

  

  

</body>
</html>
