<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Software make the information world run, and programer make the softeware run.">
<meta property="og:type" content="website">
<meta property="og:title" content="庞国明-博客">
<meta property="og:url" content="http://pangguoming.com/page/38/index.html">
<meta property="og:site_name" content="庞国明-博客">
<meta property="og:description" content="Software make the information world run, and programer make the softeware run.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="庞国明-博客">
<meta name="twitter:description" content="Software make the information world run, and programer make the softeware run.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pangguoming.com/page/38/">





  <title>庞国明-博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">庞国明-博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">此心用度八千遍，不曾厌倦</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/ff8684a2.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/ff8684a2.html" itemprop="url">迭代式开发使用方法总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-30T09:36:00+08:00">
                2015-10-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>为什么我在这里主要讨论迭代式软件开发？本文在此抛开千篇一律的理论，拟就根据多年的实践，总结出一套比较务实、可操作性强的方法，以期望在有限的资源下确保软件质量得到较大保证。一家之见，纰漏之处还请大家多多指正。
</code></pre><p>迭代式软件开发模式简要流程如下：</p>
<pre><code> ![](http://pangguoming.com/blog/images/2a36e8d4-7799-44b5-aee4-41390cffabdb.jpg)

上图绿色大框内，我们就称之为一个迭代周期。每一个迭代，都可以形成一个可交付的小版本。事实上，每一个迭代周期内，对于编码和测试也可以进行多次迭代。通过快速发布测试构建的方式，验证开发完成的新功能，再通过测试发现问题来驱动开发人员对软件进行修改完善，循环往复。即：根据开发情况有针对性地组织测试，根据测试结果反作用于开发人员去完善软件质量。以这种小步快跑的方式，经过若干测试构建后，软件质量可以在较短时间内达到稳定状态。
</code></pre><p>质量保证，需要系统性的方法。那么在迭代式开发的各个阶段，都需要怎样的措施呢？</p>
<p><strong>1）需求</strong></p>
<pre><code>这个阶段的主要工作是需求制定与评审。该阶段的工作分三步走：收集原始需求 -&gt;制定产品需求 -&gt; 产品需求评审。具体说来，首先我们通过各种渠道收集原始需求，由于原始需求多半是概念性的、模糊的，不能直接用来指导开发工作，所以需要进行归类、筛选，整合为产品需求。基本原则是，结合当前开发产品的特性，争取以最小的改动以及最大的可扩展性来制定产品需求。降低风险，同时提高灵活性。经验告诉我们，在需求没有考虑透彻的情况下，不要贸然开始设计并实现，可能导致大量返工，费时费力。产品需求制定好后，需要进行评审，一定不要觉得浪费时间而不去评审，磨刀不误砍柴工嘛！
</code></pre><p><strong>2） 设计</strong></p>
<pre><code>这个阶段的主要工作是将产品需求转化为设计需求，指导后续的编码工作。软件行业有一名老话是：软件质量是设计出来的，对于迭代式开发也是如此。设计的好坏直接决定了软件质量的高低。设计需求一般阐述了产品需求的详细设计方案，包括页面布局、数据结构、算法以及易用性、安全性、可扩展性、健壮性和性能等诸多方面的设计思路。即使让不同的开发人员根据设计需求来进行编码，开发出的功能也八九不离十。有此可见，设计需求是非常必要的。也就是说，我们在正式编码前，必须针对需求写出相应的设计文档来指导后续的编码工作。这样做有两大好处：一是在编码之前就充分预见到将来可能遇到的问题，可以尽早规避风险；二是为开发工作搭好框架，降低因开发人员的差异导致开发过程的不确定性，避免出现“一千个人心中有一千个对需求的理解”。
</code></pre><p><strong>3） 编码</strong></p>
<pre><code>这个阶段的主要工作是严格按照设计需求来完成编码，并组织进行代码评审。每一行代码都是软件大厦的一砖一瓦，我们拒绝豆腐渣工程，所以我们重视每一行代码。进行代码评审可以有效保证代码质量，借助一些IT管理工具可以轻松进行代码评审和代码管理。笔者曾经使用过青铜器RDM软件来做代码评审（CodeReview），十分方便。代码评审的重点应该是对程序结构的审查，发现深层次的软件错误，而不要停留在表面。同时，建议大家在做代码评审时，以代码的一个“提交”为单位进行评审。这样做的前提是，每个“提交”里包含相对完整的功能。对于迭代式开发，我们要尽量保证，每一个编码-测试迭代里，都要完成相对独立、可测试性强的功能点。
</code></pre><p><strong>4） 测试</strong></p>
<pre><code> 测试实质上是一种鉴定性的工作，是对软件质量的鉴定和最后一道把关。这个阶段的主要工作是，在每一个测试构建中，尽可能多地覆盖需求点，并根据轻重缓急合理安排测试优先级，尽可能将影响较大的缺陷提前暴露出来。测试优先级的安排应遵循以下原则：

a、先测试经过变更的部分，然后测试没有变更的部分

b、先测试程序的核心功能，然后测试一般功能

c、先测试逻辑性的功能，然后测试业务性的功能

d、先测试常规情况，然后测试异常情况

e、先测试功能，然后测试性能

按照上述原则进行测试，可以更快地发现更多软件中的严重错误，这是使软件能尽快稳定下来的一个关键因素。除此以外，在每一个迭代周期结束之前还要进行系统测试。

编码-测试的不断迭代，保证了每个测试构建里的新功能没有问题，但整个软件系统的质量还没有得到充分验证，系统测试就是为此而生。在版本发布前的最后冲刺阶段，“车轮战”是很管用的一个手段，即：调集测试人员、开发人员等全面参与测试，将这些人员分为若干个小组，每个小组分别对系统进行测试。每个测试模块由多人进行测试，可以有效降低缺陷的遗漏率。但需要注意的是，开发人员应该避免测试自己开发的功能，即进行交叉测试。

软件质量保证的实质是，使用一些流程、方法来管控软件开发过程，从而使最终交付的软件产品质量得到最大程度的保证。同时，相信大家可以看出，在整个产品开发过程中会产生很多数据，如需求、设计文档、代码、测试用例、缺陷等。使用IT管理工具可以有效提高工作效率，青铜器RDM全面实现CodeReview+Testlink + Mantis功能组合，可以管理需求、测试用例、缺陷、代码评审等，对于小规模团队，已经足够用了。
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/6305d698.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/6305d698.html" itemprop="url">Jade 模板引擎使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-22T10:38:00+08:00">
                2015-10-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>在 Express 中调用 jade 模板引擎</li>
<li>jade 变量调用</li>
<li>if 判断</li>
<li>循环</li>
<li>Case 选择</li>
<li>在模板中调用其他语言</li>
<li>可重用的 jade 块 (Mixins)</li>
<li>模板包含 (Includes)</li>
<li>模板引用 (Extends)</li>
</ul>
<h2 id="在-Express-中调用-jade-模板引擎"><a href="#在-Express-中调用-jade-模板引擎" class="headerlink" title="在 Express 中调用 jade 模板引擎"></a>在 Express 中调用 jade 模板引擎</h2><p><code><span class="kwd">var<span class="pln"> express <span class="pun">=<span class="pln"> <span class="kwd">require<span class="pun">(<span class="str">‘express’<span class="pun">);<span class="pln"><br>    <span class="kwd">var<span class="pln"> http <span class="pun">=<span class="pln"> <span class="kwd">require<span class="pun">(<span class="str">‘http’<span class="pun">);<span class="pln"><br>    <span class="kwd">var<span class="pln"> app <span class="pun">=<span class="pln"> express<span class="pun">();<span class="pln"><br>    app<span class="pun">.<span class="kwd">set<span class="pun">(<span class="str">‘view engine’<span class="pun">,<span class="pln"> <span class="str">‘jade’<span class="pun">);<span class="pln"> <span class="com">// 设置模板引擎<span class="pln"><br>    app<span class="pun">.<span class="kwd">set<span class="pun">(<span class="str">‘views’<span class="pun">,<span class="pln"> __dirname<span class="pun">);<span class="pln">  <span class="com">// 设置模板相对路径(相对当前目录)<span class="pln"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></p>
<pre><code>app&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;kwd&quot;&gt;get&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;/&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;function&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;req&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; res&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;{&lt;span class=&quot;pln&quot;&gt;
    res&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;render&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;test&apos;&lt;span class=&quot;pun&quot;&gt;);&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;com&quot;&gt;// 调用当前路径下的 test.jade 模板&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;pun&quot;&gt;})&lt;span class=&quot;pln&quot;&gt;

&lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; server &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; http&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;createServer&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;app&lt;span class=&quot;pun&quot;&gt;);&lt;span class=&quot;pln&quot;&gt;
server&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;listen&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;lit&quot;&gt;3002&lt;span class=&quot;pun&quot;&gt;);&lt;span class=&quot;pln&quot;&gt;
console&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;log&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;server started on http://127.0.0.1:3002/&apos;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">test.jade</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;``</span><br></pre></td></tr></table></figure>
</code></pre><p>其上的 jade 模板会被解析成</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">虽然平常我们修改 node.js 代码之后需要重启来查看变化，但是 jade 引擎不在此列，因为是动态加载的，所以我们修改完 jade 文件之后可以直接刷新网页来查看效果的。</span><br><span class="line"></span><br><span class="line">如果文本比较长可以使用</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;p</span><br><span class="line">      &lt;span class=&quot;pun&quot;&gt;|&lt;span class=&quot;pln&quot;&gt; foo bar baz</span><br><span class="line">      &lt;span class=&quot;pun&quot;&gt;|&lt;span class=&quot;pln&quot;&gt; rawr rawr&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;p&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      foo bar baz</span><br><span class="line">      rawr rawr&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">两种情况都可以处理为</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;</span><br></pre></td></tr></table></figure>

## jade 变量调用
</code></pre><p>jade 的变量调用有 3 种方式</p>
<pre><code>*   1.  `#{表达式}`
*   1.  =表达式
*   1.  !=表达式
</code></pre><p>注意：符号 <code>-</code> 开头在 jade 中属于服务端执行的代码</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; console&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;log&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;hello&apos;&lt;span class=&quot;pun&quot;&gt;);&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;com&quot;&gt;// 这段代码在服务端执行&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; s &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;hello world&apos;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;com&quot;&gt;// 在服务端空间中定义变量&lt;span class=&quot;pln&quot;&gt;
p &lt;span class=&quot;com&quot;&gt;#{s}&lt;span class=&quot;pln&quot;&gt;
p&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">会被渲染成为</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;hello world&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;hello world&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>以下代码效果相同</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; s &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;world&apos;&lt;span class=&quot;pln&quot;&gt;
p hello &lt;span class=&quot;com&quot;&gt;#{s}&lt;span class=&quot;pln&quot;&gt;
p&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;hello&apos;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt; s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">方式1可以自由的嵌入各个地方 方式2返回的是表达式的值 = 与 方式3 != 雷同，据说前者会编码字符串，如 &lt;stdio.h&gt; 变成 &lt;stdio.h&gt; 后者不会，不过博主没试出来不知道什么情况。</span><br><span class="line"></span><br><span class="line">除了直接在 jade 模板中定义变量，更常见的应用是在 express 中调用 res.render 方法的时候将变量一起传递进模板的空间中，例如这样：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;res&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;render&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;test&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;&#123;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        s&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;hello world&apos;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;pun&quot;&gt;&#125;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>调用模板的时候，在 jade 模板中也可以如上方那样直接调用 s 这个变量</p>
<pre><code>## if 判断

## 方式1

&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; user &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;{&lt;span class=&quot;pln&quot;&gt; description&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;我喜欢猫&apos;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;}&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;if&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;user&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
    h2 &lt;span class=&quot;pun&quot;&gt;描述&lt;span class=&quot;pln&quot;&gt;
    p&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; user&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description
&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;else&lt;span class=&quot;pln&quot;&gt;
    h1 &lt;span class=&quot;pun&quot;&gt;描述&lt;span class=&quot;pln&quot;&gt;
    p&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description &lt;span class=&quot;pun&quot;&gt;用户无描述&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;div&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;id&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;user&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;h2&gt;&lt;span class=&quot;pln&quot;&gt;描述&lt;span class=&quot;tag&quot;&gt;&lt;/h2&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;p&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;description&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;我喜欢猫&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/div&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>

## 方式2
</code></pre><p>上述的方式有种省略写法</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; user &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;{&lt;span class=&quot;pln&quot;&gt; description&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;我喜欢猫&apos;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;}&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;com&quot;&gt;#user&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;kwd&quot;&gt;if&lt;span class=&quot;pln&quot;&gt; user&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description
    h2 &lt;span class=&quot;pun&quot;&gt;描述&lt;span class=&quot;pln&quot;&gt;
    p&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; user&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description
  &lt;span class=&quot;kwd&quot;&gt;else&lt;span class=&quot;pln&quot;&gt;
    h1 &lt;span class=&quot;pun&quot;&gt;描述&lt;span class=&quot;pln&quot;&gt;
    p&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;description &lt;span class=&quot;pun&quot;&gt;用户无描述&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    ## 方式3</span><br><span class="line"></span><br><span class="line">使用 Unless 类似于 if 后的表达式加上了 ! 取反</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; user &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;&#123;&lt;span class=&quot;pln&quot;&gt; name&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;Alan&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; isVip&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;false&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;&#125;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;kwd&quot;&gt;unless&lt;span class=&quot;pln&quot;&gt; user&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;isVip</span><br><span class="line">      p &lt;span class=&quot;pun&quot;&gt;亲爱的&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;com&quot;&gt;#&#123;user.name&#125; 您并不是 VIP&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>结果</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意这个 unless 是 jade 提供的关键字，不是运行的 js 代码</span><br><span class="line"></span><br><span class="line">    ## 循环</span><br><span class="line"></span><br><span class="line">    ## for 循环</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; array &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;[&lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;lit&quot;&gt;2&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;lit&quot;&gt;3&lt;span class=&quot;pun&quot;&gt;]&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    ul</span><br><span class="line">      &lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;for&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; i &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;0&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; i &lt;span class=&quot;pun&quot;&gt;&lt;&lt;span class=&quot;pln&quot;&gt; array&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;length&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;++&lt;span class=&quot;pln&quot;&gt;i&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;&#123;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        li hello &lt;span class=&quot;com&quot;&gt;#&#123;array[i]&#125;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;&#125;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;ul&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;hello 1&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;hello 2&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;hello 3&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/ul&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">    ## each</span><br><span class="line"></span><br><span class="line">同样的 jade 对于循环液提供了省略 “-” 减号的写法</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;ul</span><br><span class="line">      each val&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; index &lt;span class=&quot;kwd&quot;&gt;in&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;[&lt;span class=&quot;str&quot;&gt;&apos;西瓜&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;苹果&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;梨子&apos;&lt;span class=&quot;pun&quot;&gt;]&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        li&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; index &lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;: &apos;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt; val&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;ul&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;0: 西瓜&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;1: 苹果&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;2: 梨子&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/ul&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">该方法同样适用于 json 数据</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;ul</span><br><span class="line">      each val&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; index &lt;span class=&quot;kwd&quot;&gt;in&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;&#123;&lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;str&quot;&gt;&apos;苹果&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;lit&quot;&gt;2&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;str&quot;&gt;&apos;梨子&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;lit&quot;&gt;3&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;str&quot;&gt;&apos;乔布斯&apos;&lt;span class=&quot;pun&quot;&gt;&#125;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        li&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; index &lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;: &apos;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt; val&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;ul&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;1: 苹果&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;2: 梨子&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;3: 乔布斯&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/ul&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">    ## Case</span><br><span class="line"></span><br><span class="line">类似 switch 里面的结果，不过这里的 case 不支持case 穿透，如果 case 穿透的话会报错。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; friends &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;10&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;kwd&quot;&gt;case&lt;span class=&quot;pln&quot;&gt; friends</span><br><span class="line">      &lt;span class=&quot;kwd&quot;&gt;when&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;0&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        p you have &lt;span class=&quot;kwd&quot;&gt;no&lt;span class=&quot;pln&quot;&gt; friends</span><br><span class="line">      &lt;span class=&quot;kwd&quot;&gt;when&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        p you have a &lt;span class=&quot;kwd&quot;&gt;friend&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;kwd&quot;&gt;default&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        p you have &lt;span class=&quot;com&quot;&gt;#&#123;friends&#125; friends&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>简略写法：</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;kwd&quot;&gt;var&lt;span class=&quot;pln&quot;&gt; friends &lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;kwd&quot;&gt;case&lt;span class=&quot;pln&quot;&gt; friends
  &lt;span class=&quot;kwd&quot;&gt;when&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;0&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; p you have &lt;span class=&quot;kwd&quot;&gt;no&lt;span class=&quot;pln&quot;&gt; friends
  &lt;span class=&quot;kwd&quot;&gt;when&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; p you have a &lt;span class=&quot;kwd&quot;&gt;friend&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;kwd&quot;&gt;default&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; p you have &lt;span class=&quot;com&quot;&gt;#{friends} friends&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;``</span><br></pre></td></tr></table></figure>

## 在模板中调用其他语言

&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt;markdown
  &lt;span class=&quot;com&quot;&gt;# Markdown 标题&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;pun&quot;&gt;这里使用的是&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;MarkDown&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;格式&lt;span class=&quot;pln&quot;&gt;
script
  &lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt;coffee
    console&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;log &lt;span class=&quot;str&quot;&gt;&apos;这里是 coffee script&apos;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;h1&gt;&lt;span class=&quot;pln&quot;&gt;Markdown 标题&lt;span class=&quot;tag&quot;&gt;&lt;/h1&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;这里使用的是 MarkDown 格式&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;script&gt;&lt;span class=&quot;pln&quot;&gt;console&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;log&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;这里是 coffee script&apos;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;tag&quot;&gt;&lt;/script&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>

## 可重用的 jade 块 (Mixins)

&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;com&quot;&gt;//- 申明可重用的块&lt;span class=&quot;pln&quot;&gt;
mixin list
  ul
    li foo
    li bar
    li baz

&lt;span class=&quot;com&quot;&gt;//- 调用&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt;list&lt;span class=&quot;pun&quot;&gt;()&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt;list&lt;span class=&quot;pun&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;ul&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;foo&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;bar&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;baz&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/ul&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;ul&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;foo&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;bar&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;baz&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/ul&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>你也可以给这个重用块指定参数</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;mixin pets&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;pets&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
  ul&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;pets
    &lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt; each pet &lt;span class=&quot;kwd&quot;&gt;in&lt;span class=&quot;pln&quot;&gt; pets
      li&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; pet

&lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt;pets&lt;span class=&quot;pun&quot;&gt;([&lt;span class=&quot;str&quot;&gt;&apos;cat&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;dog&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;pig&apos;&lt;span class=&quot;pun&quot;&gt;])&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;ul&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;pets&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;cat&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;dog&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;li&gt;&lt;span class=&quot;pln&quot;&gt;pig&lt;span class=&quot;tag&quot;&gt;&lt;/li&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/ul&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>Mixins 同时也支持在外部传入 jade 块</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;mixin article&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;title&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;article
    &lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;article&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt;wrapper
      h1&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt; title
      &lt;span class=&quot;com&quot;&gt;//- block 为 jade 关键字代表外部传入的块&lt;span class=&quot;pln&quot;&gt;
      &lt;span class=&quot;kwd&quot;&gt;if&lt;span class=&quot;pln&quot;&gt; block
        block
      &lt;span class=&quot;kwd&quot;&gt;else&lt;span class=&quot;pln&quot;&gt;
        p &lt;span class=&quot;pun&quot;&gt;该文章没有内容&lt;span class=&quot;pln&quot;&gt;

&lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt;article&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;Hello world&apos;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;

&lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt;article&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;Hello Jade&apos;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
  p &lt;span class=&quot;pun&quot;&gt;这里是外部传入的块&lt;span class=&quot;pln&quot;&gt;
  p &lt;span class=&quot;pun&quot;&gt;再写两句&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;div&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;article&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;div&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;article-wrapper&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;h1&gt;&lt;span class=&quot;pln&quot;&gt;Hello world&lt;span class=&quot;tag&quot;&gt;&lt;/h1&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;该文章没有内容&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;/div&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/div&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;div&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;article&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;div&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;article-wrapper&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;h1&gt;&lt;span class=&quot;pln&quot;&gt;Hello Jade&lt;span class=&quot;tag&quot;&gt;&lt;/h1&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;这里是外部传入的块&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;再写两句&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;/div&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/div&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>Mixins 同时也可以从外部获取属性。</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;mixin link&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;href&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; name&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
  a&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;kwd&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;!=&lt;span class=&quot;pln&quot;&gt;attributes&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;kwd&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; href&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt;href&lt;span class=&quot;pun&quot;&gt;)=&lt;span class=&quot;pln&quot;&gt; name

&lt;span class=&quot;pun&quot;&gt;+&lt;span class=&quot;pln&quot;&gt;link&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;str&quot;&gt;&apos;/foo&apos;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&apos;foo&apos;&lt;span class=&quot;pun&quot;&gt;)(&lt;span class=&quot;kwd&quot;&gt;class&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;btn&quot;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;``</span><br></pre></td></tr></table></figure>

## 模板包含 (Includes)
</code></pre><p>你可以使用 Includes 在模板中包含其他模板的内容。就像 PHP 里的 include 一样。</p>
<p><code>index.jade</code></p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;doctype html
html
  include includes&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;pln&quot;&gt;head
body
  h1 &lt;span class=&quot;pun&quot;&gt;我的网站&lt;span class=&quot;pln&quot;&gt;
  p &lt;span class=&quot;pun&quot;&gt;欢迎来到我的网站。&lt;span class=&quot;pln&quot;&gt;
  include includes&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;pln&quot;&gt;foot&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`includes/head.jade`</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;head</span><br><span class="line">      title &lt;span class=&quot;pun&quot;&gt;我的网站&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      script&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;src&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&apos;/javascripts/jquery.js&apos;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      script&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;src&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&apos;/javascripts/app.js&apos;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p><code>includes/foot.jade</code></p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;com&quot;&gt;#footer&lt;span class=&quot;pln&quot;&gt;
  p &lt;span class=&quot;typ&quot;&gt;Copyright&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;c&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt; foobar&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">调用 index.jade 的结果：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;dec&quot;&gt;&lt;!doctype html&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;html&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;head&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;title&gt;&lt;span class=&quot;pln&quot;&gt;我的网站&lt;span class=&quot;tag&quot;&gt;&lt;/title&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;script&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;src&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&apos;/javascripts/jquery.js&apos;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;/script&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;script&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;src&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&apos;/javascripts/app.js&apos;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;/script&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;/head&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;body&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;h1&gt;&lt;span class=&quot;pln&quot;&gt;我的网站&lt;span class=&quot;tag&quot;&gt;&lt;/h1&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;欢迎来到我的网站。&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;div&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;id&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;footer&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;Copyright (c) foobar&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;tag&quot;&gt;&lt;/div&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;tag&quot;&gt;&lt;/body&gt;&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;tag&quot;&gt;&lt;/html&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>

## 模板引用 (Extends)
</code></pre><p>通过 Extends 可以引用外部的 jade 块，感觉比 include 要好用</p>
<p><code>layout.jade</code></p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;pln&quot;&gt;doctype html
html
  head
    title &lt;span class=&quot;pun&quot;&gt;我的网站&lt;span class=&quot;pln&quot;&gt;
    meta&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;http&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt;equiv&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;Content-Type&quot;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt;content&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;text/html; charset=utf-8&quot;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
    link&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;type&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;text/css&quot;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt;rel&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;stylesheet&quot;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt;href&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;/css/style.css&quot;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
    script&lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;src&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;/js/lib/jquery-1.8.0.min.js&quot;&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt;type&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;str&quot;&gt;&quot;text/javascript&quot;&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt;
  body
    block content&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`article.jade`</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;com&quot;&gt;//- extends 拓展调用 layout.jade&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;kwd&quot;&gt;extends&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;../&lt;span class=&quot;pln&quot;&gt;layout</span><br><span class="line">    block content</span><br><span class="line">      h1 &lt;span class=&quot;pun&quot;&gt;文章列表&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      p &lt;span class=&quot;pun&quot;&gt;小明忆贾大山&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;小红:将启动新核电项目&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      p &lt;span class=&quot;pun&quot;&gt;小雷:&lt;span class=&quot;str&quot;&gt;&quot;岁月号&quot;&lt;span class=&quot;pun&quot;&gt;船长等人弃船行为等同于杀人&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      p &lt;span class=&quot;pun&quot;&gt;小静疑换肤：眼袋黑眼圈全无&lt;span class=&quot;pln&quot;&gt;人&lt;span class=&quot;pun&quot;&gt;整容疑云&lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">      p &lt;span class=&quot;pun&quot;&gt;世界最大兔子重&lt;span class=&quot;lit&quot;&gt;45&lt;span class=&quot;pun&quot;&gt;斤长逾&lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pun&quot;&gt;米&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;1&lt;span class=&quot;pun&quot;&gt;年吃&lt;span class=&quot;lit&quot;&gt;2&lt;span class=&quot;pun&quot;&gt;万元食物&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>res.render(‘article’) 的结果：</p>
<pre><code>&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;&lt;span class=&quot;tag&quot;&gt;&lt;html&gt;&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;tag&quot;&gt;&lt;head&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;title&gt;&lt;span class=&quot;pln&quot;&gt;我的网站&lt;span class=&quot;tag&quot;&gt;&lt;/title&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;meta&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;http-equiv&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;Content-Type&quot;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;content&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;text/html; charset=utf-8&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;/head&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;link&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;type&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;text/css&quot;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;rel&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;stylesheet&quot;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;href&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;/css/style.css&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;/head&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;script&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;src&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;/js/lib/jquery-1.8.0.min.js&quot;&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;atn&quot;&gt;type&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;/script&gt;&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;tag&quot;&gt;&lt;/head&gt;&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;tag&quot;&gt;&lt;body&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;h1&gt;&lt;span class=&quot;pln&quot;&gt;文章列表&lt;span class=&quot;tag&quot;&gt;&lt;/h1&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;小明忆贾大山 小红:将启动新核电项目&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;小雷:&quot;岁月号&quot;船长等人弃船行为等同于杀人&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;小静疑换肤：眼袋黑眼圈全无人整容疑云&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;
    &lt;span class=&quot;tag&quot;&gt;&lt;p&gt;&lt;span class=&quot;pln&quot;&gt;世界最大兔子重45斤长逾1米 1年吃2万元食物&lt;span class=&quot;tag&quot;&gt;&lt;/p&gt;&lt;span class=&quot;pln&quot;&gt;
  &lt;span class=&quot;tag&quot;&gt;&lt;/body&gt;&lt;span class=&quot;pln&quot;&gt;
&lt;span class=&quot;tag&quot;&gt;&lt;/html&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;```
</code></pre><p>再来搬运一发，原文地址：<a href="http://www.lellansin.com/jade-%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E4%BD%BF%E7%94%A8.html" target="_blank" rel="noopener">http://www.lellansin.com/Jade-模板引擎使用.html</a><br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/d704d8b2.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/d704d8b2.html" itemprop="url">使用Redis的五个注意事项</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-21T20:34:00+08:00">
                2015-10-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>下面内容来源于Quora上的<a href="http://www.quora.com/Redis/What-are-5-mistakes-to-avoid-when-using-Redis" target="_blank" rel="noopener">一个提问</a>，问题是使用<span class="wp_keywordlink_affiliate"><a href="http://blog.nosqlfan.com/tags/redis" title="查看 Redis 的全部文章" target="_blank" rel="noopener">Redis</a>需要避免的五个问题。而回答中超出了五个问题的范畴，描述了五个使用Redis的注意事项。如果你在使用或者考虑使用Redis，可能你可以学习一下下面的一些建议，避免一下提到的问题。</span></p>
<h3 id="1-使用key值前缀来作命名空间"><a href="#1-使用key值前缀来作命名空间" class="headerlink" title="1.使用key值前缀来作命名空间"></a>1.使用key值前缀来作命名空间</h3><p>虽然说Redis支持多个数据库（默认32个，可以配置更多），但是除了默认的0号库以外，其它的都需要通过一个额外请求才能使用。所以用前缀作为命名空间可能会更明智一点。</p>
<p>另外，在使用前缀作为命名空间区隔不同key的时候，最好在程序中使用全局配置来实现，直接在代码里写前缀的做法要严格避免，这样可维护性实在太差了。</p>
<h3 id="2-创建一个类似-”registry”-的key用于标记key使用情况"><a href="#2-创建一个类似-”registry”-的key用于标记key使用情况" class="headerlink" title="2.创建一个类似 ”registry” 的key用于标记key使用情况"></a>2.创建一个类似 ”registry” 的key用于标记key使用情况</h3><p>为了更好的管理你的key值的使用，比如哪一类key值是属于哪个业务的，你通常会在内部wiki或者什么地方创建一个文档，通过查询这个文档，我们能够知道Redis中的key都是什么作用。</p>
<p>与之结合，一个推荐的做法是，在Redis里面保存一个registry值，这个值的名字可以类似于 <strong>key_registry</strong> 这样的，这个key对应的value就是你文档的位置，这样我们在使用Redis的时候，就能通过直接查询这个值获取到当前Redis的使用情况了。</p>
<h3 id="3-注意垃圾回收"><a href="#3-注意垃圾回收" class="headerlink" title="3.注意垃圾回收"></a>3.注意垃圾回收</h3><p>Redis是一个提供持久化功能的内存数据库，如果你不指定上面值的过期时间，并且也不进行定期的清理工作，那么你的Redis内存占用会越来越大，当有一天它超过了系统可用内存，那么swap上场，离性能陡降的时间就不远了。所以在Redis中保存数据时，一定要预先考虑好数据的生命周期，这有很多方法可以实现。</p>
<p>比如你可以采用Redis自带的过期时间为你的数据设定过期时间。但是自动过期有一个问题，很有可能导致你还有大量内存可用时，就让key过期去释放内存，或者是内存已经不足了key还没有过期。</p>
<p>如果你想更精准的控制你的数据过期，你可以用一个ZSET来维护你的数据更新程度，你可以用时间戳作为score值，每次更新操作时更新一下score，这样你就得到了一个按更新时间排序序列串，你可以轻松地找到最老的数据，并且从最老的数据开始进行删除，一直删除到你的空间足够为止。</p>
<h3 id="4-设计好你的Sharding机制"><a href="#4-设计好你的Sharding机制" class="headerlink" title="4.设计好你的Sharding机制"></a>4.设计好你的Sharding机制</h3><p>Redis目前并不支持Sharding，但是当你的数据量超过单机内存时，你不得不考虑Sharding的事（注意：Slave不是用来做Sharding操作的，只是数据的一个备份和读写分离而已）。</p>
<p>所以你可能需要考虑好数据量大了后的分片问题，比如你可以在只有一台机器的时候就在程序上设定一致性hash机制，虽然刚开始所有数据都hash到一台机器，但是当你机器越加越多的时候，你就只需要迁移少量的数据就能完成了。</p>
<h3 id="5-不要有个锤子看哪都是钉子"><a href="#5-不要有个锤子看哪都是钉子" class="headerlink" title="5.不要有个锤子看哪都是钉子"></a>5.不要有个锤子看哪都是钉子</h3><p>当你使用Redis构建你的服务的时候，一定要记住，你只是找了一个合适的工具来实现你需要的功能。而不是说你在用Redis构建一个服务，这是很不同的，你把Redis当作你很多工具中的一个，只在合适使用的时候再使用它，在不合适的时候选择其它的方法。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/1673d498.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/1673d498.html" itemprop="url">获取本机 Android 默认sha1 秘钥</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-06T16:25:00+08:00">
                2015-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>获取本机 Android 默认sha1 秘钥：</p>
<p>以Windows操作系统为例，打开CMD，运行以下指令将得到所有默认秘钥。</p>
<p>keytool -list -v -keystore C:\Users\pangg_000.android\debug.keystore -alias androiddebugkey -storepass android -keypass android</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/10b93db1.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/10b93db1.html" itemprop="url">使用Visual Studio 2013进行单元测试--初级篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-15T17:12:00+08:00">
                2015-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.打开VS2013 –&gt; 新建一个项目。这里我们默认创建一个控制台项目。取名为UnitTestDemo</p>
<p>2.在解决方案里面新增一个单元测试项目。取名为UnitTestDemoTest</p>
<p>创建完毕后项目结构大概如下：</p>
<p> <img src="http://pangguoming.com/blog/images/bb8f4f3b-ff0e-49a5-a07e-ec28052b76d4.jpg" alt=""></p>
<p>3.进入控制台项目UnitTestDemo的Program类，创建一个Add方法。</p>
<p>namespace UnitTestDemo<br>    {<br>        class Program<br>        {<br>            static void Main(string[] args)<br>            {<br>            }</p>
<pre><code>        public static int Add(int num1, int num2)
        {
            return num1 + num2;
        }
    }
}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4.我们的目的就是测试上面的Add方法运行是否正常，返回结果是否正确。</span><br><span class="line"></span><br><span class="line">5.在单元测试项目中引用控制台项目，引用完毕后项目结构如下：</span><br><span class="line"></span><br><span class="line"> ![](http://pangguoming.com/blog/images/a22d7f28-dc0a-416d-9a53-7a6a72aff037.jpg)</span><br><span class="line"></span><br><span class="line">6.单元测试项目里面UnitTest1这个类的名字取得太难看了，我们把名字改为ProgramTest，表明这是在测试Program类。改完如下：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;using System;</span><br><span class="line">    using Microsoft.VisualStudio.TestTools.UnitTesting;</span><br><span class="line"></span><br><span class="line">    namespace UnitTestDemoTest</span><br><span class="line">    &#123;</span><br><span class="line">        [TestClass]</span><br><span class="line">        public class ProgramTest</span><br><span class="line">        &#123;</span><br><span class="line">            [TestMethod]</span><br><span class="line">            public void TestMethod1()</span><br><span class="line">            &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre><p>7.上面就是VS为ProgramTest类默认生成的方法。可以看到ProgramTest具有一个【TestClass】特性，表明这是一个测试类。TestMethod1具有一个【TestMethod】特性，表明这是一个测试方法。</p>
<p>8.可以这样理解，一个方法必须具有【TestMethod】特性，且其所属的类具有【TestClass】特性，那么这个方法才会被VS承认为一个【单元测试方法】。</p>
<p>如果没有上面的两个特性中的一个，编译生成是没有任何问题的。但是VS不会把其作为一个【单元测试方法】。</p>
<p>9.“VS不把一个方法作为【单元测试方法】”是什么意思呢？</p>
<p>依次点击VS的菜单栏【测试】–&gt; 【窗口】–&gt;【测试资源管理器】，可以打开测试资源管理器。</p>
<p> <img src="http://pangguoming.com/blog/images/022681df-162b-4971-8323-21179d184ca3.jpg" alt=""></p>
<p><img src="http://pangguoming.com/blog/images/e0b57fb7-d803-448f-bf87-6393117cc344.jpg" alt=""></p>
<p>10.测试资源管理器里面会显示当前解决方案里面的所有单元测试。说明白点就是这里只显示符合【第8点】要求的方法。</p>
<p>你可能会说，为什么上面的图里面什么都没显示，【TestMethod】特性和TestClass】特性现在不是都有吗？</p>
<p>原因是你还没有生成程序集。OK，按F6.就可以看到【测试资源管理器】中显示了【TestMethod1】：</p>
<p> <img src="http://pangguoming.com/blog/images/7d736d6e-6f85-405b-92ae-27b1b74501bf.jpg" alt=""></p>
<p>11.我们要清楚我们创建单元测试的初衷：是用工具帮助我们测试软件的质量、稳定性、性能等等。【VS】在这里就充当了工具的作用。</p>
<p>12.回到命名的问题，很明显TestMethod这个名字太难看了，我们把它改成AddTest表示这是在测试Add方法。</p>
<pre><code>&lt;pre&gt;using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace UnitTestDemoTest
{
    [TestClass]
    public class ProgramTest
    {
        [TestMethod]
        public void AddTest()
        {
        }
    }
}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">13.截止目前，我们已经建立了一个可以执行的测试框架，虽然没有起到什么作用，但是测试已经可以执行了。</span><br><span class="line"></span><br><span class="line">执行测试的方法之一是：右键点击需要测试的【单元测试】方法的名称，选择运行：</span><br><span class="line"></span><br><span class="line"> ![](http://pangguoming.com/blog/images/200cc5f4-50e2-43c5-a726-b8acf92f0964.jpg)</span><br><span class="line"></span><br><span class="line">运行测试之后，可以在测试资源管理器中查看测试的结果：</span><br><span class="line"></span><br><span class="line"> ![](http://pangguoming.com/blog/images/d63dcd37-7f9b-4353-b427-dce6ddf2b9a5.jpg)</span><br><span class="line"></span><br><span class="line">执行单元测试的方法有很多，这些需要我们在不断的学习中去体会。</span><br><span class="line"></span><br><span class="line">14.接下来我们做一点有意义的事情。改进AddTest方法：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;using System;</span><br><span class="line">    using Microsoft.VisualStudio.TestTools.UnitTesting;</span><br><span class="line"></span><br><span class="line">    namespace UnitTestDemoTest</span><br><span class="line">    &#123;</span><br><span class="line">        [TestClass]</span><br><span class="line">        public class ProgramTest</span><br><span class="line">        &#123;</span><br><span class="line">            [TestMethod]</span><br><span class="line">            public void AddTest()</span><br><span class="line">            &#123;</span><br><span class="line">                int num1 = 100;</span><br><span class="line">                int num2 = 200;</span><br><span class="line"></span><br><span class="line">                Assert.AreEqual(Program.Add(num1, num2), 300);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre><p>在这之前，请把Program类的可见性改为internal或者Public。</p>
<p>?15.“Assert”之前没接触过单元测试的朋友，或者英语差点的可能不认识。上谷歌翻译：</p>
<p><img src="http://pangguoming.com/blog/images/048961ee-ce8f-44c3-8f0b-660472fb3b0a.jpg" alt=""></p>
<p>清楚的看到，“Assert”的意思是“断言”。所以“Assert.AreEqual(Program.Add(num1, num2), 300);”这句话的意思就是：我断言“Program.Add(num1, num2)”的结果就是300。</p>
<p>而断言的正确与否只需要通过测试工具测试即可。如果测试通过说明此断言是正确的，反之就说明这个测试失败了。</p>
<p>断言有很多种，包括上面普通的Assert，还有字符串断言，集合断言等等。</p>
<p>16.ok，运行测试可以看到测试通过。</p>
<p><img src="http://pangguoming.com/blog/images/f326cb02-3299-4b78-b403-8ef3418d70d3.jpg" alt=""></p>
<p>17.如果上面所说的你都明白，那么到这里为止，你可以自己编写简单的单元测试代码并执行测试了。</p>
<p>最后还有一个要说的就是，如果你觉得手动编写单元测试类和方法太麻烦，那么可以使用“Unit Test Generator”插件帮助你生成单元测试和方法。</p>
<p>这样你可以把重心偏到编写测试逻辑上。</p>
<p>“Unit Test Generator”可以通过VS菜单栏【工具】–&gt;【扩展和更新】–&gt;搜索““Unit Test Generator””取得。</p>
<p><img src="http://pangguoming.com/blog/images/a7494fce-ca18-4950-8d69-044fa0fd82b3.jpg" alt=""></p>
<p>18.安装“Unit Test Generator”需要重启VS。</p>
<p>在需要进行单元测试的类和方法上点击右键，如图操作（图中演示的是生成单元测试方法）</p>
<p><img src="http://pangguoming.com/blog/images/ea14eb6a-d490-418a-ad65-9bde2815b7b0.jpg" alt=""></p>
<p>点击之后会弹出一个对话框，需要你配置一个名称的规则，配置好后点击ok即可生成测试方法。</p>
<p><img src="http://pangguoming.com/blog/images/0a0e0d8b-6ff2-43f4-8ba2-09702d23983b.jpg" alt=""></p>
<p>19.最后希望大家养成随时测试代码的好习惯。<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/b3d6ac3.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/b3d6ac3.html" itemprop="url">Git入门及上传项目到github中</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-08T17:13:00+08:00">
                2015-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近需要将课设代码上传到Github上，之前只是用来fork别人的代码。</p>
<p>这篇文章写得是windows下的使用方法。</p>
<p>第一步：创建Github新账户</p>
<p>第二步：新建仓库</p>
<p><a href="http://pangguoming.com/blog/images/bab124f3-f717-43b3-8c13-57409bd51af4.png"><img src="http://pangguoming.com/blog/images/bab124f3-f717-43b3-8c13-57409bd51af4.png" alt="newgithub"></a></p>
<p>第三部：填写名称，简介（可选），勾选Initialize this repository with a README选项，这是自动创建REAMDE.md文件，省的你再创建。</p>
<p><a href="http://lazynight.me/wp-content/uploads/2013/05/createdemo.png" target="_blank" rel="noopener"><img src="http://lazynight.me/wp-content/uploads/2013/05/createdemo.png" alt="createdemo"></a></p>
<p>第四步：安装Github shell程序，地址：<a href="http://windows.github.com/" target="_blank" rel="noopener">http://windows.github.com/</a></p>
<p>第五步：打开Git Shell，输入以下命令生成密钥来验证身份</p>
<p>ssh-keygen -C <a href="mailto:&#39;your@email.address" target="_blank" rel="noopener">&#39;your@email.address</a>‘ -t rsa<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">连续三个回车之后会在windows当前用户目录下生成.ssh文件夹，和linux一样。</span><br><span class="line"></span><br><span class="line">[![ssh3](http://lazynight.me/wp-content/uploads/2013/05/ssh3.gif)](http://lazynight.me/wp-content/uploads/2013/05/ssh3.gif)</span><br><span class="line"></span><br><span class="line">把文件夹下的id_rsa.pub文件内容全部复制。</span><br><span class="line"></span><br><span class="line">然后打开github账户设置，如图</span><br><span class="line"></span><br><span class="line">[![setting](http://lazynight.me/wp-content/uploads/2013/05/setting.png)](http://lazynight.me/wp-content/uploads/2013/05/setting.png)</span><br><span class="line"></span><br><span class="line">打开ssh keys</span><br><span class="line"></span><br><span class="line">[![ssh](http://lazynight.me/wp-content/uploads/2013/05/ssh.png)](http://lazynight.me/wp-content/uploads/2013/05/ssh.png)  </span><br><span class="line">右上角点击add ssh key</span><br><span class="line"></span><br><span class="line">[![ssh2](http://lazynight.me/wp-content/uploads/2013/05/ssh2.png)](http://lazynight.me/wp-content/uploads/2013/05/ssh2.png)</span><br><span class="line"></span><br><span class="line">然后在title随便输入，key栏粘贴刚才的密钥。</span><br><span class="line"></span><br><span class="line">第六步：在Git Shell下输入命令测试刚才的公钥是否认证正确。</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;ssh -T git@github.com</span><br></pre></td></tr></table></figure></p>
<p>正确结果会显示：</p>
<pre><code>&lt;pre&gt;Warning:Permanently added &apos;github.com,207.97.227.239&apos; (RSA) to the list of known hosts.
　　Hi Flowerowl! You&apos;ve successfully authenticated, but GitHub does not provide shell access.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">warning 不用理会。</span><br><span class="line"></span><br><span class="line">第七步：clone刚才新建的repository 到本地，输入命令：</span><br><span class="line"></span><br><span class="line">[![link](http://pangguoming.com/blog/images/7e102513-c7c7-4f81-b3c7-cd17b6e86084.png)](http://pangguoming.com/blog/images/7e102513-c7c7-4f81-b3c7-cd17b6e86084.png)</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;　git clone https://github.com/Flowerowl/stumansys.git</span><br></pre></td></tr></table></figure>
</code></pre><p>这时会在目录下生成：</p>
<p><a href="http://lazynight.me/wp-content/uploads/2013/05/desk.png" target="_blank" rel="noopener"><img src="http://lazynight.me/wp-content/uploads/2013/05/desk.png" alt="desk"></a></p>
<p>第八步：将想上传的代码目录拷贝到此文件夹下：</p>
<p><a href="http://lazynight.me/wp-content/uploads/2013/05/code.png" target="_blank" rel="noopener"><img src="http://lazynight.me/wp-content/uploads/2013/05/code.png" alt="code"></a></p>
<p>第九步：切换到Git shell 命令行下，输入命令：</p>
<pre><code>&lt;pre&gt;cd stumansys  
</code></pre><p>git init<br>git add .<br>    git commit -m ‘stumansys’<br>    git remote add origin <a href="https://github.com/Flowerowl/stumansys.git" target="_blank" rel="noopener">https://github.com/Flowerowl/stumansys.git</a><br>    git push origin master<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">如果执行git remote add origin</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;https://github.com/Flowerowl/stumansys.git</span><br></pre></td></tr></table></figure></p>
<p>，出现错误：</p>
<pre><code>&lt;div&gt;
&lt;pre&gt;　　fatal: remote origin already exists<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">则执行以下语句：</span><br><span class="line"></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    &lt;pre&gt;　　git remote rm origin</span><br></pre></td></tr></table></figure>
</code></pre><p>再往后执行git remote add origin <em id="__mceDel"><a href="https://github.com/Flowerowl/stumansys.git" target="_blank" rel="noopener">https://github.com/Flowerowl/stumansys.git</a><em><em id="__mceDel"> 即可。</em></em></em></p>
<p>在执行git push origin master时，报错：</p>
<pre><code>&lt;div&gt;
&lt;pre&gt;　　error:failed to push som refs to.......<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">则执行以下语句：</span><br><span class="line"></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    &lt;pre&gt;　　git pull origin master</span><br></pre></td></tr></table></figure>
</code></pre><p>先把远程服务器github上面的文件拉先来，再push 上去。</p>
<p><a href="http://lazynight.me/wp-content/uploads/2013/05/cmd.png" target="_blank" rel="noopener"><img src="http://lazynight.me/wp-content/uploads/2013/05/cmd.png" alt="cmd"></a></p>
<p>最后，你可以去项目页面查看了~~代码上传成功！</p>
<p>有问题可以在下方留言，大家一起解决~<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/734f9bc4.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/734f9bc4.html" itemprop="url">Mongoose学习参考文档</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-30T21:44:00+08:00">
                2015-07-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、快速通道"><a href="#一、快速通道" class="headerlink" title="一、快速通道"></a>一、快速通道</h2><h3 id="1-1-名词解释"><a href="#1-1-名词解释" class="headerlink" title="1.1 名词解释"></a>1.1 名词解释</h3><ul>
<li></li>
</ul>
<p><code>Schema</code> ： 一种以文件形式存储的数据库模型骨架，不具备数据库的操作能力</p>
<ul>
<li></li>
</ul>
<p><code>Model</code> ： 由<code>Schema</code>发布生成的模型，具有抽象属性和行为的数据库操作对</p>
<ul>
<li></li>
</ul>
<p><code>Entity</code> ： 由<code>Model</code>创建的实体，他的操作也会影响数据库</p>
<p>注意：</p>
<p>1.本学习文档采用严格命名方式来区别不同对象，例如：</p>
<pre><code>        var PersonSchema;   //Person的文本属性
        var PersonModel;    //Person的数据库模型
        var PersonEntity;   //Person实体

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2.`Schema`、`Model`、`Entity`的关系请牢记，`Schema`生成`Model`，`Model`创造`Entity`，`Model`和`Entity`都可对数据库操作造成影响，但`Model`比`Entity`更具操作性。</span><br><span class="line"></span><br><span class="line">    ## 1.2 准备工作</span><br><span class="line"></span><br><span class="line">1.首先你必须安装[MongoDB](http://www.mongodb.org/)和[NodeJS](http://nodejs.org/)</span><br><span class="line"></span><br><span class="line">2.在项目只能够创建一个数据库连接，如下:</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            var mongoose = require(&apos;mongoose&apos;);    //引用mongoose模块</span><br><span class="line">            var db = mongoose.createConnection(&apos;localhost&apos;,&apos;test&apos;); //创建一个数据库连接</span><br></pre></td></tr></table></figure>
</code></pre><p>3.打开本机<code>localhost</code>的<code>test</code>数据库时，我们可以监测是否有异常</p>
<pre><code>&lt;pre&gt;
        db.on(&apos;error&apos;,console.error.bind(console,&apos;连接错误:&apos;));
        db.once(&apos;open&apos;,function(){
          //一次打开记录
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意：</span><br><span class="line"></span><br><span class="line"> 成功开启数据库后，就可以执行数据库相应操作，假设以下代码都在回调中处理</span><br><span class="line"></span><br><span class="line">4.定义一个`Schema`</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            var PersonSchema = new mongoose.Schema(&#123;</span><br><span class="line">              name:String   //定义一个属性name，类型为String</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p>5.将该<code>Schema</code>发布为<code>Model</code></p>
<pre><code>&lt;pre&gt;
        var PersonModel = db.model(&apos;Person&apos;,PersonSchema);
        //如果该Model已经发布，则可以直接通过名字索引到，如下：
        //var PersonModel = db.model(&apos;Person&apos;);
        //如果没有发布，上一段代码将会异常

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">6.用`Model`创建`Entity`</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            var personEntity = new PersonModel(&#123;name:&apos;Krouky&apos;&#125;);</span><br><span class="line">            //打印这个实体的名字看看</span><br><span class="line">            console.log(personEntity.name); //Krouky</span><br></pre></td></tr></table></figure>
</code></pre><p>7.我们甚至可以为此<code>Schema</code>创建方法</p>
<pre><code>&lt;pre&gt;
        //为Schema模型追加speak方法
        PersonSchema.methos.speak = function(){
          console.log(&apos;我的名字叫&apos;+this.name);
        }
        var PersonModel = db.model(&apos;Person&apos;,PersonSchema);
        var personEntity = new PersonModel({name:&apos;Krouky&apos;});
        personEntity.speak();//我的名字叫Krouky

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">8.`Entity`是具有具体的数据库操作`CRUD`的</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;`    personEntity.save();  //执行完成后，数据库就有该数据了`</span><br></pre></td></tr></table></figure>
</code></pre><p>9.如果要执行查询，需要依赖<code>Model</code>，当然<code>Entity</code>也是可以做到的</p>
<pre><code>&lt;pre&gt;
        PersonModel.find(function(err,persons){
          //查询到的所有person
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意：</span><br><span class="line"></span><br><span class="line"> 1. 具体的如何配置`Schema`、`Model`以及`Model`和`Entity`的相关操作，我们会在后面进行</span><br><span class="line"></span><br><span class="line"> 2. `Model`和`Entity`都有能影响数据库的操作，但仍有区别，后面我们也会做解释</span><br><span class="line"></span><br><span class="line">    ## 二、新手指引</span><br><span class="line"></span><br><span class="line"> *如果您还不清楚`Mongoose`是如何工作的，请参看第一章快速通道快速浏览他的用法吧*</span><br><span class="line"></span><br><span class="line">    ### 1. Schema——纯洁的数据库原型</span><br><span class="line"></span><br><span class="line">    #### 1.1 什么是Schema</span><br><span class="line"></span><br><span class="line">    *   我理解`Schema`仅仅只是一断代码，他书写完成后程序依然无法使用，更无法通往数据库端</span><br><span class="line">    *   他仅仅只是数据库模型在程序片段中的一种表现，或者是数据属性模型</span><br><span class="line"></span><br><span class="line">    #### 1.2 如何定义Schema</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            var BlogSchema = new Schema(&#123;</span><br><span class="line">              title:String,</span><br><span class="line">              author:String</span><br><span class="line">              //new Schema()中传入一个JSON对象，该对象形如 xxx:yyyy ,</span><br><span class="line">              /xxx是一个字符串，定义了属性，yyy是一个Schema.Type，定义了属性类型</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>

#### 1.3 什么是Schema.Type
</code></pre><p> <code>Schema.Type</code>是由<code>Mongoose</code>内定的一些数据类型，基本数据类型都在其中，他也内置了一些<code>Mongoose</code>特有的<code>Schema.Type</code>。当然，你也可以自定义<code>Schema.Type</code>，只有满足<code>Schema.Type</code>的类型才能定义在<code>Schema</code>内。</p>
<pre><code>#### 1.4 Schema.Types
</code></pre><p> <code>NodeJS</code>中的基本数据类型都属于<code>Schema.Type</code>，另外<code>Mongoose</code>还定义了自己的类型</p>
<pre><code>&lt;pre&gt;
        //举例：
        var ExampleSchema = new Schema({
          name:String,
          binary:Buffer,
          living:Boolean,
          updated:Date,
          age:Number,
          mixed:Schema.Types.Mixed, //该混合类型等同于nested
          _id:Schema.Types.ObjectId,  //主键
          _fk:Schema.Types.ObjectId,  //外键
          array:[],
          arrOfString:[String],
          arrOfNumber:[Number],
          arrOfDate:[Date],
          arrOfBuffer:[Buffer],
          arrOfBoolean:[Boolean],
          arrOfMixed:[Schema.Types.Mixed],
          arrOfObjectId:[Schema.Types.ObjectId]
          nested:{
            stuff:String,
          }
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   #### 1.5 关于Buffer</span><br><span class="line"></span><br><span class="line">`Buffer`和`ArrayBuffer`是`Nodejs`两种隐藏的对象，相关内容请查看`NodeJS-API`</span><br><span class="line"></span><br><span class="line">   #### 1.6 关于Mixed</span><br><span class="line"></span><br><span class="line">`Schema.Types.Mixed`是`Mongoose`定义个混合类型，该混合类型如果未定义具体形式。因此,如果定义具体内容，就直接使用`&#123;&#125;`来定义，以下两句等价</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var AnySchema = new Schema(&#123;any:&#123;&#125;&#125;);</span><br><span class="line">           var AnySchema = new Schema(&#123;any:Schema.Types.Mixed&#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p> 混合类型因为没有特定约束，因此可以任意修改，一旦修改了原型，则必须调用<code>markModified()</code></p>
<pre><code>&lt;pre&gt;
        person.anything = {x:[3,4,{y:&apos;change&apos;}]}
        person.markModified(&apos;anything&apos;);//传入anything，表示该属性类型发生变化
        person.save();

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   #### 1.7 关于ObjectId</span><br><span class="line"></span><br><span class="line">主键，一种特殊而且非常重要的类型，每个`Schema`都会默认配置这个属性，属性名为`_id`，除非自己定义，方可覆盖</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var mongoose = require(&apos;mongoose&apos;);</span><br><span class="line">           var ObjectId = mongoose.Schema.Types.ObjectId;</span><br><span class="line">           var StudentSchema = new Schema(&#123;&#125;); //默认会有_id:ObjectId</span><br><span class="line">           var TeacherSchema = new Schema(&#123;id:ObjectId&#125;);//只有id:ObjectId</span><br></pre></td></tr></table></figure>
</code></pre><p> 该类型的值由系统自己生成，从某种意义上几乎不会重复，生成过程比较复杂，有兴趣的朋友可以查看源码。</p>
<pre><code>#### 1.8 关于Array
</code></pre><p> <code>Array</code>在<code>JavaScript</code>编程语言中并不是数组，而是集合，因此里面可以存入不同的值，以下代码等价：</p>
<pre><code>&lt;pre&gt;
        var ExampleSchema1 = new Schema({array:[]});
        var ExampleSchema2 = new Schema({array:Array});
        var ExampleSchema3 = new Schema({array:[Schema.Types.Mixed]});
        var ExampleSchema4 = new Schema({array:[{}]});

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   #### 1.9 附言</span><br><span class="line"></span><br><span class="line">`Schema`不仅定义了`文档结构`和`使用性能`，还可以有`扩展插件`、`实例方法`、`静态方法`、`复合索引`、`文档生命周期钩子`</span><br><span class="line"></span><br><span class="line">`Schema`可以定义插件，并且插件具有良好的可拔插性，请有兴趣的读者继续往后阅读或者查阅官方资料。</span><br><span class="line"></span><br><span class="line">   ### 2. Schema的扩展</span><br><span class="line"></span><br><span class="line">   #### 2.1 实例方法</span><br><span class="line"></span><br><span class="line">有的时候，我们创造的`Schema`不仅要为后面的`Model`和`Entity`提供公共的属性，还要提供公共的方法。</span><br><span class="line"></span><br><span class="line">下面例子比快速通道的例子更加高级，可以进行高级扩展：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var PersonSchema = new Schema(&#123;name:String,type:String&#125;);</span><br><span class="line">           //查询类似数据</span><br><span class="line">           PersonSchema.methods.findSimilarTypes = function(cb)&#123;</span><br><span class="line">             return this.model(&apos;Person&apos;).find(&#123;type:this.type&#125;,cb);</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>
</code></pre><p> 使用如下：</p>
<pre><code>&lt;pre&gt;&lt;code&gt;    var PersonModel = mongoose.model(&apos;Person&apos;,PersonSchema);
    var krouky = new PersonModel({name:&apos;krouky&apos;,type:&apos;前端工程师&apos;});  
krouky.findSimilarTypes(function(err,persons){
      //persons中就能查询到其他前端工程师
    });&lt;/code&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   #### 2.2 静态方法</span><br><span class="line"></span><br><span class="line">静态方法在`Model`层就能使用，如下：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">         PersonSchema.statics.findByName = function(name,cb)&#123;</span><br><span class="line">           this.find(&#123;name:new RegExp(name,&apos;i&apos;),cb&#125;);</span><br><span class="line">         &#125;</span><br><span class="line">         var PersonModel = mongoose.model(&apos;Person&apos;,PersonSchema);</span><br><span class="line">         PersonModel.findByName(&apos;krouky&apos;,function(err,persons)&#123;</span><br><span class="line">           //找到所有名字叫krouky的人</span><br><span class="line">         &#125;);</span><br></pre></td></tr></table></figure>

#### 2.3 索引
</code></pre><p> 索引或者复合索引能让搜索更加高效，默认索引就是主键索引<code>ObjectId</code>，属性名为<code>_id</code>， <em>索引会作为一个专题来讲解</em></p>
<pre><code>#### 2.4 虚拟属性
</code></pre><p> <code>Schema</code>中如果定义了虚拟属性，那么该属性将不写入数据库，例如：</p>
<pre><code>&lt;pre&gt;
        var PersonSchema = new Schema({
          name:{
            first:String,
            last:String
          }
        });
        var PersonModel = mongoose.model(&apos;Person&apos;,PersonSchema);
        var krouky = new PersonModel({
          name:{first:&apos;krouky&apos;,last:&apos;han&apos;}
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">如果每次想使用全名就得这样</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;`    console.log(krouky.name.first + &apos; &apos; + krouky.name.last);`</span><br></pre></td></tr></table></figure>
</code></pre><p> 显然这是很麻烦的，我们可以定义<code>虚拟属性</code>：</p>
<pre><code>&lt;pre&gt;
        PersonSchema.virtual(&apos;name.full&apos;).get(function(){
          return this.name.first + &apos; &apos; + this.name.last;
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">那么就能用`krouky.name.full`来调用全名了，反之如果知道full，也可以反解`first`和`last`属性</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           PersonSchema.virtual(&apos;name.full&apos;).set(function(name)&#123;</span><br><span class="line">             var split = name.split(&apos; &apos;);</span><br><span class="line">             this.name.first = split[0];</span><br><span class="line">             this.name.last = split[1];</span><br><span class="line">           &#125;);</span><br><span class="line">           var PersonModel = mongoose.model(&apos;Person&apos;,PersonSchema);</span><br><span class="line">           var krouky = new PersonModel(&#123;&#125;);</span><br><span class="line">           krouky.name.full = &apos;krouky han&apos;;//会被自动分解</span><br><span class="line">           console.log(krouky.name.first);//krouky</span><br></pre></td></tr></table></figure>

#### 2.5 配置项
</code></pre><p> 在使用<code>new Schema(config)</code>时，我们可以追加一个参数<code>options</code>来配置<code>Schema</code>的配置，形如：</p>
<pre><code>&lt;pre&gt;`    var ExampleSchema = new Schema(config,options);<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">或者使用</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var ExampleSchema = new Schema(config);</span><br><span class="line">           ExampleSchema.set(option,value);</span><br><span class="line"></span><br><span class="line">   ```</span><br><span class="line"></span><br><span class="line">可供配置项有：`safe`、`strict`、`capped`、`versionKey`、`autoIndex`</span><br><span class="line"></span><br><span class="line">   ##### 2.5.1 safe——安全属性（默认安全）</span><br><span class="line"></span><br><span class="line">一般可做如下配置：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;`    new Schema(&#123;...&#125;,&#123;safe:true&#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p> 当然我们也可以这样</p>
<pre><code>&lt;pre&gt;`    new Schema({...},{safe:{j:1,w:2,wtimeout:10000}});<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> `j`表示做1份日志，`w`表示做2个副本（尚不明确），超时时间10秒</span><br><span class="line"></span><br><span class="line">    ##### 2.5.2 strict——严格配置（默认启用）</span><br><span class="line"></span><br><span class="line"> 确保`Entity`的值存入数据库前会被自动验证，如果你没有充足的理由，请不要停用，例子：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            var ThingSchema = new Schema(&#123;a:String&#125;);</span><br><span class="line">            var ThingModel = db.model(&apos;Thing&apos;,SchemaSchema);</span><br><span class="line">            var thing = new Thing(&#123;iAmNotInTheThingSchema:true&#125;);</span><br><span class="line">            thing.save();//iAmNotInTheThingSchema这个属性将无法被存储</span><br><span class="line"></span><br><span class="line">    ```</span><br><span class="line"></span><br><span class="line"> 如果取消严格选项，`iAmNotInTheThingSchema`将会被存入数据库</span><br><span class="line"></span><br><span class="line"> 该选项也可以在构造实例时使用，例如：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            var ThingModel = db.model(&apos;Thing&apos;);</span><br><span class="line">            var thing1 = new ThingModel(doc,true);  //启用严格</span><br><span class="line">            var thing2 = new ThingModel(doc,false); //禁用严格</span><br><span class="line"></span><br><span class="line">    ```</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line"></span><br><span class="line"> `strict`也可以设置为`throw`，表示出现问题将会抛出错误</span><br><span class="line"></span><br><span class="line">    ##### 2.5.3 shardKey</span><br><span class="line"></span><br><span class="line"> 需要`mongodb`做分布式，才会使用该属性</span><br><span class="line"></span><br><span class="line">    ##### 2.5.4 capped——上限设置</span><br><span class="line"></span><br><span class="line"> 如果有数据库的批量操作，该属性能限制一次操作的量，例如：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;`    new Schema(&#123;...&#125;,&#123;capped:1024&#125;);  //一次操作上线1024条数据</span><br></pre></td></tr></table></figure>
</code></pre><p> 当然该参数也可是JSON对象，包含size、max、autiIndexId属性</p>
<pre><code>&lt;pre&gt;`    new Schema({...},{capped:{size:1024,max:100,autoIndexId:true}});<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   ##### 2.5.5 versionKey——版本锁</span><br><span class="line"></span><br><span class="line">版本锁是`Mongoose`默认配置（__v属性）的，如果你想自己定制，如下：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;`    new Schema(&#123;...&#125;,&#123;versionKey:&apos;__someElse&apos;&#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p> 此时存入数据库的版本锁就不是<code>__v</code>属性，而是<code>__someElse</code>，相当于是给版本锁取名字。</p>
<p> 具体怎么存入都是由<code>Mongoose</code>和<code>MongoDB</code>自己决定，当然，这个属性你也可以去除</p>
<pre><code>&lt;pre&gt;`  new Schema({...},{versionKey:false});<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> 除非你知道你在做什么，并且你知道这样做的后果</span><br><span class="line"></span><br><span class="line">    ##### 2.5.6 autoIndex——自动索引</span><br><span class="line"></span><br><span class="line"> *该内容将在索引章节单独讲解*</span><br><span class="line"></span><br><span class="line">    ### 3. Documents</span><br><span class="line"></span><br><span class="line"> `Document`是与`MongoDB`文档一一对应的模型，`Document`可等同于`Entity`，具有属性和操作性</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line"></span><br><span class="line"> `Document`的`CRUD都必须经过严格验证的，参看2.5.2 Schema的strict严格配置</span><br><span class="line"></span><br><span class="line">    #### 3.1 查询</span><br><span class="line"></span><br><span class="line"> 查询内容过多，专题讲解</span><br><span class="line"></span><br><span class="line">    #### 3.2 更新</span><br><span class="line"></span><br><span class="line"> 有许多方式来更新文件，以下是常用的传统方式：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            PersonModel.findById(id,function(err,person)&#123;</span><br><span class="line">              person.name = &apos;MDragon&apos;;</span><br><span class="line">              person.save(function(err)&#123;&#125;);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    ```</span><br><span class="line"></span><br><span class="line"> 这里，利用`Model`模型查询到了`person`对象，该对象属于`Entity`，可以有`save操作，如果使用`Model`操作，需注意：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">            PersonModel.findById(id,function(err,person)&#123;</span><br><span class="line">              person.name = &apos;MDragon&apos;;</span><br><span class="line">              var _id = person._id; //需要取出主键_id</span><br><span class="line">              delete person._id;    //再将其删除</span><br><span class="line">              PersonModel.update(&#123;_id:_id&#125;,person,function(err)&#123;&#125;);</span><br><span class="line">              //此时才能用Model操作，否则报错</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    ```</span><br><span class="line"></span><br><span class="line"> `update`第一个参数是查询条件，第二个参数是更新的对象，但不能更新主键，这就是为什么要删除主键的原因。</span><br><span class="line"></span><br><span class="line"> 当然这样的更新很麻烦，可以使用`$set`属性来配置，这样也不用先查询，如果更新的数据比较少，可用性还是很好的：</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;`    PersonModel.update(&#123;_id:_id&#125;,&#123;$set:&#123;name:&apos;MDragon&apos;&#125;&#125;,function(err)&#123;&#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p> 需要注意，<code>Document</code>的<code>CRUD</code>操作都是异步执行，<code>callback</code>第一个参数必须是<code>err</code>，而第二个参数各个方法不一样，<code>update</code>的<code>callback</code>第二个参数是更新的数量，如果要返回更新后的对象，则要使用如下方法</p>
<pre><code>&lt;pre&gt;
        Person.findByIdAndUpdate(_id,{$set:{name:&apos;MDragon&apos;}},function(err,person){
          console.log(person.name); //MDragon
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">类似的方法还有`findByIdAndRemove`，如同名字，只能根据id查询并作`update`/`remove`操作，操作的数据仅一条</span><br><span class="line"></span><br><span class="line">   #### 3.3 新增</span><br><span class="line"></span><br><span class="line">如果是`Entity`，使用`save`方法，如果是`Model`，使用`create`方法</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           //使用Entity来增加一条数据</span><br><span class="line">           var krouky = new PersonModel(&#123;name:&apos;krouky&apos;&#125;);</span><br><span class="line">           krouky.save(callback);</span><br><span class="line">           //使用Model来增加一条数据</span><br><span class="line">           var MDragon = &#123;name:&apos;MDragon&apos;&#125;;</span><br><span class="line">           PersonModel.create(MDragon,callback);</span><br></pre></td></tr></table></figure>
</code></pre><p> 两种新增方法区别在于，如果使用<code>Model</code>新增时，传入的对象只能是纯净的<code>JSON</code>对象，不能是由<code>Model</code>创建的实体，原因是：由<code>Model</code>创建的实体<code>krouky</code>虽然打印是只有<code>{name:&#39;krouky&#39;}</code>，但是<code>krouky</code>属于<code>Entity</code>，包含有<code>Schema</code>属性和<code>Model</code>数据库行为模型。如果是使用<code>Model</code>创建的对象，传入时一定会将隐藏属性也存入数据库，虽然<code>3.x</code>追加了默认严格属性，但也不必要增加操作的报错</p>
<pre><code>#### 3.4 删除
</code></pre><p> 和新增一样，删除也有2种方式，但<code>Entity</code>和<code>Model</code>都使用<code>remove</code>方法</p>
<pre><code>### 4.Sub Docs
</code></pre><p> 如同<code>SQL</code>数据库中2张表有主外关系，<code>Mongoose</code>将2个<code>Document</code>的嵌套叫做<code>Sub-Docs</code>（子文档）</p>
<p> 简单的说就是一个<code>Document</code>嵌套另外一个<code>Document</code>或者<code>Documents</code>:</p>
<pre><code>&lt;pre&gt;
        var ChildSchema1 = new Schema({name:String});
        var ChildSchema2 = new Schema({name:String});
        var ParentSchema = new Schema({
          children1:ChildSchema1,   //嵌套Document
          children2:[ChildSchema2]  //嵌套Documents
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`Sub-Docs`享受和`Documents`一样的操作，但是`Sub-Docs`的操作都由父类去执行</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var ParentModel = db.model(&apos;Parent&apos;,parentSchema);</span><br><span class="line">           var parent = new ParentModel(&#123;</span><br><span class="line">             children2:[&#123;name:&apos;c1&apos;&#125;,&#123;name:&apos;c2&apos;&#125;]</span><br><span class="line">           &#125;);</span><br><span class="line">           parent.children2[0].name = &apos;d&apos;;</span><br><span class="line">           parent.save(callback);</span><br></pre></td></tr></table></figure>
</code></pre><p> <code>parent</code>在执行保存时，由于包含<code>children2</code>，他是一个数据库模型对象，因此会先保存<code>chilren2[0]</code>和<code>chilren2[1]</code>。</p>
<p> 如果子文档在更新时出现错误，将直接报在父类文档中，可以这样处理：</p>
<pre><code>&lt;pre&gt;
        ChildrenSchema.pre(&apos;save&apos;,function(next){
          if(&apos;x&apos; === this.name) return next(new Error(&apos;#err:not-x&apos;));
          next();
        });
        var parent = new ParentModel({children1:{name:&apos;not-x&apos;}});
        parent.save(function(err){
          console.log(err.message); //#err:not-x
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   #### 4.1 查询子文档</span><br><span class="line"></span><br><span class="line">如果`children`是`parent`的子文档，可以通过如下方法查询到`children`</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;`    var child = parent.children.id(id);`</span><br></pre></td></tr></table></figure>

#### 4.2 新增、删除、更新
</code></pre><p> 子文档是父文档的一个属性，因此按照属性的操作即可，不同的是在新增父类的时候，子文档是会被先加入进去的。</p>
<p> 如果<code>ChildrenSchema</code>是临时的一个子文档，不作为数据库映射集合，可以这样：</p>
<pre><code>&lt;pre&gt;
        var ParentSchema = new Schema({
          children:{
            name:String
          }
        });
        //其实就是匿名混合模式

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   ### 5.Model</span><br><span class="line"></span><br><span class="line">   #### 5.1 什么是Model</span><br><span class="line"></span><br><span class="line">`Model`模型，是经过`Schema`构造来的，除了`Schema`定义的数据库骨架以外，还具有数据库行为模型，他相当于管理数据库属性、行为的类</span><br><span class="line"></span><br><span class="line">   #### 5.2 如何创建Model</span><br><span class="line"></span><br><span class="line">你必须通过`Schema`来创建，如下：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           //先创建Schema</span><br><span class="line">           var TankSchema = new Schema(&#123;</span><br><span class="line">             name:&apos;String&apos;,</span><br><span class="line">             size:&apos;String&apos; </span><br><span class="line">           &#125;);</span><br><span class="line">           //通过Schema创建Model</span><br><span class="line">           var TankModel = mongoose.model(&apos;Tank&apos;,TankSchema);</span><br></pre></td></tr></table></figure>

#### 5.2 操作Model
</code></pre><p> 该模型就能直接拿来操作，具体查看<code>API</code>，例如：</p>
<pre><code>&lt;pre&gt;
        var tank = {&apos;something&apos;,size:&apos;small&apos;};
        TankModel.create(tank);

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意：</span><br><span class="line"></span><br><span class="line"> 你可以使用`Model`来创建`Entity`，`Entity`实体是一个特有`Model`具体对象，但是他并不具备`Model`的方法，只能用自己的方法。</span><br><span class="line"></span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">          //通过Model创建Entity</span><br><span class="line">          var tankEntity = new TankModel(&apos;someother&apos;,&apos;size:big&apos;);</span><br><span class="line">          tankEntity.save();</span><br></pre></td></tr></table></figure>

### 6.Query
</code></pre><p> 查询是数据库中运用最多也是最麻烦的地方，这里对<code>Query</code>解读的并不完善，仅仅是自己的一点领悟而已。</p>
<pre><code>#### 6.1 查询的方式
</code></pre><p> 通常有2种查询方式，一种是<code>直接查询</code>，一种是<code>链式查询</code>（2种查询都是自己命名的）</p>
<pre><code>##### 6.1.1 直接查询
</code></pre><p> 在查询时带有回调函数的，称之为直接查询，查询的条件往往通过<code>API</code>来设定，例如：</p>
<pre><code>&lt;pre&gt;
        PersonModel.findOne({&apos;name.last&apos;:&apos;dragon&apos;},&apos;some select&apos;,function(err,person){
          //如果err==null，则person就能取到数据
        });

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">具体的查询参数，请查询`API`</span><br><span class="line"></span><br><span class="line">   ##### 6.1.2 链式查询</span><br><span class="line"></span><br><span class="line">在查询时候，不带回调，而查询条件通过`API`函数来制定，例如：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var query = PersonModel.findOne(&#123;&apos;name.last&apos;:&apos;dragon&apos;&#125;);</span><br><span class="line">           query.select(&apos;some select&apos;);</span><br><span class="line">           query.exec(function(err,pserson)&#123;</span><br><span class="line">           //如果err==null，则person就能取到数据</span><br><span class="line">         &#125;);</span><br></pre></td></tr></table></figure>
</code></pre><p> 这种方式相对直接查询，分的比较明细，如果不带<code>callback</code>，则返回<code>query</code>，<code>query</code>没有执行的预编译查询语句，该<code>query</code>对象执行的方法都将返回自己，只有在执行<code>exec</code>方法时才执行查询，而且必须有回调。</p>
<p> 因为<code>query</code>的操作始终返回自身，我们可以采用更形象的链式写法</p>
<pre><code>&lt;pre&gt;
        Person
          .find({ occupation: /host/ })
          .where(&apos;name.last&apos;).equals(&apos;Ghost&apos;)
          .where(&apos;age&apos;).gt(17).lt(66)
          .where(&apos;likes&apos;).in([&apos;vaporizing&apos;, &apos;talking&apos;])
          .limit(10)
          .sort(&apos;-occupation&apos;)
          .select(&apos;name occupation&apos;)
          .exec(callback);

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   ### 7.Validation</span><br><span class="line"></span><br><span class="line">数据的存储是需要验证的，不是什么数据都能往数据库里丢或者显示到客户端的，数据的验证需要记住以下规则：</span><br><span class="line"></span><br><span class="line">   *   验证始终定义在`SchemaType`中</span><br><span class="line">   *   验证是一个内部中间件</span><br><span class="line">   *   验证是在一个`Document`被保存时默认启用的，除非你关闭验证</span><br><span class="line">   *   验证是异步递归的，如果你的`SubDoc`验证失败，`Document`也将无法保存</span><br><span class="line">   *   验证并不关心错误类型，而通过`ValidationError`这个对象可以访问</span><br><span class="line"></span><br><span class="line">   #### 7.1 验证器</span><br><span class="line"></span><br><span class="line">   1.  `required` 非空验证</span><br><span class="line">   2.  `min`/`max` 范围验证（边值验证）</span><br><span class="line">   3.  `enum`/`match` 枚举验证/匹配验证</span><br><span class="line">   4.  `validate` 自定义验证规则</span><br><span class="line"></span><br><span class="line">以下是综合案例：</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var PersonSchema = new Schema(&#123;</span><br><span class="line">             name:&#123;</span><br><span class="line">               type:&apos;String&apos;,</span><br><span class="line">               required:true //姓名非空</span><br><span class="line">             &#125;,</span><br><span class="line">             age:&#123;</span><br><span class="line">               type:&apos;Nunmer&apos;,</span><br><span class="line">               min:18,       //年龄最小18</span><br><span class="line">               max:120     //年龄最大120</span><br><span class="line">             &#125;,</span><br><span class="line">             city:&#123;</span><br><span class="line">               type:&apos;String&apos;,</span><br><span class="line">               enum:[&apos;北京&apos;,&apos;上海&apos;]  //只能是北京、上海人</span><br><span class="line">             &#125;,</span><br><span class="line">             other:&#123;</span><br><span class="line">               type:&apos;String&apos;,</span><br><span class="line">               validate:[validator,err]  //validator是一个验证函数，err是验证失败的错误信息</span><br><span class="line">             &#125;</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure>

#### 7.2 验证失败
</code></pre><p> 如果验证失败，则会返回<code>err</code>信息，<code>err</code>是一个对象该对象属性如下</p>
<pre><code>&lt;pre&gt;
        err.errors                //错误集合（对象）
        err.errors.color          //错误属性(Schema的color属性)
        err.errors.color.message  //错误属性信息
        err.errors.path             //错误属性路径
        err.errors.type             //错误类型
        err.name                //错误名称
        err.message                 //错误消息

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">一旦验证失败，`Model`和`Entity`都将具有和`err`一样的`errors`属性</span><br><span class="line"></span><br><span class="line">   ### 8.Middleware中间件</span><br><span class="line"></span><br><span class="line">   #### 8.1 什么是中间件</span><br><span class="line"></span><br><span class="line">中间件是一种控制函数，类似插件，能控制流程中的`init`、validate`、`save`、`remove`方法</span><br><span class="line"></span><br><span class="line">   #### 8.2 中间件的分类</span><br><span class="line"></span><br><span class="line">中间件分为两类</span><br><span class="line"></span><br><span class="line">   ##### 8.2.1 Serial串行</span><br><span class="line"></span><br><span class="line">串行使用`pre`方法，执行下一个方法使用`next`调用</span><br><span class="line"></span><br><span class="line">   &lt;pre&gt;</span><br><span class="line">           var schema = new Schema(...);</span><br><span class="line">           schema.pre(&apos;save&apos;,function(next)&#123;</span><br><span class="line">             //做点什么</span><br><span class="line">             next();</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure>

##### 8.2.2 Parallel并行
</code></pre><p> 并行提供更细粒度的操作</p>
<pre><code>&lt;pre&gt;
        var schema = new Schema(...);
        schema.pre(&apos;save&apos;,function(next,done){
          //下一个要执行的中间件并行执行
          next();
          doAsync(done);
        });

```

#### 8.3 中间件特点
</code></pre><p> 一旦定义了中间件，就会在全部中间件执行完后执行其他操作，使用中间件可以雾化模型，避免异步操作的层层迭代嵌套</p>
<pre><code>#### 8.4 使用范畴

1.  复杂的验证
2.  删除有主外关联的`doc`
3.  异步默认
4.  某个特定动作触发异步任务，例如触发自定义事件和通知
</code></pre><p> 例如，可以用来做自定义错误处理</p>
<pre><code>&lt;pre&gt;
        schema.pre(&apos;save&apos;,function(next){
          var err = new Eerror(&apos;some err&apos;);
          next(err);
        });
        entity.save(function(err){
          console.log(err.message); //some err
        });

```&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/6dfcb629.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/6dfcb629.html" itemprop="url">Redis快速入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-05T18:16:00+08:00">
                2015-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Redis是一个开源，先进的key-value存储，并用于构建高性能，可扩展的Web应用程序的完美解决方案。</p>
<p>Redis从它的许多竞争继承来的三个主要特点：</p>
<ul>
<li></li>
</ul>
<p>Redis数据库完全在内存中，使用磁盘仅用于持久性。</p>
<ul>
<li></li>
</ul>
<p>相比许多键值数据存储，Redis拥有一套较为丰富的数据类型。</p>
<ul>
<li></li>
</ul>
<p>Redis可以将数据复制到任意数量的从服务器。</p>
<h2 id="Redis-优势"><a href="#Redis-优势" class="headerlink" title="Redis 优势"></a>Redis 优势</h2><ul>
<li></li>
</ul>
<p>异常快速：Redis的速度非常快，每秒能执行约11万集合，每秒约81000+条记录。</p>
<ul>
<li></li>
</ul>
<p>支持丰富的数据类型：Redis支持最大多数开发人员已经知道像列表，集合，有序集合，散列数据类型。这使得它非常容易解决各种各样的问题，因为我们知道哪些问题是可以处理通过它的数据类型更好。</p>
<ul>
<li></li>
</ul>
<p>操作都是原子性：所有Redis操作是原子的，这保证了如果两个客户端同时访问的Redis服务器将获得更新后的值。</p>
<ul>
<li></li>
</ul>
<p>多功能实用工具：Redis是一个多实用的工具，可以在多个用例如缓存，消息，队列使用(Redis原生支持发布/订阅)，任何短暂的数据，应用程序，如Web应用程序会话，网页命中计数等。</p>
<h1 id="Redis-环境"><a href="#Redis-环境" class="headerlink" title="Redis - 环境"></a>Redis - 环境</h1><p>Ubuntu上安装Redis，打开终端，然后键入以下命令：</p>
<p><span class="pln">$sudo apt-get update<br>    <span class="pln">$sudo apt-get install redis-server<br>    </span></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这将在您的计算机上安装Redis。</span><br><span class="line"></span><br><span class="line">启动 Redis</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;$redis-server</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure></p>
<p>检查Redis是否在工作？</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;$redis-cli
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这将打开一个Redis提示，如下图所示：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt;</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>上面的提示127.0.0.1是本机的IP地址，6379为Redis服务器运行的端口。现在输入PING命令，如下图所示。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ping
&lt;span class=&quot;pln&quot;&gt;PONG
&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这说明你已经成功地安装Redis在您的机器上。</span><br><span class="line"></span><br><span class="line">    ## 在Ubuntu上安装Redis的桌面管理器</span><br><span class="line"></span><br><span class="line">在Ubuntu上安装Redis的桌面管理器，只需从 [http://redisdesktop.com/download](http://redisdesktop.com/download) 打开下载软件包并安装它。</span><br><span class="line"></span><br><span class="line">Redis桌面管理器会给你用户界面来管理Redis的Key和数据。</span><br><span class="line"></span><br><span class="line">    # Redis - 数据类型</span><br><span class="line"></span><br><span class="line">Redis支持5种类型的数据类型，它描述如下的：</span><br><span class="line"></span><br><span class="line">    ## 字符串</span><br><span class="line"></span><br><span class="line">Redis字符串是字节序列。Redis字符串是二进制安全的，这意味着他们有一个已知的长度没有任何特殊字符终止，所以你可以存储任何东西，512兆为上限。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET name &quot;yiibai&quot;</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; GET name</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;&quot;yiibai&quot;</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>上面是Redis的set和get命令的例子，Redis名称为yiibai使用的key存储在Redis的字符串值。</p>
<pre><code>## 哈希
</code></pre><p>Redis的哈希是键值对的集合。 Redis的哈希值是字符串字段和字符串值之间的映射，因此它们被用来表示对象</p>
<pre><code>### 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HMSET user:1 username yiibai password yiibai points 200
&lt;span class=&quot;pln&quot;&gt;OK
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HGETALL user:1
&lt;span class=&quot;pln&quot;&gt;
1) &quot;username&quot;
2) &quot;yiibai&quot;
3) &quot;password&quot;
4) &quot;yiibai&quot;
5) &quot;points&quot;
6) &quot;200&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上面的例子中的哈希数据类型，用于存储其中包含的用户的基本信息用户的对象。这里HMSET，HEGTALL用户命令user:1是键。</span><br><span class="line"></span><br><span class="line">    ## 列表</span><br><span class="line"></span><br><span class="line">Redis的列表是简单的字符串列表，排序插入顺序。您可以添加元素到Redis的列表的头部或尾部。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lpush tutoriallist redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lpush tutoriallist mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 2</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lpush tutoriallist rabitmq</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 3</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lrange tutoriallist 0 10</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;rabitmq&quot;</span><br><span class="line">    2) &quot;mongodb&quot;</span><br><span class="line">    3) &quot;redis&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>列表的最大长度为 232 - 1 元素（4294967295，每个列表中可容纳超过4十亿的元素）。</p>
<pre><code>## 集合
</code></pre><p>Redis的集合是字符串的无序集合。在Redis您可以添加，删除和测试文件是否存在，在成员O（1）的时间复杂度。</p>
<pre><code>### 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist redis
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist mongodb
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist rabitmq
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist rabitmq
&lt;span class=&quot;pln&quot;&gt;(integer) 0
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; smembers tutoriallist
&lt;span class=&quot;pln&quot;&gt;
1) &quot;rabitmq&quot;
2) &quot;mongodb&quot;
3) &quot;redis&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意：在上面的例子中rabitmq集合添加加两次，但由于集合元素具有唯一属性。</span><br><span class="line"></span><br><span class="line">集合中的元素最大数量为 232 - 1 （4294967295，可容纳超过4十亿元素）。</span><br><span class="line"></span><br><span class="line">    ## 有序集合</span><br><span class="line"></span><br><span class="line">Redis的有序集合类似于Redis的集合，字符串不重复的集合。不同的是，一个有序集合的每个成员用分数，以便采取有序set命令，从最小的到最大的成员分数有关。虽然成员具有唯一性，但分数可能会重复。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 rabitmq</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 rabitmq</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 0</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZRANGEBYSCORE tutoriallist 0 1000</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;redis&quot;</span><br><span class="line">    2) &quot;mongodb&quot;</span><br><span class="line">    3) &quot;rabitmq&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

# Redis - keys
</code></pre><p>Redis keys命令用于在Redis的管理键。Redis keys命令使用语法如下所示：</p>
<pre><code>## 语法

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; COMMAND KEY_NAME
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 例子</span><br><span class="line"></span><br><span class="line">&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET yiibai redis</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; DEL yiibai</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上面的例子中DEL是命令，而yiibai是key。如果key被删除，那么输出该命令将是（整数）1，否则它会是（整数）0</p>
<pre><code># Redis - Strings
</code></pre><p>Redis strings命令用于在Redis的管理字符串值。Redis strings命令的使用语法，如下所示：</p>
<pre><code>## 语法

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; COMMAND KEY_NAME
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 例子</span><br><span class="line"></span><br><span class="line">&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET yiibai redis</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; GET yiibai</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;&quot;redis&quot;</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上面的例子SET和GET是命令，而yiibai是key。</p>
<pre><code># Redis - 哈希
</code></pre><p>Redis的哈希值是字符串字段和字符串值之间的映射，所以他们是代表对象的完美数据类型</p>
<p>在Redis的哈希值，最多可存储超过400十亿字段 - 值对。</p>
<pre><code>## 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HMSET yiibai name &quot;redis tutorial&quot; description &quot;redis basic commands for caching&quot; likes 20 visitors 23000
&lt;span class=&quot;pln&quot;&gt;OK
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HGETALL yiibai
&lt;span class=&quot;pln&quot;&gt;
1) &quot;name&quot;
2) &quot;redis tutorial&quot;
3) &quot;description&quot;
4) &quot;redis basic commands for caching&quot;
5) &quot;likes&quot;
6) &quot;20&quot;
7) &quot;visitors&quot;
8) &quot;23000&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上面的例子中，已经在哈希命名yiibai的Redis集合名为tutorials（name, description, likes, visitors）</span><br><span class="line"></span><br><span class="line">    # Redis - 列表</span><br><span class="line"></span><br><span class="line">Redis的列表是简单的字符串列表，排序插入顺序。您可以添加Redis元素在列表头部或列表的尾部。</span><br><span class="line"></span><br><span class="line">列表的最大长度为 232 - 1 个元素（每个列表元素个数超过4294967295）。</span><br><span class="line"></span><br><span class="line">    ## 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LPUSH tutorials redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LPUSH tutorials mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 2</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LPUSH tutorials mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 3</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LRANGE tutorials 0 10</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;mysql&quot;</span><br><span class="line">    2) &quot;mongodb&quot;</span><br><span class="line">    3) &quot;redis&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上述例子中的三个值被插入在redis列表名为LPUSH的命令教程。</p>
<pre><code># Redis - 集合
</code></pre><p>Redis的集合是唯一的字符串的无序集合。集合的唯一性不允许数据的重复的键。</p>
<p>在Redis的集合添加，删除和测试文件是否存在成员在O（1）（常数时间不管里面包含的元素集合的数量）。集合的最大长度为 232 - 1 个元素（每集合超过4294967295元素）。</p>
<pre><code>## 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials redis
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials mongodb
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials mysql
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials mysql
&lt;span class=&quot;pln&quot;&gt;(integer) 0
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SMEMBERS tutorials
&lt;span class=&quot;pln&quot;&gt;
1) &quot;mysql&quot;
2) &quot;mongodb&quot;
3) &quot;redis&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上述例子中的三个值被命令SADD插入redis的集合名称tutorials。</span><br><span class="line"></span><br><span class="line">    # Redis有序集</span><br><span class="line"></span><br><span class="line">Redis的有序集合类似Redis的集合存储在设定值具有唯一性。不同的是，一个有序集合的每个成员用分数，以便采取有序set命令，从最小的到最大的分数有关。</span><br><span class="line"></span><br><span class="line">在Redis的有序set添加，删除和测试存在成员O（1）（固定时间，无论里面包含集合元素的数量）。列表的最大长度为 232 - 1 个元素（每集合超过4294967295元素）。</span><br><span class="line"></span><br><span class="line">    ## 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 1 redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 2 mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 3 mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 3 mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 0</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 4 mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 0</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZRANGE tutorials 0 10 WITHSCORES</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;redis&quot;</span><br><span class="line">    2) &quot;1&quot;</span><br><span class="line">    3) &quot;mongodb&quot;</span><br><span class="line">    4) &quot;2&quot;</span><br><span class="line">    5) &quot;mysql&quot;</span><br><span class="line">    6) &quot;4&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上述例子中的三个值被命令ZADD插入其得分在redis的有序集命名为tutorials。</p>
<pre><code># Redis - HyperLogLog
</code></pre><p>Redis的HyperLogLog使用随机化，以提供唯一的元素数目近似的集合只使用一个常数，并且体积小，少量内存的算法。</p>
<p>HyperLogLog提供，即使每个使用了非常少量的内存（12千字节），标准误差为集合的基数非常近似，没有限制的条目数，可以指定，除非接近 264个条目。</p>
<pre><code>### 例子
</code></pre><p>下面的示例说明Redis的HyperLogLog工作原理：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFADD tutorials &quot;redis&quot;
&lt;span class=&quot;pln&quot;&gt;
1) (integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFADD tutorials &quot;mongodb&quot;
&lt;span class=&quot;pln&quot;&gt;
1) (integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFADD tutorials &quot;mysql&quot;
&lt;span class=&quot;pln&quot;&gt;
1) (integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFCOUNT tutorials
&lt;span class=&quot;pln&quot;&gt;
(integer) 3

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 订阅</span><br><span class="line"></span><br><span class="line">Redis的订阅实现了邮件系统，发送者（在Redis的术语中被称为发布者）发送的邮件，而接收器（用户）接收它们。由该消息传送的链路被称为通道。</span><br><span class="line"></span><br><span class="line">在Redis客户端可以订阅任何数目的通道。</span><br><span class="line"></span><br><span class="line">    ### 示例</span><br><span class="line"></span><br><span class="line">以下举例说明如何发布用户的概念工作。在下面的例子给出一个客户端订阅一个通道名为redisChat</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SUBSCRIBE redisChat</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    Reading messages... (press Ctrl-C to quit)</span><br><span class="line">    1) &quot;subscribe&quot;</span><br><span class="line">    2) &quot;redisChat&quot;</span><br><span class="line">    3) (integer) 1</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>现在，两个客户端都发布在同一个命名通道redisChat消息，并且以上订阅客户端接收消息。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PUBLISH redisChat &quot;Redis is a great caching technique&quot;
&lt;span class=&quot;pln&quot;&gt;
(integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PUBLISH redisChat &quot;Learn redis by tutorials point&quot;
&lt;span class=&quot;pln&quot;&gt;
(integer) 1

&lt;span class=&quot;pln&quot;&gt;
1) &quot;message&quot;
2) &quot;redisChat&quot;
3) &quot;Redis is a great caching technique&quot;
1) &quot;message&quot;
2) &quot;redisChat&quot;
3) &quot;Learn redis by tutorials point&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 事务</span><br><span class="line"></span><br><span class="line">Redis事务让一组命令在单个步骤执行。事务中有两个属性，说明如下：</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">在一个事务中的所有命令按顺序执行作为单个隔离操作。通过另一个客户端发出的请求在Redis的事务的过程中执行，这是不可能的。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">Redis的事务具有原子性。原子意味着要么所有的命令都执行或都不执行。</span><br><span class="line"></span><br><span class="line">    ## 例子</span><br><span class="line"></span><br><span class="line">Redis的事务由指令多重发起，然后需要传递在事务，而且整个事务是通过执行命令EXEC执行命令列表。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; MULTI</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;List of commands here</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EXEC</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

### 例子
</code></pre><p>以下举例说明Redis事务如何启动并执行。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; MULTI
&lt;span class=&quot;pln&quot;&gt;OK
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET tutorial redis
&lt;span class=&quot;pln&quot;&gt;QUEUED
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; GET tutorial
&lt;span class=&quot;pln&quot;&gt;QUEUED
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; INCR visitors
&lt;span class=&quot;pln&quot;&gt;QUEUED
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EXEC
&lt;span class=&quot;pln&quot;&gt;
1) OK
2) &quot;redis&quot;
3) (integer) 1

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 脚本</span><br><span class="line"></span><br><span class="line">Redis脚本使用Lua解释脚本用于评估计算。它内置的Redis，从2.6.0版本开始使用脚本命令 eval。</span><br><span class="line"></span><br><span class="line">    ## 语法</span><br><span class="line"></span><br><span class="line">eval命令的基本语法如下：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EVAL script numkeys key [key ...] arg [arg ...]</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure>

### 例子
</code></pre><p>以下举例说明Redis脚本的工作原理：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EVAL &quot;return {KEYS[1],KEYS[2],ARGV[1],ARGV[2]}&quot; 2 key1 key2 first second
&lt;span class=&quot;pln&quot;&gt;
1) &quot;key1&quot;
2) &quot;key2&quot;
3) &quot;first&quot;
4) &quot;second&quot;

&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 连接</span><br><span class="line"></span><br><span class="line">Redis的连接命令基本上都是用于管理与Redis的服务器客户端连接。</span><br><span class="line"></span><br><span class="line">    ### Example</span><br><span class="line"></span><br><span class="line">下面的例子说明了一个客户如何通过Redis服务器验证自己，并检查服务器是否正在运行。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; AUTH &quot;password&quot;</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PING</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;PONG</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

# Redis - 备份
</code></pre><p>Redis SAVE命令用来创建当前的 Redis 数据库备份。</p>
<pre><code>## 语法
</code></pre><p>对Redis SAVE命令的基本语法如下所示：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; SAVE
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">下面的示例显示了 Redis 当前数据库如何创建备份。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; SAVE</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    OK</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>这个命令将创建dump.rdb文件在Redis目录中。</p>
<pre><code>## 还原Redis数据
</code></pre><p>要恢复Redis的数据只需移动 Redis 的备份文件（dump.rdb）到 Redis 目录，然后启动服务器。为了得到你的 Redis 目录，使用配置命令如下所示：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG get dir
&lt;span class=&quot;pln&quot;&gt;
1) &quot;dir&quot;
2) &quot;/user/yiibai/redis-2.8.13/src&quot;

&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上述命令的输出在 /user/yiibai/redis-2.8.13/src 目录，在安装redis的服务器安装位置。</span><br><span class="line"></span><br><span class="line">    ## Bgsave</span><br><span class="line"></span><br><span class="line">要创建Redis的备份备用命令BGSAVE也可以。这个命令将开始执行备份过程，并在后台运行。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; BGSAVE</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    Background saving started</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

# Redis - 安全
</code></pre><p>可以Redis的数据库更安全，所以相关的任何客户端都需要在执行命令之前进行身份验证。客户端输入密码匹配需要使用Redis设置在配置文件中的密码。</p>
<pre><code>### 例子
</code></pre><p>下面给出的例子显示的步骤，以确保您的Redis实例安全。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG get requirepass
&lt;span class=&quot;pln&quot;&gt;1) &quot;requirepass&quot;
2) &quot;&quot;
&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">默认情况下，此属性为空，表示没有设置密码，此实例。您可以通过执行以下命令来更改这个属性</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG set requirepass &quot;yiibai&quot;</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG get requirepass</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;1) &quot;requirepass&quot;</span><br><span class="line">    2) &quot;yiibai&quot;</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>设置密码，如果客户端运行命令没有验证，会提示（错误）NOAUTH，需要通过验证。错误将返回客户端。因此，客户端需要使用AUTHcommand进行认证。</p>
<pre><code>### 语法
</code></pre><p>AUTH命令的基本语法如下所示：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; AUTH password
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 基准</span><br><span class="line"></span><br><span class="line">Redis基准是公用工具同时运行Ñ命令检查Redis的性能。</span><br><span class="line"></span><br><span class="line">    ## 语法</span><br><span class="line"></span><br><span class="line">redis的基准的基本语法如下所示：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis-benchmark [option] [option value]</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure>

### 例子
</code></pre><p>下面给出的例子检查redis调用100000命令。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis-benchmark -n 100000
&lt;span class=&quot;pln&quot;&gt;
PING_INLINE: 141043.72 requests per second
PING_BULK: 142857.14 requests per second
SET: 141442.72 requests per second
GET: 145348.83 requests per second
INCR: 137362.64 requests per second
LPUSH: 145348.83 requests per second
LPOP: 146198.83 requests per second
SADD: 146198.83 requests per second
SPOP: 149253.73 requests per second
LPUSH (needed to benchmark LRANGE): 148588.42 requests per second
LRANGE_100 (first 100 elements): 58411.21 requests per second
LRANGE_300 (first 300 elements): 21195.42 requests per second
LRANGE_500 (first 450 elements): 14539.11 requests per second
LRANGE_600 (first 600 elements): 10504.20 requests per second
MSET (10 keys): 93283.58 requests per second

&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 客户端连接</span><br><span class="line"></span><br><span class="line">Redis接受配置监听TCP端口和Unix套接字客户端的连接，如果启用。当一个新的客户端连接被接受以下操作进行：</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">客户端套接字置于非阻塞状态，因为Redis使用复用和非阻塞I/O操作。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">TCP_NODELAY选项设定是为了确保我们没有在连接时延迟。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">创建一个可读的文件时，这样Redis能够尽快收集客户端的查询作为新的数据可供读取的套接字。</span><br><span class="line"></span><br><span class="line">    ### 客户端的最大数量</span><br><span class="line"></span><br><span class="line">在Redis的配置（redis.conf）属性调用maxclients，它描述客户端可以连接到Redis的最大数量。命令的基本语法是：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;config get maxclients</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;maxclients&quot;</span><br><span class="line">    2) &quot;10000&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>默认情况下，此属性设置为10000（这取决于操作系统的文件描述符限制最大数量），但你可以改变这个属性。</p>
<pre><code>### 例子
</code></pre><p>在下面给出的例子中，在启动服务器我们设置客户端的最大数量为10万。</p>
<pre><code>&lt;div&gt;&lt;ins class=&quot;adsbygoogle&quot; data-ad-client=&quot;ca-pub-1090193214637198&quot; data-ad-slot=&quot;1381882050&quot; data-adsbygoogle-status=&quot;done&quot;&gt;&lt;ins id=&quot;aswift_1_expand&quot;&gt;&lt;ins id=&quot;aswift_1_anchor&quot;&gt;&lt;iframe id=&quot;aswift_1&quot; name=&quot;aswift_1&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; width=&quot;728&quot; height=&quot;15&quot;&gt;&lt;/iframe&gt;&lt;/ins&gt;&lt;/ins&gt;&lt;/ins&gt;
&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis-server --maxclients 100000
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 管道传输</span><br><span class="line"></span><br><span class="line">Redis是一个TCP服务器，并支持请求/响应协议。在redis一个请求完成下面的步骤：</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">客户端发送一个查询到服务器，并从套接字中读取，通常在阻塞的方式，对服务器的响应。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">服务器处理命令并将响应返回给客户端。</span><br><span class="line"></span><br><span class="line">    ### 管道传输的含义</span><br><span class="line"></span><br><span class="line">管道的基本含义是，客户端可以发送多个请求给服务器，而无需等待答复所有，并最后读取在单个步骤中的答复。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">要检查redis的管道，只要启动Redis实例，然后在终端键入以下命令。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;$(echo -en &quot;PING\r\n SET tutorial redis\r\nGET tutorial\r\nINCR visitor\r\nINCR visitor\r\nINCR visitor\r\n&quot;; sleep 10) | nc localhost 6379</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    +PONG</span><br><span class="line">    +OK</span><br><span class="line">    redis</span><br><span class="line">    :1</span><br><span class="line">    :2</span><br><span class="line">    :3</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上述例子中，我们必须使用PING命令检查Redis的连接，之后，我们已经设定值的Redis字符串命名tutorial ，之后拿到key的值和增量访问量的三倍。在结果中，我们可以检查所有的命令都一次提交给Redis，Redis是在一个步骤给出所有命令的输出。</p>
<pre><code>### 管道的好处
</code></pre><p>这种技术的好处是极大地改善协议的性能。通过管道将慢互联网连接速度从5倍的连接速度提高到localhost至少达到百过倍。</p>
<pre><code># Redis - 分区
</code></pre><p>分区是一种将数据分成多个Redis的情况下，让每一个实例将只包含你的键字的子集的过程。</p>
<pre><code>### 分区的好处

*   
</code></pre><p>它允许更大的数据库，使用的多台计算机的存储器的总和。如果不分区，一台计算机的内存可支数量有限。</p>
<pre><code>*   
</code></pre><p>它允许以大规模的计算能力，以多个内核和多个计算机，以及网络带宽向多台计算机和网络适配器。</p>
<pre><code>### 分区的缺点

*   
</code></pre><p>通常不支持涉及多个键的操作。例如，不能两个集合之间执行交叉点，因为它们存储在被映射到不同Redis实例中的键。</p>
<pre><code>*   
</code></pre><p>涉及多个键的Redis事务不能被使用。</p>
<pre><code>*   
</code></pre><p>分区粒度是关键，所以它是不可能分片数据集用一个硕大的键是一个非常大的有序集合。</p>
<pre><code>*   
</code></pre><p>当分区时，数据处理比较复杂，比如要处理多个RDB/AOF文件，使数据备份需要从多个实例和主机聚集持久性文件。</p>
<pre><code>*   
</code></pre><p>添加和删除的能力可能很复杂。比如Redis的集群支持有添加，并在运行时删除节点不支持此功能的能力，但其他系统，如客户端的分区和代理的数据大多是透明的重新平衡。但是有一个叫Presharding技术有助于在这方面。</p>
<pre><code>### 分区的类型
</code></pre><p>redis的提供有两种类型的分区。假设我们有四个Redis实例R0，R1，R2，R3和代表用户很多键如：user:1, user:2, … 等等</p>
<pre><code>### 范围分区
</code></pre><p>范围分区被映射对象转化为具体的Redis实例的范围内实现。假定在本例中用户ID0〜ID10000将进入实例R0，而用户形成ID10001至20000号将进入实例R1等等。</p>
<pre><code>### 散列分区
</code></pre><p>在这种类型的分区，一个散列函数（例如，模数函数）被用于转换键成数字，然后数据被存储在不同redis的实例。<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/edd98c69.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/edd98c69.html" itemprop="url">Ubuntu 安装 Redis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-22T21:27:00+08:00">
                2015-06-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-下载并安装-redis-2-6-16版"><a href="#1-下载并安装-redis-2-6-16版" class="headerlink" title="1. 下载并安装 redis 2.6.16版"></a>1. 下载并安装 redis 2.6.16版</h3><p>sudo mkdir /usr/local/src/Redis</p>
<p>cd /usr/local/src/Redis</p>
<p>sudo wget <a href="http://download.redis.io/releases/redis-2.6.16.tar.gz" target="_blank" rel="noopener">http://download.redis.io/releases/redis-2.6.16.tar.gz  
</a></p>
<p>tar -zxf redis-2.6.16.tar.gz<br>cd redis-2.6.16</p>
<p>sudo make</p>
<h3 id="2-检验编译是否-正确"><a href="#2-检验编译是否-正确" class="headerlink" title="2. 检验编译是否 正确"></a>2. 检验编译是否 正确</h3><p>sudo make test</p>
<div class="dp-highlighter bg_cpp"><br><div class="bar"><br><div class="tools"><strong>[cpp]</strong> <a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="view plain" target="_blank" rel="noopener">view plain</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="copy" target="_blank" rel="noopener">copy</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="print" target="_blank" rel="noopener">print</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="?" target="_blank" rel="noopener">?</a><a href="https://code.csdn.net/snippets/302207" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/402f9990-b4de-48dc-9a5a-a74fb659e6ff.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/302207/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/40434267-69bf-4b56-8086-ff55dfb04aa0.jpg" alt="派生到我的代码片"></a><br><div><br><br>1.  &lt;span style=<span class="string">“font-size:14px;”&gt;sounion@ubuntu:/usr/local/src/redis-2.6.16$ make test  </span><br>2.  cd src &amp;&amp; make test<br>3.  make[1]: Entering directory <code>/usr/local/src/redis-2.6.16/src&#39;  
4.  You need tcl 8.5 or newer in order to run the Redis test  
5.  make[1]: *** [test] Error 1  
6.  make[1]: Leaving directory</code>/usr/local/src/redis-2.6.16/src’<br>7.  make: <strong>* [test] Error 2<br>8.  <br><br>安装 tcl 8.5 后可以解决上述编译错误。<br><br><div class="dp-highlighter bg_html"><br><div class="bar"><br><div class="tools"></div></div></div></strong>[html]<strong> <a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="view plain" target="_blank" rel="noopener">view plain</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="copy" target="_blank" rel="noopener">copy</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="print" target="_blank" rel="noopener">print</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="?" target="_blank" rel="noopener">?</a><a href="https://code.csdn.net/snippets/302207" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/402f9990-b4de-48dc-9a5a-a74fb659e6ff.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/302207/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/40434267-69bf-4b56-8086-ff55dfb04aa0.jpg" alt="派生到我的代码片"></a><br><div><br><br>1.  <span class="tag">&lt;<span class="tag-name">span <span class="attribute">style=<span class="attribute-value">“font-size:14px;”<span class="tag">&gt;sounion@ubuntu:/usr/local/src/redis-2.6.16$ sudo apt-get install tcl  </span></span></span></span></span><br>2.  Reading package lists… Done<br>3.  Building dependency tree<br>4.  Reading state information… Done<br>5.  The following package was automatically installed and is no longer required:<br>6.    tdb-tools<br>7.  Use ‘apt-get autoremove’ to remove them.<br>8.  The following extra packages will be installed:<br>9.    tcl8.5<br>10.  Suggested packages:<br>11.    tclreadline<br>12.  The following NEW packages will be installed:<br>13.    tcl tcl8.5<br>14.  0 upgraded, 2 newly installed, 0 to remove and 565 not upgraded.<br>15.  Need to get 1,102 kB of archives.<br>16.  After this operation, 3,862 kB of additional disk space will be used.<br>17.  Do you want to continue [Y/n]? y<br>18.  Get:1 <a href="http://mirrors.sohu.com/ubuntu/" target="_blank" rel="noopener">http://mirrors.sohu.com/ubuntu/</a> precise/main tcl8.5 amd64 8.5.11-1ubuntu1 [1,098 kB]<br>19.  Get:2 <a href="http://mirrors.sohu.com/ubuntu/" target="_blank" rel="noopener">http://mirrors.sohu.com/ubuntu/</a> precise/main tcl all 8.5.0-2 [4,690 B]<br>20.  Fetched 1,102 kB in 3s (303 kB/s)<br>21.  Selecting previously unselected package tcl8.5.<br>22.  (Reading database … 199470 files and directories currently installed.)<br>23.  Unpacking tcl8.5 (from …/tcl8.5_8.5.11-1ubuntu1_amd64.deb) …<br>24.  Selecting previously unselected package tcl.<br>25.  Unpacking tcl (from …/archives/tcl_8.5.0-2_all.deb) …<br>26.  Processing triggers for man-db …<br>27.  Setting up tcl8.5 (8.5.11-1ubuntu1) …<br>28.  update-alternatives: using /usr/bin/tclsh8.5 to provide /usr/bin/tclsh (tclsh) in auto mode.<br>29.  Setting up tcl (8.5.0-2) …<br>30.  update-alternatives: using /usr/bin/tclsh-default to provide /usr/bin/tclsh (tclsh) in auto mode.<br>31.  Processing triggers for libc-bin …<br>32.  ldconfig deferred processing now taking place<br>33.  <span class="tag">&lt;/<span class="tag-name">span<span class="tag">&gt;  </span></span></span><br><br>### 3. 手工启动redis，测试redis是否运行正常<br><br>a)执行命令手工启动redis server: </div></strong>  <strong>  该命令将使用缺省参数

</strong>./src/redis-server<strong><br><br>b)检查进程是否有Redis了：ps aux | grep redis，可以看见进程列表中有一个叫“src/redis-server”的进程了<br><br><div class="dp-highlighter bg_html"><br><div class="bar"><br><div class="tools"></div></div></div></strong>[html]<strong> <a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="view plain" target="_blank" rel="noopener">view plain</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="copy" target="_blank" rel="noopener">copy</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="print" target="_blank" rel="noopener">print</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="?" target="_blank" rel="noopener">?</a><a href="https://code.csdn.net/snippets/302207" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/402f9990-b4de-48dc-9a5a-a74fb659e6ff.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/302207/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/40434267-69bf-4b56-8086-ff55dfb04aa0.jpg" alt="派生到我的代码片"></a><br><div><br><br>1.  <span class="tag">&lt;<span class="tag-name">span <span class="attribute">style=<span class="attribute-value">“font-size:14px;”<span class="tag">&gt;sounion@ubuntu:~/Desktop$ ps aux | grep redis  </span></span></span></span></span><br>2.  sounion  65350  0.0  0.0  35024  1960 pts/1    Sl+  07:28   0:00 ./src/redis-server<br>3.  sounion  65441  0.0  0.0  13584   916 pts/4    S+   07:31   0:00 grep <span class="attribute">–color=<span class="attribute-value">auto redis  </span></span><br>4.  <span class="tag">&lt;/<span class="tag-name">span<span class="tag">&gt;  </span></span></span><br><br>c) 启动redis自带的客户端，进行测试：<br>        # src/redis-cli – 启动客户端并连接本地Redis<br>        # set foo bar – 提示 “ok”说明设置键值正常。<br>        # get foo – 能够提示返回正确的“bar”，说明运行正常。<br>        # quit – 退出客户端<br><br><div class="dp-highlighter bg_html"><br><div class="bar"><br><div class="tools"></div></div></div></div></strong>[html]<strong> <a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="view plain" target="_blank" rel="noopener">view plain</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="copy" target="_blank" rel="noopener">copy</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="print" target="_blank" rel="noopener">print</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="?" target="_blank" rel="noopener">?</a><a href="https://code.csdn.net/snippets/302207" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/402f9990-b4de-48dc-9a5a-a74fb659e6ff.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/302207/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/40434267-69bf-4b56-8086-ff55dfb04aa0.jpg" alt="派生到我的代码片"></a><br><div><br><br>1.  <span class="tag">&lt;<span class="tag-name">span <span class="attribute">style=<span class="attribute-value">“font-size:14px;”<span class="tag">&gt;sounion@ubuntu:/usr/local/src/redis-2.6.16$ ./src/redis-cli   </span></span></span></span></span><br>2.  redis 127.0.0.1:6379<span class="tag">&gt; set foo bar  </span><br>3.  OK<br>4.  redis 127.0.0.1:6379<span class="tag">&gt; get foo  </span><br>5.  “bar”<br>6.  redis 127.0.0.1:6379<span class="tag">&gt; quit  </span><br>7.  <span class="tag">&lt;/<span class="tag-name">span<span class="tag">&gt;  </span></span></span><br><br>d) 如果希望使用自己的 redis.conf 配置文件，可以使用如下命令：

</div></strong>./src/redis-server /path/to/redis.conf<strong><br><br>e) 如果希望额外覆盖 redis.conf 配置文件中的某些参数，可以直接在命令行中使用参数：

</strong>./src/redis-server /etc/redis.conf  –loglevel debug<strong>

</strong>./sr/redis-server  –port 9999 –slaveof 127.0.0.1 6379<strong><br><br>### 4.  开启多个redis 服务器实例<br><br><span lang="zh-CN">一台Redis<span lang="zh-CN">服务器，分成多个节点，每个节点分配一个端口（6380<span lang="zh-CN">，6381…<span lang="zh-CN">），默认端口是6379<span lang="zh-CN">。</span></span></span></span></span><br><br><span lang="zh-CN">如果已经开启了 一个redis 服务实例，再次执行 ./src/redis-server 会产生如下错误</span><br><br><div class="dp-highlighter bg_html"><br><div class="bar"><br><div class="tools"></div></div></div></strong>[html]<strong> <a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="view plain" target="_blank" rel="noopener">view plain</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="copy" target="_blank" rel="noopener">copy</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="print" target="_blank" rel="noopener">print</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="?" target="_blank" rel="noopener">?</a><a href="https://code.csdn.net/snippets/302207" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/402f9990-b4de-48dc-9a5a-a74fb659e6ff.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/302207/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/40434267-69bf-4b56-8086-ff55dfb04aa0.jpg" alt="派生到我的代码片"></a><br><div><br><br>1.  <span class="tag">&lt;<span class="tag-name">span <span class="attribute">style=<span class="attribute-value">“font-size:14px;”<span class="tag">&gt;sounion@ubuntu:/usr/local/src/redis-2.6.16$ sudo ./src/redis-server   </span></span></span></span></span><br>2.  [347] 19 Apr 07:47:00.859 # Warning: no config file specified, using the default config. In order to specify a config file use ./src/redis-server /path/to/redis.conf<br>3.  [347] 19 Apr 07:47:00.861 * Max number of open files set to 10032<br>4.  [347] 19 Apr 07:47:00.861 # Opening port 6379: bind: Address already in use<br>5.  <span class="tag">&lt;/<span class="tag-name">span<span class="tag">&gt;  </span></span></span><br><br><span lang="zh-CN"> </span><br><br><span lang="zh-CN">每个节点对应一个Redis<span lang="zh-CN">配置文件，如：redis6380.conf<span lang="zh-CN">、redis6381.conf</span></span></span><br><br>cp redis.conf  redis6380.conf<br><br>vi redis6380.conf<br><br>pidfile : pidfile/var/run/redis/redis_6380.pid<br><br>port 6380<br><br>logfile : logfile/var/log/redis/redis_6380.log<br><br>rdbfile : dbfilenamedump_6380.rdb<br><br>启动多个redis实例：<br><br>./src/redis-server /usr/local/redis/redis6380.conf<br><br>./src/redis-server /usr/local/redis/redis6381.conf<br><br>### 5、安装 redis-server<br><br>如果只是偶尔测试使用，可以使用 ./src/redis-server 方式直接启动。<br><br>但是如果是生产环境，需要进行 redis-server 安装部署。<br><br>命令：

</div></strong>cd /us/local/src/redis-2.6.16//utils<strong>

</strong>sudo ./install_server.sh<strong>

</strong>这个悲催的install_server.sh 命令必须在进入 utils 目录后再执行！<strong>

</strong>因为它的脚本写法以来一些相对目录路径！<strong><br><br><div class="dp-highlighter bg_cpp"><br><div class="bar"><br><div class="tools"></div></div></div></strong>[cpp]** <a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="view plain" target="_blank" rel="noopener">view plain</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="copy" target="_blank" rel="noopener">copy</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="print" target="_blank" rel="noopener">print</a><a href="http://blog.csdn.net/cfy_phonex/article/details/24140985" title="?" target="_blank" rel="noopener">?</a><a href="https://code.csdn.net/snippets/302207" title="在CODE上查看代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/402f9990-b4de-48dc-9a5a-a74fb659e6ff.png" alt="在CODE上查看代码片"></a><a href="https://code.csdn.net/snippets/302207/fork" title="派生到我的代码片" target="_blank" rel="noopener"><img src="http://pangguoming.com/blog/images/40434267-69bf-4b56-8086-ff55dfb04aa0.jpg" alt="派生到我的代码片"></a><br><div><br><br>1.  sounion@ubuntu:/usr/local/src/redis-2.6.16/utils$ sudo ./install_server.sh<br>2.  Welcome to the redis service installer<br>3.  This script will help you easily set up a running redis server<br>4.<br>5.<br>6.  Please select the redis port <span class="keyword">for <span class="keyword">this instance: [6379]   </span></span><br>7.  Selecting <span class="keyword">default: 6379  </span><br>8.  Please select the redis config file name [/etc/redis/6379.conf]<br>9.  Selected <span class="keyword">default - /etc/redis/6379.conf  </span><br>10.  Please select the redis log file name [/var/log/redis_6379.log]<br>11.  Selected <span class="keyword">default - /var/log/redis_6379.log  </span><br>12.  Please select the data directory <span class="keyword">for <span class="keyword">this instance [/var/lib/redis/6379]   </span></span><br>13.  Selected <span class="keyword">default - /var/lib/redis/6379  </span><br>14.  Please select the redis executable path [] /usr/local/src/redis-2.6.16/src/redis-server<br>15.  s#^port [0-9]{4}$#port 6379#;s#^logfile .+$#logfile /var/log/redis_6379.log#;s#^dir .+$#dir /var/lib/redis/6379#;s#^pidfile .+$#pidfile /var/run/redis_6379.pid#;s#^daemonize no$#daemonize yes#;<br>16.  Copied /tmp/6379.conf =&gt; /etc/init.d/redis_6379<br>17.  Installing service…<br>18.  update-rc.d: warning: /etc/init.d/redis_6379 missing LSB information<br>19.  update-rc.d: see &lt;http:<span class="comment">//wiki.debian.org/LSBInitScripts&gt;  </span><br>20.   Adding system startup <span class="keyword">for /etc/init.d/redis_6379 …  </span><br>21.     /etc/rc0.d/K20redis_6379 -&gt; ../init.d/redis_6379<br>22.     /etc/rc1.d/K20redis_6379 -&gt; ../init.d/redis_6379<br>23.     /etc/rc6.d/K20redis_6379 -&gt; ../init.d/redis_6379<br>24.     /etc/rc2.d/S20redis_6379 -&gt; ../init.d/redis_6379<br>25.     /etc/rc3.d/S20redis_6379 -&gt; ../init.d/redis_6379<br>26.     /etc/rc4.d/S20redis_6379 -&gt; ../init.d/redis_6379<br>27.     /etc/rc5.d/S20redis_6379 -&gt; ../init.d/redis_6379<br>28.  Success!<br>29.  Starting Redis server…<br>30.  Installation successful!<br><br>### 6、添加到开机启动<br><br>如果进行了上述生产环境安装，则不再需要手动添加开机启动。<br><br>否则，需要修改<br><br>sudo vim /etc/rc.local<br><br>添加 /usr/local/src/redis-2.6.16/src/redis-server redis.conf<br><br>### 7、修改redis配置<br><br>如果 vm.overcommit_memory=0, 则在低内存状态时，后台redis 保存服务可能会失败。<br><br>需要修改配置文件/etc/sysctl.conf  添加 vm.overcommit_memory=1 然后重新启动使之生效。<br><br>刷新配置生效 sysctl vm.overcommit_memory=1<br><br>补充介绍<br><br>如果内存情况比较紧张的话，需要设定内核参数： /proc/sys/vm/overcommit_memory<br><br>这里说一下这个配置的含义：<br><br>/proc/sys/vm/overcommit_memory<br><br>该文件指定了内核针对内存分配的策略，其值可以是0、1、2。<br><br>0，表示内核将检查是否有足够的可用内存供应用进程使用；如果有足够的可用内存，内存申请允许；否则，内存申请失败，并把错误返回给应用进程。<br><br>1，表示内核允许分配所有的物理内存，而不管当前的内存状态如何。<br><br>2，表示内核允许分配超过所有物理内存和交换空间总和的内存<br></div></div></div></div></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/2cbf4099.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/2cbf4099.html" itemprop="url">安装Ubuntu Linux系统时硬盘分区最合理的方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-18T07:39:00+08:00">
                2015-06-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>无论是安装Windows还是Linux操作系统，硬盘分区都是整个系统安装过程中最为棘手的环节，网上的一些Ubuntu Linux安装教程一般都是自动分区，给初学者带来很大的不便，<strong>下面我就根据多年来在合肥上门装系统的经验谈谈安装Ubuntu Linux系统时硬盘分区最合理的方法。</strong></p>
<p>在讲硬盘分区之前，我先来普及一下硬盘的相关分类，硬盘一般分为IDE硬盘、SCSI硬盘和SATA硬盘三种，在Linux系统中，IDE接口的硬盘被称为hd，SCSI和SATA接口的硬盘则被称为sd，其中IDE硬盘基本上已经淘汰，现在市面上最常见的就是SATA接口的硬盘，第1块硬盘称为sda，第2块硬盘称为sdb……，依此类推。</p>
<p>一块硬盘最多有4个主分区，主分区以外的分区称为扩展分区，硬盘可以没有扩展分区，但是一定要有主分区，在主分区中要有一个激活分区用来启动Windows系统，在扩展分区中可以建立若干个逻辑分区，因此，最合理的分区方式应该最多分三个主分区，一个扩展分区，这样可以有效地利用有限的主分区，然后在扩展分区中建立逻辑分区。</p>
<p>在Linux系统中每一个硬盘总共最多有 16个分区，硬盘上的4个主分区，分别标识为sdal、sda2、sda3和sda4，逻辑分区则从sda5开始标识一直到sda16。</p>
<p>Ubuntu Linux可以把分区作为挂载点，载入目录，其中最常用的目录如下表所示：</p>
<table><br><tbody><br><tr><th width="10%">目录</th><th width="15%">建议大小</th><th width="10%">格式</th><th>描述</th></tr><br><tr><br><td>/</td><br><td>10G-20G</td><br><td>ext4</td><br><td>根目录</td><br></tr><br><tr><br><td>swap</td><br><td>&lt;2048M</td><br><td>swap</td><br><td>交换空间</td><br></tr><br><tr><br><td>/boot</td><br><td>200M左右</td><br><td>ext4</td><br><td>Linux的内核及引导系统程序所需要的文件，比如 vmlinuz initrd.img文件都位于这个目录中。在一般情况下，GRUB或LILO系统引导管理器也位于这个目录；启动撞在文件存放位置，如kernels，initrd，grub。</td><br></tr><br><tr><br><td>/tmp</td><br><td>5G左右</td><br><td>ext4</td><br><td>系统的临时文件，一般系统重启不会被保存。（建立服务器需要？）</td><br></tr><br><tr><br><td>/home</td><br><td>尽量大些</td><br><td>ext4</td><br><td>用户工作目录；个人配置文件，如个人环境变量等；所有账号分配一个工作目录。</td><br></tr><br></tbody><br></table>

<p>接下来<a href="http://www.ah168.com/" target="_blank" rel="noopener">合肥电脑维修</a>网就以Ubuntu Linux 12.04.3为例来为大家图文讲解手动对硬盘进行分区的方法。</p>
<p>在如图1所示的分区界面中有两个选项可供选择。最简单的莫过于“清除整个硬盘并安装Ubuntu”选项，单击“继续”按钮，安装向导将根据原有的分区信息自动选择合理的分区方式。</p>
<p><img src="http://pangguoming.com/blog/images/2f66eddb-6547-4a36-80d9-581f356a3305.png" alt="Ubuntu Linux分区向导"></p>
<div class="c">图1：Ubuntu Linux分区向导<br><br>如果希望对分区过程进行完全控制，可以使用“其它”选项。单击“继续”按钮，安装向导将把用户带至手动分区界面，如图2所示。<br><br><img src="http://pangguoming.com/blog/images/c85da089-3fae-4933-a8fe-c423bd1fd900.png" alt="手动分区模式"><br><br><div class="c">图2：手动分区模式<br><br>在这里可以看到当前硬盘的分区信息，由于我使用的是虚拟机为大家进行演示，因此，只能看到一块没有使用过的硬盘，硬盘容量为20GB。<br><br>第一步：选中空闲的磁盘空间，点击“添加”按钮，弹出“创建新分区”对话框，新分区的类型为主分区，挂载点为/boot，新建分区容量为128MB，最后点击“确定”按钮，如下图所示。<br><br><img src="http://pangguoming.com/blog/images/9d3434d1-2c8e-4a9e-864f-43a1925534f1.png" alt="建立启动分区"><br><br><div class="c">图3：建立启动分区<br><br>这个挂载点包含了操作系统的内核和在启动系统过程中所要用到的文件，接下来要新建一个交换分区。<br><br>第二步：选中空闲的磁盘空间，点击“添加”按钮，弹出“创建新分区”对话框，新分区的类型为逻辑分区，“用于”选择“交换空间”，新建分区容量为1024M，最后点击“确定”按钮，如下图所示。<br><br><img src="http://pangguoming.com/blog/images/8d69a0bc-4243-4e35-9e1a-607a2b303a76.png" alt="建立交换分区"><br><br><div class="c">图4：建立交换分区<br><br>交换分区相当于Windows中的“虚拟内存”，如果物理内存小于或等于512MB，建议分配交换分区的大小为物理内存容量的2倍；如果物理内存大于512MB，建议分配交换分区的大小等于物理内存容量；如果您的内存够大也可以不建立交换分区。<br><br>按同样的方法依次建立/var、/tmp、/home等挂载点，最终分区结果如下图所示。<br><br><img src="http://pangguoming.com/blog/images/8031f120-f414-4e47-b3ae-eade79eee437.png" alt="最终硬盘分区结果"><br><br><div class="c">图4：最终硬盘分区结果<br><div class="c"><br><div class="c">引自：<a href="http://www.ah168.com/jishuwenzhang/xitong/Ubuntu-916.html" target="_blank" rel="noopener">http://www.ah168.com/jishuwenzhang/xitong/Ubuntu-916.html</a></div></div></div></div></div></div></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/37/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/37/">37</a><span class="page-number current">38</span><a class="page-number" href="/page/39/">39</a><span class="space">&hellip;</span><a class="page-number" href="/page/42/">42</a><a class="extend next" rel="next" href="/page/39/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4" alt="庞国明">
            
              <p class="site-author-name" itemprop="name">庞国明</p>
              <p class="site-description motion-element" itemprop="description">Software make the information world run, and programer make the softeware run.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">420</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">267</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/pangguoming" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:pangguoming@yeah.net" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/pangguoming" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/users/1570700/pangguoming" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/pangguoming" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">庞国明</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  

  

  

</body>
</html>
