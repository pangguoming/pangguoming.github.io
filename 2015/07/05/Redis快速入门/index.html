<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Redis,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2">






<meta name="description" content="Redis是一个开源，先进的key-value存储，并用于构建高性能，可扩展的Web应用程序的完美解决方案。 Redis从它的许多竞争继承来的三个主要特点：    Redis数据库完全在内存中，使用磁盘仅用于持久性。    相比许多键值数据存储，Redis拥有一套较为丰富的数据类型。    Redis可以将数据复制到任意数量的从服务器。 Redis 优势   异常快速：Redis的速度非常快，每秒">
<meta name="keywords" content="Redis">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis快速入门">
<meta property="og:url" content="http://pangguoming.com/2015/07/05/Redis快速入门/index.html">
<meta property="og:site_name" content="庞国明-博客">
<meta property="og:description" content="Redis是一个开源，先进的key-value存储，并用于构建高性能，可扩展的Web应用程序的完美解决方案。 Redis从它的许多竞争继承来的三个主要特点：    Redis数据库完全在内存中，使用磁盘仅用于持久性。    相比许多键值数据存储，Redis拥有一套较为丰富的数据类型。    Redis可以将数据复制到任意数量的从服务器。 Redis 优势   异常快速：Redis的速度非常快，每秒">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-02-07T11:25:09.737Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Redis快速入门">
<meta name="twitter:description" content="Redis是一个开源，先进的key-value存储，并用于构建高性能，可扩展的Web应用程序的完美解决方案。 Redis从它的许多竞争继承来的三个主要特点：    Redis数据库完全在内存中，使用磁盘仅用于持久性。    相比许多键值数据存储，Redis拥有一套较为丰富的数据类型。    Redis可以将数据复制到任意数量的从服务器。 Redis 优势   异常快速：Redis的速度非常快，每秒">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pangguoming.com/2015/07/05/Redis快速入门/">





  <title>Redis快速入门 | 庞国明-博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">
	<div id="topnavbar">
  <div class="tophead">
    <div class="toplogo"><a href="/">庞国明-博客</a></div>
    <div id="mnav">
      <h2><span class="navicon"></span></h2>
      <ul>
        <li><a href="/">博客</a></li>
        <li><a href="/course.html">文档教程</a></li>
        <li><a href="/video.html">视频教程</a></li>
        <li><a href="/code.html">源码分享</a></li>
        <li><a href="/about.html">关于我</a></li>
      </ul>
    </div>
    <nav class="topnav" id="topnav">
      <ul>
        <li><a href="/">博客</a></li>
        <li><a href="/course.html">文档教程</a></li>
        <li><a href="/video.html">视频教程</a></li>
        <li><a href="/code.html">源码分享</a></li>
        <li><a href="/about.html">关于我</a></li>
      </ul>
    </nav>
  </div>
</div>

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">庞国明-博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">此心用度八千遍，不曾厌倦</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/2015/07/05/Redis快速入门/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Redis快速入门</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-05T18:16:00+08:00">
                2015-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Redis是一个开源，先进的key-value存储，并用于构建高性能，可扩展的Web应用程序的完美解决方案。</p>
<p>Redis从它的许多竞争继承来的三个主要特点：</p>
<ul>
<li></li>
</ul>
<p>Redis数据库完全在内存中，使用磁盘仅用于持久性。</p>
<ul>
<li></li>
</ul>
<p>相比许多键值数据存储，Redis拥有一套较为丰富的数据类型。</p>
<ul>
<li></li>
</ul>
<p>Redis可以将数据复制到任意数量的从服务器。</p>
<h2 id="Redis-优势"><a href="#Redis-优势" class="headerlink" title="Redis 优势"></a>Redis 优势</h2><ul>
<li></li>
</ul>
<p>异常快速：Redis的速度非常快，每秒能执行约11万集合，每秒约81000+条记录。</p>
<ul>
<li></li>
</ul>
<p>支持丰富的数据类型：Redis支持最大多数开发人员已经知道像列表，集合，有序集合，散列数据类型。这使得它非常容易解决各种各样的问题，因为我们知道哪些问题是可以处理通过它的数据类型更好。</p>
<ul>
<li></li>
</ul>
<p>操作都是原子性：所有Redis操作是原子的，这保证了如果两个客户端同时访问的Redis服务器将获得更新后的值。</p>
<ul>
<li></li>
</ul>
<p>多功能实用工具：Redis是一个多实用的工具，可以在多个用例如缓存，消息，队列使用(Redis原生支持发布/订阅)，任何短暂的数据，应用程序，如Web应用程序会话，网页命中计数等。</p>
<h1 id="Redis-环境"><a href="#Redis-环境" class="headerlink" title="Redis - 环境"></a>Redis - 环境</h1><p>Ubuntu上安装Redis，打开终端，然后键入以下命令：</p>
<p><span class="pln">$sudo apt-get update<br>    <span class="pln">$sudo apt-get install redis-server<br>    </span></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这将在您的计算机上安装Redis。</span><br><span class="line"></span><br><span class="line">启动 Redis</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;$redis-server</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure></p>
<p>检查Redis是否在工作？</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;$redis-cli
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这将打开一个Redis提示，如下图所示：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt;</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>上面的提示127.0.0.1是本机的IP地址，6379为Redis服务器运行的端口。现在输入PING命令，如下图所示。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ping
&lt;span class=&quot;pln&quot;&gt;PONG
&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这说明你已经成功地安装Redis在您的机器上。</span><br><span class="line"></span><br><span class="line">    ## 在Ubuntu上安装Redis的桌面管理器</span><br><span class="line"></span><br><span class="line">在Ubuntu上安装Redis的桌面管理器，只需从 [http://redisdesktop.com/download](http://redisdesktop.com/download) 打开下载软件包并安装它。</span><br><span class="line"></span><br><span class="line">Redis桌面管理器会给你用户界面来管理Redis的Key和数据。</span><br><span class="line"></span><br><span class="line">    # Redis - 数据类型</span><br><span class="line"></span><br><span class="line">Redis支持5种类型的数据类型，它描述如下的：</span><br><span class="line"></span><br><span class="line">    ## 字符串</span><br><span class="line"></span><br><span class="line">Redis字符串是字节序列。Redis字符串是二进制安全的，这意味着他们有一个已知的长度没有任何特殊字符终止，所以你可以存储任何东西，512兆为上限。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET name &quot;yiibai&quot;</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; GET name</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;&quot;yiibai&quot;</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>上面是Redis的set和get命令的例子，Redis名称为yiibai使用的key存储在Redis的字符串值。</p>
<pre><code>## 哈希
</code></pre><p>Redis的哈希是键值对的集合。 Redis的哈希值是字符串字段和字符串值之间的映射，因此它们被用来表示对象</p>
<pre><code>### 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HMSET user:1 username yiibai password yiibai points 200
&lt;span class=&quot;pln&quot;&gt;OK
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HGETALL user:1
&lt;span class=&quot;pln&quot;&gt;
1) &quot;username&quot;
2) &quot;yiibai&quot;
3) &quot;password&quot;
4) &quot;yiibai&quot;
5) &quot;points&quot;
6) &quot;200&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上面的例子中的哈希数据类型，用于存储其中包含的用户的基本信息用户的对象。这里HMSET，HEGTALL用户命令user:1是键。</span><br><span class="line"></span><br><span class="line">    ## 列表</span><br><span class="line"></span><br><span class="line">Redis的列表是简单的字符串列表，排序插入顺序。您可以添加元素到Redis的列表的头部或尾部。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lpush tutoriallist redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lpush tutoriallist mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 2</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lpush tutoriallist rabitmq</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 3</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; lrange tutoriallist 0 10</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;rabitmq&quot;</span><br><span class="line">    2) &quot;mongodb&quot;</span><br><span class="line">    3) &quot;redis&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>列表的最大长度为 232 - 1 元素（4294967295，每个列表中可容纳超过4十亿的元素）。</p>
<pre><code>## 集合
</code></pre><p>Redis的集合是字符串的无序集合。在Redis您可以添加，删除和测试文件是否存在，在成员O（1）的时间复杂度。</p>
<pre><code>### 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist redis
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist mongodb
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist rabitmq
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; sadd tutoriallist rabitmq
&lt;span class=&quot;pln&quot;&gt;(integer) 0
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; smembers tutoriallist
&lt;span class=&quot;pln&quot;&gt;
1) &quot;rabitmq&quot;
2) &quot;mongodb&quot;
3) &quot;redis&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意：在上面的例子中rabitmq集合添加加两次，但由于集合元素具有唯一属性。</span><br><span class="line"></span><br><span class="line">集合中的元素最大数量为 232 - 1 （4294967295，可容纳超过4十亿元素）。</span><br><span class="line"></span><br><span class="line">    ## 有序集合</span><br><span class="line"></span><br><span class="line">Redis的有序集合类似于Redis的集合，字符串不重复的集合。不同的是，一个有序集合的每个成员用分数，以便采取有序set命令，从最小的到最大的成员分数有关。虽然成员具有唯一性，但分数可能会重复。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 rabitmq</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; zadd tutoriallist 0 rabitmq</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 0</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZRANGEBYSCORE tutoriallist 0 1000</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;redis&quot;</span><br><span class="line">    2) &quot;mongodb&quot;</span><br><span class="line">    3) &quot;rabitmq&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

# Redis - keys
</code></pre><p>Redis keys命令用于在Redis的管理键。Redis keys命令使用语法如下所示：</p>
<pre><code>## 语法

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; COMMAND KEY_NAME
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 例子</span><br><span class="line"></span><br><span class="line">&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET yiibai redis</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; DEL yiibai</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上面的例子中DEL是命令，而yiibai是key。如果key被删除，那么输出该命令将是（整数）1，否则它会是（整数）0</p>
<pre><code># Redis - Strings
</code></pre><p>Redis strings命令用于在Redis的管理字符串值。Redis strings命令的使用语法，如下所示：</p>
<pre><code>## 语法

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; COMMAND KEY_NAME
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 例子</span><br><span class="line"></span><br><span class="line">&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET yiibai redis</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; GET yiibai</span><br><span class="line">&lt;span class=&quot;pln&quot;&gt;&quot;redis&quot;</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上面的例子SET和GET是命令，而yiibai是key。</p>
<pre><code># Redis - 哈希
</code></pre><p>Redis的哈希值是字符串字段和字符串值之间的映射，所以他们是代表对象的完美数据类型</p>
<p>在Redis的哈希值，最多可存储超过400十亿字段 - 值对。</p>
<pre><code>## 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HMSET yiibai name &quot;redis tutorial&quot; description &quot;redis basic commands for caching&quot; likes 20 visitors 23000
&lt;span class=&quot;pln&quot;&gt;OK
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; HGETALL yiibai
&lt;span class=&quot;pln&quot;&gt;
1) &quot;name&quot;
2) &quot;redis tutorial&quot;
3) &quot;description&quot;
4) &quot;redis basic commands for caching&quot;
5) &quot;likes&quot;
6) &quot;20&quot;
7) &quot;visitors&quot;
8) &quot;23000&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上面的例子中，已经在哈希命名yiibai的Redis集合名为tutorials（name, description, likes, visitors）</span><br><span class="line"></span><br><span class="line">    # Redis - 列表</span><br><span class="line"></span><br><span class="line">Redis的列表是简单的字符串列表，排序插入顺序。您可以添加Redis元素在列表头部或列表的尾部。</span><br><span class="line"></span><br><span class="line">列表的最大长度为 232 - 1 个元素（每个列表元素个数超过4294967295）。</span><br><span class="line"></span><br><span class="line">    ## 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LPUSH tutorials redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LPUSH tutorials mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 2</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LPUSH tutorials mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 3</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; LRANGE tutorials 0 10</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;mysql&quot;</span><br><span class="line">    2) &quot;mongodb&quot;</span><br><span class="line">    3) &quot;redis&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上述例子中的三个值被插入在redis列表名为LPUSH的命令教程。</p>
<pre><code># Redis - 集合
</code></pre><p>Redis的集合是唯一的字符串的无序集合。集合的唯一性不允许数据的重复的键。</p>
<p>在Redis的集合添加，删除和测试文件是否存在成员在O（1）（常数时间不管里面包含的元素集合的数量）。集合的最大长度为 232 - 1 个元素（每集合超过4294967295元素）。</p>
<pre><code>## 例子

&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials redis
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials mongodb
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials mysql
&lt;span class=&quot;pln&quot;&gt;(integer) 1
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SADD tutorials mysql
&lt;span class=&quot;pln&quot;&gt;(integer) 0
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SMEMBERS tutorials
&lt;span class=&quot;pln&quot;&gt;
1) &quot;mysql&quot;
2) &quot;mongodb&quot;
3) &quot;redis&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上述例子中的三个值被命令SADD插入redis的集合名称tutorials。</span><br><span class="line"></span><br><span class="line">    # Redis有序集</span><br><span class="line"></span><br><span class="line">Redis的有序集合类似Redis的集合存储在设定值具有唯一性。不同的是，一个有序集合的每个成员用分数，以便采取有序set命令，从最小的到最大的分数有关。</span><br><span class="line"></span><br><span class="line">在Redis的有序set添加，删除和测试存在成员O（1）（固定时间，无论里面包含集合元素的数量）。列表的最大长度为 232 - 1 个元素（每集合超过4294967295元素）。</span><br><span class="line"></span><br><span class="line">    ## 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 1 redis</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 2 mongodb</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 3 mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 1</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 3 mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 0</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZADD tutorials 4 mysql</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;(integer) 0</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; ZRANGE tutorials 0 10 WITHSCORES</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;redis&quot;</span><br><span class="line">    2) &quot;1&quot;</span><br><span class="line">    3) &quot;mongodb&quot;</span><br><span class="line">    4) &quot;2&quot;</span><br><span class="line">    5) &quot;mysql&quot;</span><br><span class="line">    6) &quot;4&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上述例子中的三个值被命令ZADD插入其得分在redis的有序集命名为tutorials。</p>
<pre><code># Redis - HyperLogLog
</code></pre><p>Redis的HyperLogLog使用随机化，以提供唯一的元素数目近似的集合只使用一个常数，并且体积小，少量内存的算法。</p>
<p>HyperLogLog提供，即使每个使用了非常少量的内存（12千字节），标准误差为集合的基数非常近似，没有限制的条目数，可以指定，除非接近 264个条目。</p>
<pre><code>### 例子
</code></pre><p>下面的示例说明Redis的HyperLogLog工作原理：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFADD tutorials &quot;redis&quot;
&lt;span class=&quot;pln&quot;&gt;
1) (integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFADD tutorials &quot;mongodb&quot;
&lt;span class=&quot;pln&quot;&gt;
1) (integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFADD tutorials &quot;mysql&quot;
&lt;span class=&quot;pln&quot;&gt;
1) (integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PFCOUNT tutorials
&lt;span class=&quot;pln&quot;&gt;
(integer) 3

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 订阅</span><br><span class="line"></span><br><span class="line">Redis的订阅实现了邮件系统，发送者（在Redis的术语中被称为发布者）发送的邮件，而接收器（用户）接收它们。由该消息传送的链路被称为通道。</span><br><span class="line"></span><br><span class="line">在Redis客户端可以订阅任何数目的通道。</span><br><span class="line"></span><br><span class="line">    ### 示例</span><br><span class="line"></span><br><span class="line">以下举例说明如何发布用户的概念工作。在下面的例子给出一个客户端订阅一个通道名为redisChat</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SUBSCRIBE redisChat</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    Reading messages... (press Ctrl-C to quit)</span><br><span class="line">    1) &quot;subscribe&quot;</span><br><span class="line">    2) &quot;redisChat&quot;</span><br><span class="line">    3) (integer) 1</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>现在，两个客户端都发布在同一个命名通道redisChat消息，并且以上订阅客户端接收消息。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PUBLISH redisChat &quot;Redis is a great caching technique&quot;
&lt;span class=&quot;pln&quot;&gt;
(integer) 1

&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PUBLISH redisChat &quot;Learn redis by tutorials point&quot;
&lt;span class=&quot;pln&quot;&gt;
(integer) 1

&lt;span class=&quot;pln&quot;&gt;
1) &quot;message&quot;
2) &quot;redisChat&quot;
3) &quot;Redis is a great caching technique&quot;
1) &quot;message&quot;
2) &quot;redisChat&quot;
3) &quot;Learn redis by tutorials point&quot;

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 事务</span><br><span class="line"></span><br><span class="line">Redis事务让一组命令在单个步骤执行。事务中有两个属性，说明如下：</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">在一个事务中的所有命令按顺序执行作为单个隔离操作。通过另一个客户端发出的请求在Redis的事务的过程中执行，这是不可能的。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">Redis的事务具有原子性。原子意味着要么所有的命令都执行或都不执行。</span><br><span class="line"></span><br><span class="line">    ## 例子</span><br><span class="line"></span><br><span class="line">Redis的事务由指令多重发起，然后需要传递在事务，而且整个事务是通过执行命令EXEC执行命令列表。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; MULTI</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;List of commands here</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EXEC</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

### 例子
</code></pre><p>以下举例说明Redis事务如何启动并执行。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; MULTI
&lt;span class=&quot;pln&quot;&gt;OK
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; SET tutorial redis
&lt;span class=&quot;pln&quot;&gt;QUEUED
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; GET tutorial
&lt;span class=&quot;pln&quot;&gt;QUEUED
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; INCR visitors
&lt;span class=&quot;pln&quot;&gt;QUEUED
&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EXEC
&lt;span class=&quot;pln&quot;&gt;
1) OK
2) &quot;redis&quot;
3) (integer) 1

&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 脚本</span><br><span class="line"></span><br><span class="line">Redis脚本使用Lua解释脚本用于评估计算。它内置的Redis，从2.6.0版本开始使用脚本命令 eval。</span><br><span class="line"></span><br><span class="line">    ## 语法</span><br><span class="line"></span><br><span class="line">eval命令的基本语法如下：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EVAL script numkeys key [key ...] arg [arg ...]</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure>

### 例子
</code></pre><p>以下举例说明Redis脚本的工作原理：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; EVAL &quot;return {KEYS[1],KEYS[2],ARGV[1],ARGV[2]}&quot; 2 key1 key2 first second
&lt;span class=&quot;pln&quot;&gt;
1) &quot;key1&quot;
2) &quot;key2&quot;
3) &quot;first&quot;
4) &quot;second&quot;

&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 连接</span><br><span class="line"></span><br><span class="line">Redis的连接命令基本上都是用于管理与Redis的服务器客户端连接。</span><br><span class="line"></span><br><span class="line">    ### Example</span><br><span class="line"></span><br><span class="line">下面的例子说明了一个客户如何通过Redis服务器验证自己，并检查服务器是否正在运行。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; AUTH &quot;password&quot;</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;redis 127.0.0.1:6379&gt; PING</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;PONG</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

# Redis - 备份
</code></pre><p>Redis SAVE命令用来创建当前的 Redis 数据库备份。</p>
<pre><code>## 语法
</code></pre><p>对Redis SAVE命令的基本语法如下所示：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; SAVE
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">下面的示例显示了 Redis 当前数据库如何创建备份。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; SAVE</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    OK</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>这个命令将创建dump.rdb文件在Redis目录中。</p>
<pre><code>## 还原Redis数据
</code></pre><p>要恢复Redis的数据只需移动 Redis 的备份文件（dump.rdb）到 Redis 目录，然后启动服务器。为了得到你的 Redis 目录，使用配置命令如下所示：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG get dir
&lt;span class=&quot;pln&quot;&gt;
1) &quot;dir&quot;
2) &quot;/user/yiibai/redis-2.8.13/src&quot;

&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在上述命令的输出在 /user/yiibai/redis-2.8.13/src 目录，在安装redis的服务器安装位置。</span><br><span class="line"></span><br><span class="line">    ## Bgsave</span><br><span class="line"></span><br><span class="line">要创建Redis的备份备用命令BGSAVE也可以。这个命令将开始执行备份过程，并在后台运行。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; BGSAVE</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    Background saving started</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

# Redis - 安全
</code></pre><p>可以Redis的数据库更安全，所以相关的任何客户端都需要在执行命令之前进行身份验证。客户端输入密码匹配需要使用Redis设置在配置文件中的密码。</p>
<pre><code>### 例子
</code></pre><p>下面给出的例子显示的步骤，以确保您的Redis实例安全。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG get requirepass
&lt;span class=&quot;pln&quot;&gt;1) &quot;requirepass&quot;
2) &quot;&quot;
&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">默认情况下，此属性为空，表示没有设置密码，此实例。您可以通过执行以下命令来更改这个属性</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG set requirepass &quot;yiibai&quot;</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;OK</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; CONFIG get requirepass</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;1) &quot;requirepass&quot;</span><br><span class="line">    2) &quot;yiibai&quot;</span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>设置密码，如果客户端运行命令没有验证，会提示（错误）NOAUTH，需要通过验证。错误将返回客户端。因此，客户端需要使用AUTHcommand进行认证。</p>
<pre><code>### 语法
</code></pre><p>AUTH命令的基本语法如下所示：</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;127.0.0.1:6379&gt; AUTH password
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 基准</span><br><span class="line"></span><br><span class="line">Redis基准是公用工具同时运行Ñ命令检查Redis的性能。</span><br><span class="line"></span><br><span class="line">    ## 语法</span><br><span class="line"></span><br><span class="line">redis的基准的基本语法如下所示：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis-benchmark [option] [option value]</span><br><span class="line">    &lt;/span&gt;</span><br></pre></td></tr></table></figure>

### 例子
</code></pre><p>下面给出的例子检查redis调用100000命令。</p>
<pre><code>&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis-benchmark -n 100000
&lt;span class=&quot;pln&quot;&gt;
PING_INLINE: 141043.72 requests per second
PING_BULK: 142857.14 requests per second
SET: 141442.72 requests per second
GET: 145348.83 requests per second
INCR: 137362.64 requests per second
LPUSH: 145348.83 requests per second
LPOP: 146198.83 requests per second
SADD: 146198.83 requests per second
SPOP: 149253.73 requests per second
LPUSH (needed to benchmark LRANGE): 148588.42 requests per second
LRANGE_100 (first 100 elements): 58411.21 requests per second
LRANGE_300 (first 300 elements): 21195.42 requests per second
LRANGE_500 (first 450 elements): 14539.11 requests per second
LRANGE_600 (first 600 elements): 10504.20 requests per second
MSET (10 keys): 93283.58 requests per second

&lt;/span&gt;&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 客户端连接</span><br><span class="line"></span><br><span class="line">Redis接受配置监听TCP端口和Unix套接字客户端的连接，如果启用。当一个新的客户端连接被接受以下操作进行：</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">客户端套接字置于非阻塞状态，因为Redis使用复用和非阻塞I/O操作。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">TCP_NODELAY选项设定是为了确保我们没有在连接时延迟。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">创建一个可读的文件时，这样Redis能够尽快收集客户端的查询作为新的数据可供读取的套接字。</span><br><span class="line"></span><br><span class="line">    ### 客户端的最大数量</span><br><span class="line"></span><br><span class="line">在Redis的配置（redis.conf）属性调用maxclients，它描述客户端可以连接到Redis的最大数量。命令的基本语法是：</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;config get maxclients</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    1) &quot;maxclients&quot;</span><br><span class="line">    2) &quot;10000&quot;</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>默认情况下，此属性设置为10000（这取决于操作系统的文件描述符限制最大数量），但你可以改变这个属性。</p>
<pre><code>### 例子
</code></pre><p>在下面给出的例子中，在启动服务器我们设置客户端的最大数量为10万。</p>
<pre><code>&lt;div&gt;&lt;ins class=&quot;adsbygoogle&quot; data-ad-client=&quot;ca-pub-1090193214637198&quot; data-ad-slot=&quot;1381882050&quot; data-adsbygoogle-status=&quot;done&quot;&gt;&lt;ins id=&quot;aswift_1_expand&quot;&gt;&lt;ins id=&quot;aswift_1_anchor&quot;&gt;&lt;iframe id=&quot;aswift_1&quot; name=&quot;aswift_1&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; width=&quot;728&quot; height=&quot;15&quot;&gt;&lt;/iframe&gt;&lt;/ins&gt;&lt;/ins&gt;&lt;/ins&gt;
&lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;redis-server --maxclients 100000
&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    # Redis - 管道传输</span><br><span class="line"></span><br><span class="line">Redis是一个TCP服务器，并支持请求/响应协议。在redis一个请求完成下面的步骤：</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">客户端发送一个查询到服务器，并从套接字中读取，通常在阻塞的方式，对服务器的响应。</span><br><span class="line"></span><br><span class="line">    *   </span><br><span class="line"></span><br><span class="line">服务器处理命令并将响应返回给客户端。</span><br><span class="line"></span><br><span class="line">    ### 管道传输的含义</span><br><span class="line"></span><br><span class="line">管道的基本含义是，客户端可以发送多个请求给服务器，而无需等待答复所有，并最后读取在单个步骤中的答复。</span><br><span class="line"></span><br><span class="line">    ### 例子</span><br><span class="line"></span><br><span class="line">要检查redis的管道，只要启动Redis实例，然后在终端键入以下命令。</span><br><span class="line"></span><br><span class="line">    &lt;pre class=&quot;prettyprint prettyprinted&quot;&gt;&lt;span class=&quot;pln&quot;&gt;$(echo -en &quot;PING\r\n SET tutorial redis\r\nGET tutorial\r\nINCR visitor\r\nINCR visitor\r\nINCR visitor\r\n&quot;; sleep 10) | nc localhost 6379</span><br><span class="line">    &lt;span class=&quot;pln&quot;&gt;</span><br><span class="line">    +PONG</span><br><span class="line">    +OK</span><br><span class="line">    redis</span><br><span class="line">    :1</span><br><span class="line">    :2</span><br><span class="line">    :3</span><br><span class="line"></span><br><span class="line">    &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</code></pre><p>在上述例子中，我们必须使用PING命令检查Redis的连接，之后，我们已经设定值的Redis字符串命名tutorial ，之后拿到key的值和增量访问量的三倍。在结果中，我们可以检查所有的命令都一次提交给Redis，Redis是在一个步骤给出所有命令的输出。</p>
<pre><code>### 管道的好处
</code></pre><p>这种技术的好处是极大地改善协议的性能。通过管道将慢互联网连接速度从5倍的连接速度提高到localhost至少达到百过倍。</p>
<pre><code># Redis - 分区
</code></pre><p>分区是一种将数据分成多个Redis的情况下，让每一个实例将只包含你的键字的子集的过程。</p>
<pre><code>### 分区的好处

*   
</code></pre><p>它允许更大的数据库，使用的多台计算机的存储器的总和。如果不分区，一台计算机的内存可支数量有限。</p>
<pre><code>*   
</code></pre><p>它允许以大规模的计算能力，以多个内核和多个计算机，以及网络带宽向多台计算机和网络适配器。</p>
<pre><code>### 分区的缺点

*   
</code></pre><p>通常不支持涉及多个键的操作。例如，不能两个集合之间执行交叉点，因为它们存储在被映射到不同Redis实例中的键。</p>
<pre><code>*   
</code></pre><p>涉及多个键的Redis事务不能被使用。</p>
<pre><code>*   
</code></pre><p>分区粒度是关键，所以它是不可能分片数据集用一个硕大的键是一个非常大的有序集合。</p>
<pre><code>*   
</code></pre><p>当分区时，数据处理比较复杂，比如要处理多个RDB/AOF文件，使数据备份需要从多个实例和主机聚集持久性文件。</p>
<pre><code>*   
</code></pre><p>添加和删除的能力可能很复杂。比如Redis的集群支持有添加，并在运行时删除节点不支持此功能的能力，但其他系统，如客户端的分区和代理的数据大多是透明的重新平衡。但是有一个叫Presharding技术有助于在这方面。</p>
<pre><code>### 分区的类型
</code></pre><p>redis的提供有两种类型的分区。假设我们有四个Redis实例R0，R1，R2，R3和代表用户很多键如：user:1, user:2, … 等等</p>
<pre><code>### 范围分区
</code></pre><p>范围分区被映射对象转化为具体的Redis实例的范围内实现。假定在本例中用户ID0〜ID10000将进入实例R0，而用户形成ID10001至20000号将进入实例R1等等。</p>
<pre><code>### 散列分区
</code></pre><p>在这种类型的分区，一个散列函数（例如，模数函数）被用于转换键成数字，然后数据被存储在不同redis的实例。<br></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>感谢支持原创技术分享</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/repo/wechatpay.png" alt="庞国明 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/repo/alipay.jpg" alt="庞国明 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Redis/" rel="tag"># Redis</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/06/22/Ubuntu 安装 Redis/" rel="next" title="Ubuntu 安装 Redis">
                <i class="fa fa-chevron-left"></i> Ubuntu 安装 Redis
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/30/Mongoose学习参考文档/" rel="prev" title="Mongoose学习参考文档">
                Mongoose学习参考文档 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  <div onclick="showGitment()" id="gitment_title" class="gitment_title">显示 Gitment 评论</div>
  <div id="container" style="display:none"></div>
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script>
  const myTheme = {
    render(state, instance) {
      const container = document.createElement('div');
      container.lang = "en-US";
      container.className = 'gitment-container gitment-root-container';
      container.appendChild(instance.renderHeader(state, instance));
      container.appendChild(instance.renderEditor(state, instance));
      container.appendChild(instance.renderComments(state, instance));
      container.appendChild(instance.renderFooter(state, instance));
      return container;
    }
  }
  function showGitment() {
    $("#gitment_title").attr("style", "display:none");
    $("#container").attr("style", "").addClass("gitment_container");
    var gitment = new Gitment({
      id: window.location.pathname,
      theme: myTheme,
      owner: 'pangguoming',
      repo: 'pangguoming.github.io',
      oauth: {
        client_id: '1e9770fed2b4d227cd0a',
        client_secret: '51f66abac54ca9e1b5a5608d706ce6af47ffaa51'
      }
    });
    gitment.render('container');
  }
  </script>

  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4" alt="庞国明">
          
            <p class="site-author-name" itemprop="name">庞国明</p>
            <p class="site-description motion-element" itemprop="description">Software make the information world run, and programer make the softeware run.</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives">
            
                <span class="site-state-item-count">420</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">267</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/pangguoming" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>GitHub</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:pangguoming@yeah.net" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/pangguoming" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>Twitter</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://stackoverflow.com/users/1570700/pangguoming" target="_blank" title="StackOverflow">
                  
                    <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://instagram.com/pangguoming" target="_blank" title="Instagram">
                  
                    <i class="fa fa-fw fa-instagram"></i>Instagram</a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-优势"><span class="nav-number">1.</span> <span class="nav-text">Redis 优势</span></a></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#Redis-环境"><span class="nav-number"></span> <span class="nav-text">Redis - 环境</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">庞国明</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

</body>
</html>
