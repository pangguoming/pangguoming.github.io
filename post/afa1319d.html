<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="mybatis,spring boot,druid,mybatis-plus,">










<meta name="description" content="Spring boot对于我来说是一个刚接触的新东西，学习过程中，发现这东西还是很容易上手的，Spring boot没配置时会默认使用Spring data jpa，这东西可以说一个极简洁的工具，可是我还是比较喜欢用mybatis,工具是没有最好的，只有这合适自己的。 说到mybatis，最近有一个很好用的工具——–mybatis-Plus（官网）,现在更新的版本是2.1.2，这里使用的也是这个版">
<meta name="keywords" content="mybatis,spring boot,druid,mybatis-plus">
<meta property="og:type" content="article">
<meta property="og:title" content="spring boot整合mybatis+mybatis-plus">
<meta property="og:url" content="http://pangguoming.com/post/afa1319d.html">
<meta property="og:site_name" content="庞国明-博客">
<meta property="og:description" content="Spring boot对于我来说是一个刚接触的新东西，学习过程中，发现这东西还是很容易上手的，Spring boot没配置时会默认使用Spring data jpa，这东西可以说一个极简洁的工具，可是我还是比较喜欢用mybatis,工具是没有最好的，只有这合适自己的。 说到mybatis，最近有一个很好用的工具——–mybatis-Plus（官网）,现在更新的版本是2.1.2，这里使用的也是这个版">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://pangguoming.com/blog/images/d140a441-06bd-4d70-be2f-33e330c924c5.png">
<meta property="og:image" content="http://pangguoming.com/blog/images/7505a141-84e4-47eb-abea-412dd8f59efd.png">
<meta property="og:updated_time" content="2019-07-10T03:30:55.768Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="spring boot整合mybatis+mybatis-plus">
<meta name="twitter:description" content="Spring boot对于我来说是一个刚接触的新东西，学习过程中，发现这东西还是很容易上手的，Spring boot没配置时会默认使用Spring data jpa，这东西可以说一个极简洁的工具，可是我还是比较喜欢用mybatis,工具是没有最好的，只有这合适自己的。 说到mybatis，最近有一个很好用的工具——–mybatis-Plus（官网）,现在更新的版本是2.1.2，这里使用的也是这个版">
<meta name="twitter:image" content="http://pangguoming.com/blog/images/d140a441-06bd-4d70-be2f-33e330c924c5.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pangguoming.com/post/afa1319d.html">





  <title>spring boot整合mybatis+mybatis-plus | 庞国明-博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">庞国明-博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">此心用度八千遍，不曾厌倦</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pangguoming.com/post/afa1319d.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="庞国明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="庞国明-博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">spring boot整合mybatis+mybatis-plus</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-05T10:21:00+08:00">
                2017-12-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/post/afa1319d.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/post/afa1319d.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Spring boot对于我来说是一个刚接触的新东西，学习过程中，发现这东西还是很容易上手的，Spring boot没配置时会默认使用Spring data jpa，这东西可以说一个极简洁的工具，可是我还是比较喜欢用mybatis,工具是没有最好的，只有这合适自己的。</p>
<p>说到mybatis，最近有一个很好用的工具——–mybatis-Plus（<a href="http://baomidou.oschina.io/mybatis-plus-doc/#/" target="_blank" rel="noopener">官网</a>）,现在更新的版本是2.1.2，这里使用的也是这个版本。我比较喜欢的功能是代码生成器，条件构造器，这样就可以更容易的去开发了。</p>
<p>mybatisPlus官网上是有Spring boot整个的例子的，我也跟着它走了一篇，结果，程序没跑起来，后来才知道demo用的H2 database，和mysql根本不是同一样东西，所以各位想要整合mybatisPlus，可以不看官网的，可以少走弯路。</p>
<p><strong>下面就是整合的过程</strong></p>
<p>1、首先要把需要的jar文件都弄过来，pom.xml需要的东西如下</p>
<p>pom.xml(不完整)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- mybatis-plus begin --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatisplus-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.0.4&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.1.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!-- mybatis-plus end --&gt;  </span><br><span class="line"></span><br><span class="line">&lt;!-- druid阿里巴巴数据库连接池 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;druid&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.1.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>2、添加mybatis相关的配置，如账号、密码等。这里我使用了application.yml来配。</p>
<p>application.yml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">    port: 8080</span><br><span class="line"></span><br><span class="line">#spring</span><br><span class="line">spring:</span><br><span class="line">  devtools:</span><br><span class="line">    restart:</span><br><span class="line">      enabled: true     #这里是为了热部署的，与mybatis是无关的</span><br><span class="line"></span><br><span class="line">  #DATABASE CONFIG</span><br><span class="line">  datasource:</span><br><span class="line">    driver-class-name: com.mysql.jdbc.Driver</span><br><span class="line">    username: root</span><br><span class="line">    password: root</span><br><span class="line">    url: jdbc:mysql://mysqldb:3306/tdx_shop?useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">    type: com.alibaba.druid.pool.DruidDataSource   #这里是配置druid连接池，以下都是druid的配置信息</span><br><span class="line">    filters: stat,wall,log4j</span><br><span class="line">    maxActive: 20</span><br><span class="line">    initialSize: 1</span><br><span class="line">    maxWait: 60000</span><br><span class="line">    minIdle: 1</span><br><span class="line">    timeBetweenEvictionRunsMillis: 60000</span><br><span class="line">    minEvictableIdleTimeMillis: 300000</span><br><span class="line">    validationQuery: select &apos;x&apos;</span><br><span class="line">    testWhileIdle: true</span><br><span class="line">    testOnBorrow: false</span><br><span class="line">    testOnReturn: false</span><br><span class="line">    poolPreparedStatements: true</span><br><span class="line">    maxOpenPreparedStatements: 20</span><br><span class="line">    connection-properties: druid.stat.merggSql=ture;druid.stat.slowSqlMillis=5000</span><br><span class="line"></span><br><span class="line">#mybatis</span><br><span class="line">mybatis:</span><br><span class="line">  mapper-locations: classpath*:/mapper/**Mapper.xml   #把xml文件放在com.XX.mapper.*中可能会出现找到的问题，这里把他放在resource下的mapper中</span><br><span class="line">  #实体扫描，多个package用逗号或者分号分隔</span><br><span class="line">  typeAliasesPackage: com.tdx.account_service.entity  #这里是实体类的位置</span><br><span class="line">  configuration:</span><br><span class="line">    map-underscore-to-camel-case: true</span><br><span class="line">    cache-enabled: false</span><br><span class="line">#logging</span><br><span class="line">logging:</span><br><span class="line">  level: warn</span><br></pre></td></tr></table></figure>
<p>配置的东西和我们以前用mybatis配置可以说差不多，但spring boot是没有xml配置文件的。注意一下红字的内容，基本没问题了。</p>
<p>3、mybatis-Plus配置文件——MybatisPlusConfig，首先上图说明一下文件路径。其中MybatisPlusConfig是放在config文件夹内，而xml文件是放在resouces下mapper中。</p>
<p><img src="http://pangguoming.com/blog/images/d140a441-06bd-4d70-be2f-33e330c924c5.png" alt=""></p>
<p>接着就是MybatisPlusConfig内容部分了</p>
<div><br><div id="highlighter_162249" class="syntaxhighlighter  java"><br><table border="0" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td class="gutter"><br><div class="line number1 index0 alt2">1<br></div></td><br><td class="code"><br><div class="container"><br><div class="line number1 index0 alt2"><code class="java plain">MybatisProperties.java</code><br><br></div></div></td><br></tr><br></tbody><br></table><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line">package com.tdx.account_service.config;</span><br><span class="line"></span><br><span class="line">import com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line">import com.alibaba.druid.support.http.StatViewServlet;</span><br><span class="line">import com.alibaba.druid.support.http.WebStatFilter;</span><br><span class="line">import com.baomidou.mybatisplus.MybatisConfiguration;</span><br><span class="line">import com.baomidou.mybatisplus.MybatisXMLLanguageDriver;</span><br><span class="line">import com.baomidou.mybatisplus.entity.GlobalConfiguration;</span><br><span class="line">import com.baomidou.mybatisplus.enums.DBType;</span><br><span class="line">import com.baomidou.mybatisplus.plugins.PaginationInterceptor;</span><br><span class="line">import com.baomidou.mybatisplus.plugins.PerformanceInterceptor;</span><br><span class="line">import com.baomidou.mybatisplus.plugins.parser.ISqlParser;</span><br><span class="line">import com.baomidou.mybatisplus.plugins.parser.ISqlParserFilter;</span><br><span class="line">import com.baomidou.mybatisplus.plugins.parser.tenant.TenantHandler;</span><br><span class="line">import com.baomidou.mybatisplus.plugins.parser.tenant.TenantSqlParser;</span><br><span class="line">import com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean;</span><br><span class="line">import com.baomidou.mybatisplus.spring.boot.starter.SpringBootVFS;</span><br><span class="line">import com.baomidou.mybatisplus.toolkit.PluginUtils;</span><br><span class="line">import net.sf.jsqlparser.expression.Expression;</span><br><span class="line">import net.sf.jsqlparser.expression.LongValue;</span><br><span class="line">import org.apache.ibatis.mapping.DatabaseIdProvider;</span><br><span class="line">import org.apache.ibatis.mapping.MappedStatement;</span><br><span class="line">import org.apache.ibatis.plugin.Interceptor;</span><br><span class="line">import org.apache.ibatis.reflection.MetaObject;</span><br><span class="line">import org.mybatis.spring.annotation.MapperScan;</span><br><span class="line">import org.mybatis.spring.boot.autoconfigure.MybatisProperties;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.boot.bind.RelaxedPropertyResolver;</span><br><span class="line">import org.springframework.boot.context.properties.EnableConfigurationProperties;</span><br><span class="line">import org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line">import org.springframework.boot.web.servlet.ServletRegistrationBean;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.core.env.Environment;</span><br><span class="line">import org.springframework.core.io.DefaultResourceLoader;</span><br><span class="line">import org.springframework.core.io.ResourceLoader;</span><br><span class="line">import org.springframework.util.ObjectUtils;</span><br><span class="line">import org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line">import javax.sql.DataSource;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * code is far away from bug with the animal protecting</span><br><span class="line"> * ┏┓　　　┏┓</span><br><span class="line"> * ┏┛┻━━━┛┻┓</span><br><span class="line"> * ┃　　　　　　　┃</span><br><span class="line"> * ┃　　　━　　　┃</span><br><span class="line"> * ┃　┳┛　┗┳　┃</span><br><span class="line"> * ┃　　　　　　　┃</span><br><span class="line"> * ┃　　　┻　　　┃</span><br><span class="line"> * ┃　　　　　　　┃</span><br><span class="line"> * ┗━┓　　　┏━┛</span><br><span class="line"> * 　　┃　　　┃神兽保佑</span><br><span class="line"> * 　　┃　　　┃代码无BUG！</span><br><span class="line"> * 　　┃　　　┗━━━┓</span><br><span class="line"> * 　　┃　　　　　　　┣┓</span><br><span class="line"> * 　　┃　　　　　　　┏┛</span><br><span class="line"> * 　　┗┓┓┏━┳┓┏┛</span><br><span class="line"> * 　　　┃┫┫　┃┫┫</span><br><span class="line"> * 　　　┗┻┛　┗┻┛</span><br><span class="line"> *</span><br><span class="line"> *</span><br><span class="line"> * @Description : MybatisPlus配置</span><br><span class="line"> * ---------------------------------</span><br><span class="line"> * @Author : Liang.Guangqing</span><br><span class="line"> * @Date : Create in 2017/9/19 13:54</span><br><span class="line"> */</span><br><span class="line">@Configuration</span><br><span class="line">@EnableConfigurationProperties(MybatisProperties.class)</span><br><span class="line">public class MybatisPlusConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private Environment environment;</span><br><span class="line">    private RelaxedPropertyResolver propertyResolver;</span><br><span class="line">    @Autowired</span><br><span class="line">    private DataSource dataSource;</span><br><span class="line">    @Autowired</span><br><span class="line">    private MybatisProperties properties;</span><br><span class="line">    @Autowired</span><br><span class="line">    private ResourceLoader resourceLoader = new DefaultResourceLoader();</span><br><span class="line">    @Autowired(required = false)</span><br><span class="line">    private Interceptor[] interceptors;</span><br><span class="line">    @Autowired(required = false)</span><br><span class="line">    private DatabaseIdProvider databaseIdProvider;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @Description : mybatis-plus SQL执行效率插件【生产环境可以关闭】</span><br><span class="line">     * ---------------------------------</span><br><span class="line">     * @Author : Liang.Guangqing</span><br><span class="line">     * @Date : Create in 2017/9/19 13:57</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public PerformanceInterceptor performanceInterceptor() &#123;</span><br><span class="line">        return new PerformanceInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 配置DataSource</span><br><span class="line">     * @return</span><br><span class="line">     * @throws SQLException</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public DataSource druidDataSource() throws SQLException &#123;</span><br><span class="line">        this.propertyResolver = new RelaxedPropertyResolver(environment, &quot;spring.datasource.&quot;);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;====================注入druid!====================&quot;);</span><br><span class="line">        DruidDataSource datasource = new DruidDataSource();</span><br><span class="line">        datasource.setUrl(propertyResolver.getProperty(&quot;url&quot;));</span><br><span class="line">        datasource.setDriverClassName(propertyResolver.getProperty(&quot;driver-class-name&quot;));</span><br><span class="line">        datasource.setUsername(propertyResolver.getProperty(&quot;username&quot;));</span><br><span class="line">        datasource.setPassword(propertyResolver.getProperty(&quot;password&quot;));</span><br><span class="line">        datasource.setInitialSize(Integer.valueOf(propertyResolver.getProperty(&quot;initial-size&quot;)));</span><br><span class="line">        datasource.setMinIdle(Integer.valueOf(propertyResolver.getProperty(&quot;min-idle&quot;)));</span><br><span class="line">        datasource.setMaxWait(Long.valueOf(propertyResolver.getProperty(&quot;max-wait&quot;)));</span><br><span class="line">        datasource.setMaxActive(Integer.valueOf(propertyResolver.getProperty(&quot;max-active&quot;)));</span><br><span class="line">        datasource.setMinEvictableIdleTimeMillis(Long.valueOf(propertyResolver.getProperty(&quot;min-evictable-idle-time-millis&quot;)));</span><br><span class="line">        try &#123;</span><br><span class="line">            datasource.setFilters(propertyResolver.getProperty(&quot;filters&quot;));</span><br><span class="line">        &#125; catch (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return datasource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @Description : mybatis-plus分页插件</span><br><span class="line">     * ---------------------------------</span><br><span class="line">     * @Author : Liang.Guangqing</span><br><span class="line">     * @Date : Create in 2017/9/19 13:59</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public PaginationInterceptor paginationInterceptor() &#123;</span><br><span class="line">        PaginationInterceptor page = new PaginationInterceptor();</span><br><span class="line">        page.setDialectType(&quot;mysql&quot;);</span><br><span class="line">        return page;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 这里全部使用mybatis-autoconfigure 已经自动加载的资源。不手动指定</span><br><span class="line">     * 配置文件和mybatis-boot的配置文件同步</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public MybatisSqlSessionFactoryBean mybatisSqlSessionFactoryBean() &#123;</span><br><span class="line">        MybatisSqlSessionFactoryBean mybatisPlus = new MybatisSqlSessionFactoryBean();</span><br><span class="line">        mybatisPlus.setDataSource(dataSource);</span><br><span class="line">        mybatisPlus.setVfs(SpringBootVFS.class);</span><br><span class="line">        if (StringUtils.hasText(this.properties.getConfigLocation())) &#123;</span><br><span class="line">            mybatisPlus.setConfigLocation(this.resourceLoader.getResource(this.properties.getConfigLocation()));</span><br><span class="line">        &#125;</span><br><span class="line">        mybatisPlus.setConfiguration(properties.getConfiguration());</span><br><span class="line">        if (!ObjectUtils.isEmpty(this.interceptors)) &#123;</span><br><span class="line">            mybatisPlus.setPlugins(this.interceptors);</span><br><span class="line">        &#125;</span><br><span class="line">        // MP 全局配置，更多内容进入类看注释</span><br><span class="line">        GlobalConfiguration globalConfig = new GlobalConfiguration();</span><br><span class="line">        globalConfig.setDbType(DBType.MYSQL.name());</span><br><span class="line">        // ID 策略 AUTO-&gt;`0`(&quot;数据库ID自增&quot;) INPUT-&gt;`1`(用户输入ID&quot;) ID_WORKER-&gt;`2`(&quot;全局唯一ID&quot;) UUID-&gt;`3`(&quot;全局唯一ID&quot;)</span><br><span class="line">        globalConfig.setIdType(2);</span><br><span class="line">        mybatisPlus.setGlobalConfig(globalConfig);</span><br><span class="line">        MybatisConfiguration mc = new MybatisConfiguration();</span><br><span class="line">        mc.setDefaultScriptingLanguage(MybatisXMLLanguageDriver.class);</span><br><span class="line">        mybatisPlus.setConfiguration(mc);</span><br><span class="line">        if (this.databaseIdProvider != null) &#123;</span><br><span class="line">            mybatisPlus.setDatabaseIdProvider(this.databaseIdProvider);</span><br><span class="line">        &#125;</span><br><span class="line">        if (StringUtils.hasLength(this.properties.getTypeAliasesPackage())) &#123;</span><br><span class="line">            mybatisPlus.setTypeAliasesPackage(this.properties.getTypeAliasesPackage());</span><br><span class="line">        &#125;</span><br><span class="line">        if (StringUtils.hasLength(this.properties.getTypeHandlersPackage())) &#123;</span><br><span class="line">            mybatisPlus.setTypeHandlersPackage(this.properties.getTypeHandlersPackage());</span><br><span class="line">        &#125;</span><br><span class="line">        if (!ObjectUtils.isEmpty(this.properties.resolveMapperLocations())) &#123;</span><br><span class="line">            mybatisPlus.setMapperLocations(this.properties.resolveMapperLocations());</span><br><span class="line">        &#125;</span><br><span class="line">        return mybatisPlus;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 注册一个StatViewServlet</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public ServletRegistrationBean DruidStatViewServle()&#123;</span><br><span class="line">        //org.springframework.boot.context.embedded.ServletRegistrationBean提供类的进行注册.</span><br><span class="line">        ServletRegistrationBean servletRegistrationBean = new ServletRegistrationBean(new StatViewServlet(),&quot;/druid/*&quot;);</span><br><span class="line">        //添加初始化参数：initParams</span><br><span class="line">        //白名单：</span><br><span class="line">        // servletRegistrationBean.addInitParameter(&quot;allow&quot;,&quot;127.0.0.1&quot;);</span><br><span class="line">        //IP黑名单 (存在共同时，deny优先于allow) : 如果满足deny的话提示:Sorry, you are not permitted to view this page.</span><br><span class="line">        // servletRegistrationBean.addInitParameter(&quot;deny&quot;,&quot;192.168.1.73&quot;);</span><br><span class="line">        //登录查看信息的账号密码.</span><br><span class="line">        servletRegistrationBean.addInitParameter(&quot;loginUsername&quot;,&quot;root&quot;);</span><br><span class="line">        servletRegistrationBean.addInitParameter(&quot;loginPassword&quot;,&quot;root&quot;);</span><br><span class="line">        //是否能够重置数据.</span><br><span class="line">        servletRegistrationBean.addInitParameter(&quot;resetEnable&quot;,&quot;false&quot;);</span><br><span class="line">        return servletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 注册一个：filterRegistrationBean</span><br><span class="line">     *</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public FilterRegistrationBean druidStatFilter()&#123;</span><br><span class="line">        FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean(new WebStatFilter());</span><br><span class="line">        //添加过滤规则.</span><br><span class="line">        filterRegistrationBean.addUrlPatterns(&quot;/*&quot;);</span><br><span class="line">        //添加不需要忽略的格式信息.</span><br><span class="line">        filterRegistrationBean.addInitParameter(&quot;exclusions&quot;,&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&quot;);</span><br><span class="line">        return filterRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>这里是完整的配置文件，需要注意的是引入的包，别引错了！<br><br>4、还要开启dao的扫描，很简单，就是在启动文件中添加@MapperScan(“com.tdx.account_service.dao<em>“)，如下是完整的<br><br><img src="http://pangguoming.com/blog/images/7505a141-84e4-47eb-abea-412dd8f59efd.png" alt=""><br><br>到这里，配置算是完成了，运行一下项目是可以运行起来的。<br><br>我觉得Mybatis-Plus最好玩得应该是代码生成器这部分内容，下面是<strong>代码生成器的使用过程</strong><br><br>pom.xml上要加点东西<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><br><br>1、代码生成器的配置文件<br><br>MybatisPlusConfig.java<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><br><br>    /**
     </em> Copyright (c) 2011-2016, hubin (<a href="mailto:jobob@qq.com" target="_blank" rel="noopener">jobob@qq.com</a>).<br>     <em> <p>
     </p></em> Licensed under the Apache License, Version 2.0 (the “License”); you may not<br>     <em> use this file except in compliance with the License. You may obtain a copy of
     </em> the License at<br>     <em> <p>
     </p></em> <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener">http://www.apache.org/licenses/LICENSE-2.0</a><br>     <em> <p>
     </p></em> Unless required by applicable law or agreed to in writing, software<br>     <em> distributed under the License is distributed on an “AS IS” BASIS, WITHOUT
     </em> WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the<br>     <em> License for the specific language governing permissions and limitations under
     </em> the License.<br>     <em>/<br>    package com.tdx.account_service.generator;<br><br>    import java.io.File;<br>    import java.util.ArrayList;<br>    import java.util.Collections;<br>    import java.util.HashMap;<br>    import java.util.List;<br>    import java.util.Map;<br><br>    import com.baomidou.mybatisplus.enums.FieldFill;<br>    import com.baomidou.mybatisplus.generator.AutoGenerator;<br>    import com.baomidou.mybatisplus.generator.InjectionConfig;<br>    import com.baomidou.mybatisplus.generator.config.DataSourceConfig;<br>    import com.baomidou.mybatisplus.generator.config.FileOutConfig;<br>    import com.baomidou.mybatisplus.generator.config.GlobalConfig;<br>    import com.baomidou.mybatisplus.generator.config.PackageConfig;<br>    import com.baomidou.mybatisplus.generator.config.StrategyConfig;<br>    import com.baomidou.mybatisplus.generator.config.TemplateConfig;<br>    import com.baomidou.mybatisplus.generator.config.converts.MySqlTypeConvert;<br>    import com.baomidou.mybatisplus.generator.config.po.TableFill;<br>    import com.baomidou.mybatisplus.generator.config.po.TableInfo;<br>    import com.baomidou.mybatisplus.generator.config.rules.DbColumnType;<br>    import com.baomidou.mybatisplus.generator.config.rules.DbType;<br>    import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;<br><br>    /**
     </em>code is far away from bug with the animal protecting<br>     <em>  ┏┓　　　┏┓
     </em>┏┛┻━━━┛┻┓<br>     <em>┃　　　　　　　┃ 　
     </em>┃　　　━　　　┃<br>     <em>┃　┳┛　┗┳　┃
     </em>┃　　　　　　　┃<br>     <em>┃　　　┻　　　┃
     </em>┃　　　　　　　┃<br>     <em>┗━┓　　　┏━┛
     </em>　　┃　　　┃神兽保佑<br>     <em>　　┃　　　┃代码无BUG！
     </em>　　┃　　　┗━━━┓<br>     <em>　　┃　　　　　　　┣┓
     </em>　　┃　　　　　　　┏┛<br>     <em>　　┗┓┓┏━┳┓┏┛
     </em>　　　┃┫┫　┃┫┫<br>     <em>　　　┗┻┛　┗┻┛
     </em>　　<br>     <em>   @Description : MybatisPlus代码生成器
     </em>   ———————————<br>     <em>   @Author : Liang.Guangqing
     </em>   @Date : Create in 2017/9/19 14:48　<br>     <em>/<br>    public class MysqlGenerator {<br><br>        private static String packageName=”account_service”;    //文件路径<br>        private static String authorName=”Liang.Guangqing”;     //作者<br>        private static String table=”sc_user”;                  //table名字<br>        private static String prefix=”sc_”;                     //table前缀<br>        private static File file = new File(packageName);<br>        private static String path = file.getAbsolutePath();<br><br>        public static void main(String[] args) {<br>            // 自定义需要填充的字段<br>            List<tablefill> tableFillList = new ArrayList&lt;&gt;();<br>            tableFillList.add(new TableFill(“ASDD_SS”, FieldFill.INSERT_UPDATE));<br>            // 代码生成器<br>            AutoGenerator mpg = new AutoGenerator().setGlobalConfig(<br>                    // 全局配置<br>                    new GlobalConfig()<br>                            .setOutputDir(path+”/src/main/java”)//输出目录<br>                            .setFileOverride(true)// 是否覆盖文件<br>                            .setActiveRecord(true)// 开启 activeRecord 模式<br>                            .setEnableCache(false)// XML 二级缓存<br>                            .setBaseResultMap(true)// XML ResultMap<br>                            .setBaseColumnList(true)// XML columList<br>                            .setOpen(false)//生成后打开文件夹<br>                            .setAuthor(authorName)<br>                    // 自定义文件命名，注意 %s 会自动填充表实体属性！<br>                     .setMapperName(“%sMapper”)<br>                     .setXmlName(“%sMapper”)<br>                     .setServiceName(“%sService”)<br>                     .setServiceImplName(“%sServiceImpl”)<br>                     .setControllerName(“%sController”)<br>            ).setDataSource(<br>                    // 数据源配置<br>                    new DataSourceConfig()<br>                            .setDbType(DbType.MYSQL)// 数据库类型<br>                            .setTypeConvert(new MySqlTypeConvert() {<br>                                // 自定义数据库表字段类型转换【可选】<br>                                @Override<br>                                public DbColumnType processTypeConvert(String fieldType) {<br>                                    System.out.println(“转换类型：” + fieldType);<br>                                    // if ( fieldType.toLowerCase().contains( “tinyint” ) ) {<br>                                    //    return DbColumnType.BOOLEAN;<br>                                    // }<br>                                    return super.processTypeConvert(fieldType);<br>                                }<br>                            })<br>                            .setDriverName(“com.mysql.jdbc.Driver”)<br>                            .setUsername(“root”)<br>                            .setPassword(“root”)<br>                            .setUrl(“jdbc:mysql://127.0.0.1:3306/tdx_shop?characterEncoding=utf8”)<br>            ).setStrategy(<br>                    // 策略配置<br>                    new StrategyConfig()<br>                            // .setCapitalMode(true)// 全局大写命名<br>                            //.setDbColumnUnderline(true)//全局下划线命名<br>                            .setTablePrefix(new String[]{prefix})// 此处可以修改为您的表前缀<br>                            .setNaming(NamingStrategy.underline_to_camel)// 表名生成策略<br>                            .setInclude(new String[] { table }) // 需要生成的表<br>                            .setRestControllerStyle(true)<br>                            //.setExclude(new String[]{“test”}) // 排除生成的表<br>                            // 自定义实体父类<br>                            // .setSuperEntityClass(“com.baomidou.demo.TestEntity”)<br>                            // 自定义实体，公共字段<br>                            //.setSuperEntityColumns(new String[]{“test_id”})<br>                            .setTableFillList(tableFillList)<br>                    // 自定义 mapper 父类<br>                    // .setSuperMapperClass(“com.baomidou.demo.TestMapper”)<br>                    // 自定义 service 父类<br>                    // .setSuperServiceClass(“com.baomidou.demo.TestService”)<br>                    // 自定义 service 实现类父类<br>                    // .setSuperServiceImplClass(“com.baomidou.demo.TestServiceImpl”)<br>                    // 自定义 controller 父类<br>                    .setSuperControllerClass(“com.tdx.”+packageName+”.controller.AbstractController”)<br>                    // 【实体】是否生成字段常量（默认 false）<br>                    // public static final String ID = “test_id”;<br>                    // .setEntityColumnConstant(true)<br>                    // 【实体】是否为构建者模型（默认 false）<br>                    // public User setName(String name) {this.name = name; return this;}<br>                    // .setEntityBuilderModel(true)<br>                    // 【实体】是否为lombok模型（默认 false）<a href="https://projectlombok.org/" target="_blank" rel="noopener">document</a><br>                    // .setEntityLombokModel(true)<br>                    // Boolean类型字段是否移除is前缀处理<br>                    // .setEntityBooleanColumnRemoveIsPrefix(true)<br>                    // .setRestControllerStyle(true)<br>                    // .setControllerMappingHyphenStyle(true)<br>            ).setPackageInfo(<br>                    // 包配置<br>                    new PackageConfig()<br>                            //.setModuleName(“User”)<br>                            .setParent(“com.tdx.”+packageName)// 自定义包路径<br>                            .setController(“controller”)// 这里是控制器包名，默认 web<br>                            .setEntity(“entity”)<br>                            .setMapper(“dao”)<br>                            .setService(“service”)<br>                            .setServiceImpl(“service.impl”)<br>                            //.setXml(“mapper”)<br>            ).setCfg(<br>                    // 注入自定义配置，可以在 VM 中使用 cfg.abc 设置的值<br>                    new InjectionConfig() {<br>                        @Override<br>                        public void initMap() {<br>                            Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();<br>                            map.put(“abc”, this.getConfig().getGlobalConfig().getAuthor() + “-mp”);<br>                            this.setMap(map);<br>                        }<br>                    }.setFileOutConfigList(Collections.<fileoutconfig>singletonList(new FileOutConfig(“/templates/mapper.xml.vm”) {<br>                        // 自定义输出文件目录<br>                        @Override<br>                        public String outputFile(TableInfo tableInfo) {<br>                            return path+”/src/main/resources/mapper/“ + tableInfo.getEntityName() + “Mapper.xml”;<br>                        }<br>                    }))<br>            ).setTemplate(<br>                    // 关闭默认 xml 生成，调整生成 至 根目录<br>                    new TemplateConfig().setXml(null)<br>                    // 自定义模板配置，模板可以参考源码 /mybatis-plus/src/main/resources/template 使用 copy<br>                    // 至您项目 src/main/resources/template 目录下，模板名称也可自定义如下配置：<br>                    // .setController(“…”);<br>                    // .setEntity(“…”);<br>                    // .setMapper(“…”);<br>                    // .setXml(“…”);<br>                    // .setService(“…”);<br>                    // .setServiceImpl(“…”);<br>            );<br><br>            // 执行生成<br>            mpg.execute();<br><br>            // 打印注入设置，这里演示模板里面怎么获取注入内容【可无】<br>            System.err.println(mpg.getCfg().getMap().get(“abc”));<br>        }<br><br>    }<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">文件中修改的内容还是很多的，最主要的还是mysql的连接信息，没理由你账号，密码都错了还能连得上吧，其次设置一下你生成的模板文件路径，我这里生成的路径在上面图可以看得到，是在com.tdx.account_service下的，注意，xml文件要放在resources下，不然是识别的，说找不到这个方法</span><br><span class="line"></span><br><span class="line">按照官网的代码模板生成的文件基本是白白的，主要是mybatis-Plus集成了公共方法，很多常用的工具都可以引用了。在这里我提供一下我修改后Controller.java.vm文件，主要还是按照我自己的习惯去弄的</span><br><span class="line"></span><br><span class="line">controller.java.vm</span><br></pre></td></tr></table></figure><br><br>    package ${package.Controller};<br><br>    import org.springframework.web.bind.annotation.RequestMapping;<br>    import org.springframework.web.bind.annotation.RequestParam;<br><br>    #if(${restControllerStyle})<br>    import org.springframework.web.bind.annotation.RequestMethod;<br>    import org.springframework.web.bind.annotation.RestController;<br>    #else<br>    import org.springframework.stereotype.Controller;<br>    #end<br>    #if(${superControllerClassPackage})<br>    import ${superControllerClassPackage};<br>    #end<br>    import org.springframework.beans.factory.annotation.Autowired;<br>    import com.baomidou.mybatisplus.mapper.EntityWrapper;<br>    import com.baomidou.mybatisplus.plugins.Page;<br>    import ${package.Service}.${table.serviceName};<br>    import ${package.Entity}.common.DatatablesJSON;<br>    import ${package.Entity}.common.JSONResult;<br>    import ${package.Entity}.${entity};<br>    import org.slf4j.Logger;<br>    import org.slf4j.LoggerFactory;<br><br>    /**
     </fileoutconfig></tablefill></em>code is far away from bug with the animal protecting<br>     <em>  ┏┓　　　┏┓
     </em>┏┛┻━━━┛┻┓<br>     <em>┃　　　　　　　┃ 　
     </em>┃　　　━　　　┃<br>     <em>┃　┳┛　┗┳　┃
     </em>┃　　　　　　　┃<br>     <em>┃　　　┻　　　┃
     </em>┃　　　　　　　┃<br>     <em>┗━┓　　　┏━┛
     </em>　　┃　　　┃神兽保佑<br>     <em>　　┃　　　┃代码无BUG！
     </em>　　┃　　　┗━━━┓<br>     <em>　　┃　　　　　　　┣┓
     </em>　　┃　　　　　　　┏┛<br>     <em>　　┗┓┓┏━┳┓┏┛
     </em>　　　┃┫┫　┃┫┫<br>     <em>　　　┗┻┛　┗┻┛
     </em>　　<br>     <em>   @description : ${entity} 控制器
     </em>   ———————————<br>     <em>      @author ${author}
     </em>   @since ${date}<br>     <em>/<br>    #if(${restControllerStyle})<br>    @RestController<br>    #else<br>    @Controller<br>    #end<br>    @RequestMapping(“#if(${package.ModuleName})/${package.ModuleName}#end/#if(${controllerMappingHyphenStyle})${controllerMappingHyphen}#else${table.entityPath}#end”)<br>    #if(${superControllerClass})<br>    public class ${table.controllerName} extends ${superControllerClass} {<br>    #else<br>    public class ${table.controllerName} {<br>    #end<br>        private final Logger logger = LoggerFactory.getLogger(${table.controllerName}.class);<br><br>        @Autowired<br>        public ${table.serviceName} ${table.entityPath}Service;<br><br>        /**
         </em> @description : 获取分页列表<br>         <em> ———————————
         </em> @author : ${author}<br>         <em> @since : Create in ${date}
         </em>/<br>        @RequestMapping(value = “/get${entity}List”,method = RequestMethod.POST)<br>        public Object get${entity}List(${entity} param , @RequestParam(value = “draw”,defaultValue = “0”) Integer draw,<br>                                            @RequestParam(value = “length”) Integer length,<br>                                            @RequestParam(value = “start”) Integer start) {<br>                DatatablesJSON&lt;${entity}&gt; resJson=new DatatablesJSON&lt;&gt;();<br>                try {<br>                    Integer pageNo=getPageNo(start,length);<br>                    Page&lt;${entity}&gt; page=new Page&lt;${entity}&gt;(pageNo,length);<br>                    ${table.entityPath}Service.selectPage(page,new EntityWrapper&lt;${entity}&gt;(param));<br>                    resJson.setDraw(draw++);<br>                    resJson.setRecordsTotal(page.getTotal());<br>                    resJson.setRecordsFiltered(page.getTotal());<br>                    resJson.setData(page.getRecords());<br>                    resJson.setSuccess(true);<br>                }catch (Exception e){<br>                    resJson.setSuccess(false);<br>                    resJson.setError(“异常信息:{“+e.getClass().getName()+”}”);<br>                    logger.info(“异常信息:{}”+e.getMessage());<br>                }<br>                return resJson;<br>        }<br><br>        /<strong><br>         <em> @description : 通过id获取${entity}
         </em> ———————————<br>         <em> @author : ${author}
         </em> @since : Create in ${date}<br>         */<br>        @RequestMapping(value = “/get${entity}ById”,method = RequestMethod.GET)<br>        public Object get${entity}ById(String id) {<br>                JSONResult&lt;${entity}&gt; resJson = new JSONResult&lt;&gt;();<br>                try {<br>                    ${entity} param= ${table.entityPath}Service.selectById(id);<br>                    resJson.setData(param);<br>                    resJson.setSuccess(true);<br>                }catch (Exception e) {<br>                    resJson.setSuccess(false);<br>                    resJson.setMessage(“异常信息:{“+e.getClass().getName()+”}”);<br>                    logger.info(“异常信息:{}”+e.getMessage());<br>                }<br>                return resJson;<br>        }<br><br>        /</strong><br>         <em> @description : 通过id删除${entity}
         </em> ———————————<br>         <em> @author : ${author}
         </em> @since : Create in ${date}<br>         <em>/<br>        @RequestMapping(value = “/delete${entity}ById”,method = RequestMethod.GET)<br>        public Object delete${entity}ById(String id) {<br>                JSONResult&lt;${entity}&gt; resJson = new JSONResult&lt;&gt;();<br>                try{<br>                    resJson.setSuccess(${table.entityPath}Service.deleteById(id));<br>                }catch (Exception e) {<br>                    resJson.setSuccess(false);<br>                    resJson.setMessage(“异常信息:{“+e.getClass().getName()+”}”);<br>                    logger.info(“异常信息:{}”+e.getMessage());<br>                }<br>                return resJson;<br>        }<br><br>        /**
         </em> @description : 通过id更新${entity}<br>         <em> ———————————
         </em> @author : ${author}<br>         <em> @since : Create in ${date}
         </em>/<br>        @RequestMapping(value = “/update${entity}ById”,method = RequestMethod.POST)<br>        public Object update${entity}ById(${entity} param) {<br>                JSONResult&lt;${entity}&gt; resJson = new JSONResult&lt;&gt;();<br>                try{<br>                    resJson.setSuccess(${table.entityPath}Service.updateById(param));<br>                }catch (Exception e) {<br>                    resJson.setSuccess(false);<br>                    resJson.setMessage(“异常信息:{“+e.getClass().getName()+”}”);<br>                    logger.info(“异常信息:{}”+e.getMessage());<br>                }<br>                return resJson;<br>        }<br><br>        /<strong><br>         <em> @description : 添加${entity}
         </em> ———————————<br>         <em> @author : ${author}
         </em> @since : Create in ${date}<br>         */<br>        @RequestMapping(value = “/add${entity}”,method = RequestMethod.POST)<br>        public Object add${entity}(${entity} param) {<br>                JSONResult&lt;${entity}&gt; resJson = new JSONResult&lt;&gt;();<br>                try{<br>                    resJson.setSuccess(${table.entityPath}Service.insert(param));<br>                }catch (Exception e) {<br>                    resJson.setSuccess(false);<br>                    resJson.setMessage(“异常信息:{“+e.getClass().getName()+”}”);<br>                    logger.info(“异常信息:{}”+e.getMessage());<br>                }<br>                return resJson;<br>        }<br>    }<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">除了这个文件，其他代码模板我都是按照官网那样的，这里引用3个外部的文件，有AbstractController.java（控制器基类）、DatatablesJSON.java和JSONResult.java，然后这些文件又引用了其他文件，我懵逼了，怎么文件这么多啊，看来如果全部都贴上来得多占地方啊，所以我选择相信码云，如果需要请在码云上按照少的文件下载，[码云地址](https://gitee.com/lgqBlog/common)。需要注意的是，我的模板是直接代替了mybatis-plus.jar中的templates目录。</span><br><span class="line"></span><br><span class="line">**最后就到了测试过程**</span><br><span class="line"></span><br><span class="line">下面的代码段都是放在Controller文件里面，然后启动程序，对应端口，请求方法。测试的话是需要按照自己的实体类操作的，所以仅供参考。</span><br></pre></td></tr></table></figure><br><br>        /</strong><br>         <em> 分页 PAGE
         </em>/<br>        @GetMapping(“/test”)<br>        public Page<user> test() {<br>            return userService.selectPage(new Page<user>(0, 12));<br>        }<br><br>        /<strong><br>         <em> AR 部分测试
         </em>/<br>        @GetMapping(“/test1”)<br>        public Page<user> test1() {<br>            User user = new User();<br>            System.err.println(“删除所有：” + user.delete(null));<br>            //user.setId(2017091801L);<br>            user.setAccout(“test”+num++);<br>            user.setType(“test”);<br>            user.setCreateTime(new Date());<br>            user.setPhone(“13111110000”);<br>            user.setPassword(“123456”);<br>            user.setNickname(“guangqing”+2*num++);<br>            user.insert();<br>            System.err.println(“查询插入结果：” + user.selectById().toString());<br>            //user.setNickname(“mybatis-plus-ar”);<br>            System.err.println(“更新：” + user.updateById());<br>            return user.selectPage(new Page<user>(0, 12), null);<br>        }<br><br>        /</user></user></strong><br>         <em> 增删改查 CRUD
         </em>/<br>        @GetMapping(“/test2”)<br>        public User test2() {<br>            User user = new User();<br>            user.setId(123456L);<br>            user.setAccout(“test”);<br>            user.setType(“test”);<br>            user.setCreateTime(new Date());<br>            user.setPhone(“13111110000”);<br>            user.setPassword(“123456”);<br>            user.setNickname(“guangqing”);<br>            System.err.println(“删除一条数据：” + userService.deleteById(1L));<br>            System.err.println(“插入一条数据：” + userService.insert(user));<br>            User user2 = new User();<br>            user.setId(223456L);<br>            user.setAccout(“test2”);<br>            user.setType(“test”);<br>            user.setCreateTime(new Date());<br>            user.setPhone(“13111110000”);<br>            user.setPassword(“123456”);<br>            user.setNickname(“guangqing”);<br>            boolean result = userService.insert(user);<br>            // 自动回写的ID<br>            Long id = user.getId();<br>            System.err.println(“插入一条数据：” + result + “, 插入信息：” + user.toString());<br>            System.err.println(“查询：” + userService.selectById(id).toString());<br>            Page<user> userListPage = userService.selectPage(new Page<user>(1, 5), new EntityWrapper&lt;&gt;(new User()));<br>            System.err.println(“total=” + userListPage.getTotal() + “, current list size=” + userListPage.getRecords().size());<br>            return userService.selectById(1L);<br>        }<br><br>        @GetMapping(“testSelect”)<br>        public Object testSelect() {<br>            Integer start = 0;<br>            Integer length =10;<br>            User param = new User();<br>            //param.setNickname(“guangqing2”);<br>            Integer pageNo=getPageNo(start,length);<br>            Page<user> page =new Page<user>(pageNo,length);<br>            EntityWrapper<user> ew = new EntityWrapper<user>();<br>            ew.setEntity(param);<br>            ew.where(“password={0}”,”123456”)<br>                    .like(“nickname”,”guangqing”)<br>                    .ge(“create_time”,”2017-09-21 15:50:00”);<br>            userService.selectPage(page, ew);<br>            DatatablesJSON<user> resJson= new DatatablesJSON&lt;&gt;();<br>            //resJson.setDraw(draw++);<br>            resJson.setRecordsTotal(page.getTotal());<br>            resJson.setRecordsFiltered(page.getTotal());<br>            resJson.setData(page.getRecords());<br>            return resJson;<br>        }<br><br>        @GetMapping(“/selectsql”)<br>        public Object getUserBySql() {<br>            JSONObject result = new JSONObject();<br>            result.put(“records”, userService.selectListBySQL());<br>            return result;<br>        }<br><br>        /<strong><br>         <em> 7、分页 size 一页显示数量  current 当前页码
         </em> 方式一：<a href="http://localhost:8080/user/page?size=1&amp;current=1" target="_blank" rel="noopener">http://localhost:8080/user/page?size=1&amp;current=1</a><br><br>         <em> 方式二：<a href="http://localhost:8080/user/pagehelper?size=1&amp;current=1" target="_blank" rel="noopener">http://localhost:8080/user/pagehelper?size=1&amp;current=1</a><br>
         </em>/<br><br>        // 参数模式分页<br>        @GetMapping(“/page”)<br>        public Object page(Page page) {<br>            return userService.selectPage(page);<br>        }<br><br>        // ThreadLocal 模式分页<br>        @GetMapping(“/pagehelper”)<br>        public Object pagehelper(Page page) {<br>            PageHelper.setPagination(page);<br>            page.setRecords(userService.selectList(null));<br>            page.setTotal(PageHelper.freeTotal());//获取总数并释放资源 也可以 PageHelper.getTotal()<br>            return page;<br>        }<br><br>        /</strong><br>         <em> 测试事物
         </em> <a href="http://localhost:8080/user/test_transactional" target="_blank" rel="noopener">http://localhost:8080/user/test_transactional</a><br><br>         <em> 访问如下并未发现插入数据说明事物可靠！！<br>
         </em> <a href="http://localhost:8080/user/test" target="_blank" rel="noopener">http://localhost:8080/user/test</a><br><br>         <em> <br>
         </em> 启动  Application 加上 @EnableTransactionManagement 注解其实可无默认貌似就开启了<br><br>         <em> 需要事物的方法加上 @Transactional 必须的哦！！
         </em>/<br>        @Transactional<br>        @GetMapping(“/test_transactional”)<br>        public void testTransactional() {<br>            //userService.insert(new User(1000L, “测试事物”, 16, 3));<br>            System.out.println(“ 这里手动抛出异常，自动回滚数据”);<br>            throw new RuntimeException();<br>        }<br>    <code>`</code><br><br>这么多的测试，我觉得最有趣的是条件构造器，在官网上有更齐全的，而我这里是按照我自己的需求写的。<br><br>最后谢谢大家的观看，写博客经验不足，写得不好请见谅，如果能给你带来帮助请点个赞，若遇到不明白的，或者我有写错的地方请提出，谢谢！<br><br>引自<a href="https://www.cnblogs.com/lianggp/p/7573653.html" target="_blank" rel="noopener">https://www.cnblogs.com/lianggp/p/7573653.html</a><br><br></user></user></user></user></user></user></user></user></user></div></div>
      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>感谢支持原创技术分享</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/repo/wechatpay.png" alt="庞国明 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/repo/alipay.jpg" alt="庞国明 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/mybatis/" rel="tag"># mybatis</a>
          
            <a href="/tags/spring-boot/" rel="tag"># spring boot</a>
          
            <a href="/tags/druid/" rel="tag"># druid</a>
          
            <a href="/tags/mybatis-plus/" rel="tag"># mybatis-plus</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/post/368d0714.html" rel="next" title="Druid连接池简介和配置">
                <i class="fa fa-chevron-left"></i> Druid连接池简介和配置
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/post/5860b93c.html" rel="prev" title="帝国备份王出错">
                帝国备份王出错 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/7269202?s=460&v=4" alt="庞国明">
            
              <p class="site-author-name" itemprop="name">庞国明</p>
              <p class="site-description motion-element" itemprop="description">Software make the information world run, and programer make the softeware run.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">420</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">267</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/pangguoming" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:pangguoming@yeah.net" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/pangguoming" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/users/1570700/pangguoming" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/pangguoming" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">庞国明</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'pangguoming',
            repo: 'pangguoming.github.io',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: '51f66abac54ca9e1b5a5608d706ce6af47ffaa51',
            
                client_id: '1e9770fed2b4d227cd0a'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  

  

  

</body>
</html>
